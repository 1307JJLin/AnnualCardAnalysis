# 2021年度数据分析报告 ｜杰然不同之GR


# 本报告由公众号【杰然不同之GR】编写，整理并发布，仅作个人学习使用，请勿用于任何商业用途，转载及其他形式合作请与我联系 

简易目录

1.数据预处理
   
1.1 数据合并和一些纠错

1.2 新特征生成

1.2.1) 根据date生成月日还有星期

1.2.2) 根据start time 和end time 生成时和分

1.2.3) 根据start和end生成中间时间

1.2.4) 根据事项的中间时间确定事项做的时候处于一天的时段

1.2.5) 根据时长大小分为长中短

1.2.6) 修改一些前后差别不大的事件

1.2.7) 统一事项与属性的对应关系 

2.数据可视化

2.1 变量分类

2.1.1) 日期类变量: date

2.1.2) 数值类变量: duration, phone 

2.1.3) 类别变量: event, year, month, day, weekday, mid_hour, day_period, week_order, duration_attr, attr, 

2.2 单变量分析

2.2.1) 数值变量的直方图

2.2.2) 类别变量的饼图，柱形图

2.2.3) 专注力分析

2.2.4) 各个月份，各年, 各小时的event关键词词云图

2.3 双变量分析

2.3.1) PyCatFlow图

2.3.2) 单个类别变量 vs 数值 sns.stripplot  sns.swarmplot  sns.boxplot   sns.violinplot  

2.3.3) 两个类别变量 VS 数值 sns.countplot  sns.barplot  sns.factorplot  sns.pointplot 

2.4 衍生数据可视化

2.4.1) 日度汇总各类时间总时长

2.4.2) 每天的第一件和最后一件事

2.4.3) 每天的第一件和最后一件事的时间

2.4.4) 每天做的事项数目的统计

2.4.5) 每天做事项先后编号并统计

2.4.6) 各事项关于日期求和的透视表

2.4.7) 每年, 月, 星期的事项关键词词云图

2.4.8) 每天事项的对应先后以及月度关联的网络图

2.5 一键式EDA

3.数据分析

3.1 方差分析每月或是每年的事项是否有差异

3.1.1) 原始事项时长数据的方差分析

3.1.2) 衍生数据的方差分析

3.2 LSTM预测前后事项

3.2.1) 建立字符索引

3.2.2) 建立LSTM模型

3.2.3) 模型训练

3.3 时长数据的简单聚类

3.4 关于日期的缺失值处理

3.5 关于日期的傅里叶分解求周期

3.6 关于日期的传统时间序列分析

3.6.1) ARIMA分析

3.6.2) GARCH分析

3.6.3) VAR分析

3.7 关于日期的NeuralProphet 时间序列

4.数据挖掘

4.1 通过生成聚合特征做日度时长数据的特征工程

4.2 类别变量的one-hot encoding

4.3 利用boruta筛选特征

4.4 利用PCA降维

4.5 利用optuna优化参数

4.6 stacking 融合


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import os
import jieba
import statsmodels.tsa.stattools as st
import warnings
import lightgbm as lgb
import xgboost as xgb
import networkx as nx 
import pycatflow as pcf
import statsmodels.api as sm
import statsmodels
import optuna
import pylab as pl 
import matplotlib.cm as cm 
import torch
import random
from scipy.cluster.hierarchy import linkage, dendrogram
from scipy.stats import kstest, shapiro
from optuna.samplers import TPESampler
from gensim.corpora import Dictionary 
from gensim.models import TfidfModel
from wordcloud import WordCloud
from scipy import stats, signal, interpolate
from arch import arch_model
from boruta import BorutaPy
from statsmodels.tsa.stattools import adfuller
from statsmodels.tsa import stattools
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm
from statsmodels.tsa.seasonal import seasonal_decompose
from statsmodels.graphics.tsaplots import plot_acf, plot_pacf
from statsmodels.tsa.arima_model import ARMA
from statsmodels.stats.diagnostic import acorr_ljungbox
from sklearn.model_selection import train_test_split, KFold
from sklearn.preprocessing import StandardScaler 
from sklearn.ensemble import RandomForestRegressor, AdaBoostRegressor, GradientBoostingRegressor
from sklearn.metrics import mean_squared_error
from sklearn.decomposition import PCA
from xgboost.sklearn import XGBRegressor,XGBRegressor
from autoviz.AutoViz_Class import AutoViz_Class
from tqdm import tqdm
from neuralprophet import NeuralProphet
from PIL import Image, ImageDraw, ImageFont
from matplotlib import rcParams
from torch import nn
from mpl_toolkits.mplot3d import Axes3D

config = {
    "font.family":'serif',
    "font.size": 40,
    'font.weight':'bold',
    "mathtext.fontset":'stix',
    'figure.titleweight': 'bold',
    'axes.titleweight': 'bold',
    'axes.labelweight': 'bold',
    "font.serif": ['STSong'],
    'axes.unicode_minus':False
}
rcParams.update(config)
path = 'D:/打卡/2021/年度总结'
warnings.filterwarnings("ignore")
%matplotlib inline
```

    Imported AutoViz_Class version: 0.0.84. Call using:
        AV = AutoViz_Class()
        AV.AutoViz(filename, sep=',', depVar='', dfte=None, header=0, verbose=0,
                                lowess=False,chart_format='svg',max_rows_analyzed=150000,max_cols_analyzed=30)
    Note: verbose=0 or 1 generates charts and displays them in your local Jupyter notebook.
          verbose=2 does not show plot but creates them and saves them in AutoViz_Plots directory in your local machine.
    

# 1.数据预处理

## 1.1 数据合并和一些纠错


```python
df = pd.read_excel('2021年1月打卡记录.xlsx')
dfphone = pd.read_excel('1月.xlsx', sheet_name=1).rename(
    columns={'手机时间':'phone'}
)
df = pd.merge(
    df, dfphone[['date', 'phone']], on='date', how='outer'
)

# 一月的date略作处理
df['date'] = df['date'].astype(str).apply(lambda x:x.split()[0])

# 循环读入每天的数据
for month in [f'0{n}' for n in range(2, 10)] + ['10', '11', '12']:
    for day in [f'0{n}' for n in range(1, 10)] + [str(n) for n in range(10, 32)]:
        file = f'2021-{month}-{day}打卡记录.xlsx'
        phone = f'2021-{month}-{day}打卡总结.xlsx'
        try:
            temp = pd.read_excel(file).iloc[:, 1:]
            temp['phone'] = pd.read_excel(phone).loc[0, '手机时间']
            df = pd.concat([df, temp], axis=0)
        except:
            continue
```


```python
# 一些纠错
corrects = {
    'quant':'量化', 
    'quant2':'量化',
    '人文书记':'人文书籍', 
    '数据竞赛':'数据分析', 
    '正则表达式':'正则'
}

df['event'] = df['event'].apply(lambda x: corrects.get(x) if corrects.get(x) is not None else x)
df.to_excel('2021汇总.xlsx', index=False)
```

## 1.2  新特征生成


```python
df = pd.concat(
    [
        pd.read_excel(f'{n}汇总.xlsx')['date	event	start	end	duration	attr	phone'.split()]
        for n in [2019, 2020, 2021]
    ], axis=0
)
```

### 1.2.1 根据date生成月日还有星期


```python
# 1.2.1 根据date生成月日还有星期
df['event'] = df['event'].str.strip()
df['year'] = df['date'].astype(str).apply(lambda x:str(x.split('-')[0]))
df['month'] = df['date'].astype(str).apply(lambda x:str(x.split('-')[1]))
df['day'] = df['date'].astype(str).apply(lambda x:str(x.split('-')[2]))
df['weekday'] = pd.to_datetime(df['date']).dt.weekday + 1
```

### 1.2.2 根据start time和end time生成时和分


```python
# 1.2.2 根据start time和end time生成时和分
df['start_hour'] = df['start'].astype(str).apply(lambda x:str(x.split(':')[0]))
df['end_hour'] = df['end'].astype(str).apply(lambda x:str(x.split(':')[0]))
```

### 1.2.3 根据start和end生成中间时间


```python
# 1.2.3 根据start和end生成中间时间
def get_mid(start, duration):
    times = str(start).split(':')
    minutes = int(times[0]) * 60 + int(times[1])
    res = minutes + duration // 2
    hour = res // 60
    minute = res - hour * 60
    return f'{int(hour)}:{int(minute)}' if minute >= 10 else f'{int(hour)}:0{int(minute)}'

        
df['mid_time'] = df.apply(lambda x: get_mid(x['start'], x['duration']), axis=1)
```

### 1.2.4 根据事项的中间时间确定事项做的时候处于一天的时段


```python
''' 
一天的时间段划分为:
8-12点: morning
12-13点: noon
13-19点: afternoon
19点到24点: evening
0-8点: night
'''
def get_period(hour):
    hour = int(hour)
    if hour in range(8, 12):
        return 'morning'
    elif hour == 12:
        return 'noon'
    elif hour in range(13, 19):
        return 'afternoon'
    elif hour in range(19, 24):
        return 'evening'
    return 'night'


# 1.2.4 根据事项的中间时间确定事项做的时候处于一天的时段
df['mid_hour'] = df['mid_time'].astype(str).apply(lambda x:str(x.split(':')[0]))
df['day_period'] = df['mid_hour'].map(get_period)
df['week_order'] = df['date'].map(lambda x: pd.Period(x, freq='W'))
```

### 1.2.5 根据时长大小分为长中短


```python
# 1.2.5 根据时长大小分为长中短
''' 
30分钟以下为short
30-60分钟为middle
60分钟以上为long
'''

def get_duration(duration):
    if int(duration) < 30:
        return 'short'
    elif int(duration) <= 60 and int(duration) >= 30:
        return 'middle'
    return 'long'

df['duration_attr'] = df['duration'].map(get_duration)
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>event</th>
      <th>start</th>
      <th>end</th>
      <th>duration</th>
      <th>attr</th>
      <th>phone</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>weekday</th>
      <th>start_hour</th>
      <th>end_hour</th>
      <th>mid_time</th>
      <th>mid_hour</th>
      <th>day_period</th>
      <th>week_order</th>
      <th>duration_attr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-02-27</td>
      <td>托福写作与听力</td>
      <td>07:40:00</td>
      <td>10:00:00</td>
      <td>140</td>
      <td>有效时间</td>
      <td>NaN</td>
      <td>2019</td>
      <td>02</td>
      <td>27</td>
      <td>3</td>
      <td>07</td>
      <td>10</td>
      <td>8:50</td>
      <td>8</td>
      <td>morning</td>
      <td>2019-02-25/2019-03-03</td>
      <td>long</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-02-27</td>
      <td>python</td>
      <td>10:00:00</td>
      <td>11:40:00</td>
      <td>100</td>
      <td>有效时间</td>
      <td>NaN</td>
      <td>2019</td>
      <td>02</td>
      <td>27</td>
      <td>3</td>
      <td>10</td>
      <td>11</td>
      <td>10:50</td>
      <td>10</td>
      <td>morning</td>
      <td>2019-02-25/2019-03-03</td>
      <td>long</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-02-27</td>
      <td>吃饭和拿快递</td>
      <td>11:40:00</td>
      <td>12:35:00</td>
      <td>55</td>
      <td>必要时间</td>
      <td>NaN</td>
      <td>2019</td>
      <td>02</td>
      <td>27</td>
      <td>3</td>
      <td>11</td>
      <td>12</td>
      <td>12:07</td>
      <td>12</td>
      <td>noon</td>
      <td>2019-02-25/2019-03-03</td>
      <td>middle</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-02-27</td>
      <td>搜索术</td>
      <td>12:35:00</td>
      <td>13:00:00</td>
      <td>25</td>
      <td>有效时间</td>
      <td>NaN</td>
      <td>2019</td>
      <td>02</td>
      <td>27</td>
      <td>3</td>
      <td>12</td>
      <td>13</td>
      <td>12:47</td>
      <td>12</td>
      <td>noon</td>
      <td>2019-02-25/2019-03-03</td>
      <td>short</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-02-27</td>
      <td>午休</td>
      <td>13:00:00</td>
      <td>13:40:00</td>
      <td>40</td>
      <td>必要时间</td>
      <td>NaN</td>
      <td>2019</td>
      <td>02</td>
      <td>27</td>
      <td>3</td>
      <td>13</td>
      <td>13</td>
      <td>13:20</td>
      <td>13</td>
      <td>afternoon</td>
      <td>2019-02-25/2019-03-03</td>
      <td>middle</td>
    </tr>
  </tbody>
</table>
</div>



### 1.2.6 修改一些前后差别不大的事件


```python
# 1.2.6 修改一些前后差别不大的事件
def correct_events(e):
    alist = {
        '代码':'改代码',
        '拍照':'摄影',
        '简历':'简历',
        '总结':'写报告',
        '报告':'写报告',
        '面试': '面试',
        '博弈论':'博弈论',
        '磨蹭':'磨蹭',
        'PPT':'PPT',
        '快递':'快递',
        'TPO':'托福听力',
        '算法':'算法课程',
        '推文':'写推文',
        '演唱会':'演唱会',
        '人文课':'人文课',
        'AQF':'AQF',
    }
    for k in alist:
        if k in e:
            e = alist[k]
    return e

df['event'] = df['event'].map(correct_events)
```

### 1.2.7 事项与属性的对应


```python
# 1.2.7 事项与属性的对应
# 各别事项前后不统一 需要统一修正 修正成该事项出现最多的属性
events = df['event'].unique()
event2attr = {}
for e in events:
    attr = df[df['event'] == e]['attr'].value_counts().index[0]
    event2attr[e] = attr

df['attr'] = df['event'].map(event2attr)
df.to_excel('3年汇总.xlsx', index=False)
```


```python
# 检查是否还存在事项的属性不唯一的情况
df[['event', 'attr']].drop_duplicates().to_excel('事项性质对应表.xlsx', index=False)
df[['event', 'attr']].drop_duplicates()['event'].value_counts()
```




    开证明     1
    打字      1
    制定计划    1
    讲座      1
    爬虫      1
           ..
    开户      1
    安装软件    1
    等候      1
    快递      1
    回家      1
    Name: event, Length: 243, dtype: int64



# 2.数据可视化

## 2.1 变量分类


```python
date_vars = ['date']
years = range(2019, 2022)

numeric_vars = [
    'duration', 'phone'
]

cate_vars = [
    'event', 'year', 'month', 'day', 
    'weekday', 'mid_hour', 'day_period', 'week_order', 'duration_attr', 'attr'
]
```

## 2.2 单变量分析

### 2.2.1) 数值变量的直方图


```python
# 2.2.1) 数值变量的直方图
part = '2.2.1'
def numeric_hist(col, year):
    temp = df[df['year'] == str(year)].copy()
    if col == 'phone':
        temp = temp[[col, 'date']].drop_duplicates()
    plt.figure(figsize=(20, 10), dpi=100)
    plt.hist(temp[col], bins=20)
    plt.xlabel(col, fontsize=20)
    plt.ylabel('Frequency', fontsize=20)
    title = f'{part} Histgram of {col} in year {year}'
    plt.title(title, fontsize=20)   
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

for col in numeric_vars:
    for year in years:
        numeric_hist(col, year)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_29_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_29_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_29_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_29_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_29_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_29_5.png)
    


### 2.2.2) 类别变量的饼图


```python
# 2.2.2) 类别变量的饼图
# 类别变量饼图
part = '2.2.2'
def plot_pie(col, data, n, year=None):
    fig = plt.figure(figsize=(20, 10), dpi=100)
    fig.tight_layout()
    ax = fig.add_subplot(111)
    df = data.copy()
    if year is not None:
        try:
            temp = df[df['year'] == str(year)].copy()
        except:
            temp = df.copy()
    else:
        temp = df.copy()
    data = temp[col].value_counts().sort_values(ascending=False).values[:n] 
    labels = temp[col].value_counts().sort_values(ascending=False).index[:n]
    explodes = [0] * len(data)
    explodes[0] = 0.015
    ax.pie(
        data, 
        labels=labels, 
        radius=0.8, 
        explode=explodes, 
        autopct='%1.1f%%', 
        pctdistance = 0.5,
        labeldistance=0.7,  
        textprops={'fontsize': 25, 'color': 'black'}
    ) 
    plt.axis('equal') 
    title = f'{part} Pie plot of {col} in year {year}' if year is not None else \
        f'{part} Pie plot of {col}'
    plt.title(title, fontsize=20) 
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

        
for col in cate_vars:
    if col == 'year':   
        continue
    for year in years:
        plot_pie(col, df, 15, year)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_18.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_19.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_20.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_21.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_22.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_23.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_24.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_25.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_31_26.png)
    


### 2.2.3) 专注力分析


```python
# 2.2.3) 专注力分析
part = '2.2.3'
def concentrate(year):
    temp = df[
        (df['year'] == str(year)) & (df['attr'] == '有效时间')
    ].copy()

    # Figure 1
    plt.figure(dpi=100)
    df[df['year'] == str(year)].groupby(['attr', 'duration_attr'])['date'].\
    count().unstack().plot(kind='bar', figsize=(20, 10))
    title = f'{part} Duration attribution of each time in year {year}'
    plt.title(title, fontsize=20)  
    plt.xlabel('Effective time duration', fontsize=20) 
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.legend(fontsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

    # Figure 2
    plt.figure(dpi=100)
    temp['duration'].plot(kind='hist', figsize=(20, 10))
    title = f'{part} Duration of effective time in year {year}'
    plt.title(title, fontsize=20)   
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.ylabel('Frequency', fontsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)
    
    # Figure 3
    plt.figure(dpi=100)
    temp['duration_attr'].value_counts().plot(kind='bar', figsize=(20, 10))
    title = f'{part} Bar plot of duration attribution of effective time in year {year}'
    plt.title(title, fontsize=20)   
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

```


```python
title = '有效时间在不同年和时长段的柱形图'
temp = df[df['attr'] == '有效时间'].groupby(['year', 'duration_attr'])['date'].\
    count().unstack()
temp = temp / temp.sum(axis=0)  #计算频率
temp.plot(
        kind='bar', 
        figsize=(20, 10), 
    )
plt.title(title, fontsize=20)
plt.xlabel('Year', fontsize=20)
plt.ylabel('Frequency', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)
plt.legend(fontsize=20)
file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_34_0.png)
    



```python
concentrate(2021)
```


    <Figure size 600x400 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_35_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_35_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_35_3.png)
    



```python
concentrate(2020)
```


    <Figure size 600x400 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_36_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_36_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_36_3.png)
    



```python
concentrate(2019)
```


    <Figure size 600x400 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_37_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_37_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_37_3.png)
    


## 2.3 双变量分析

### 2.3.1) PyCatFlow图


```python
# 2.3.1) PyCatFlow图
column_order = { 
    date: i + 1 for i, date in enumerate(df['date'].unique()) 
}
df['column_order'] = df['date'].map(column_order)
translate = pd.read_csv('event.csv', encoding='gbk')
chi = translate['Chinese'].values
eng = translate['English'].dropna().values
translates = {
    c:e for c, e in zip(chi, eng)
} 

translates
```




    {'托福写作与听力': 'TOEFL writing and listening',
     'python': 'python',
     '快递': 'express',
     '搜索术': 'Search technique',
     '午休': 'noon break',
     '托福听力': 'TOEFL Listening',
     '博弈论': 'Game theory',
     '磨蹭': 'Dawdle',
     '晚饭': 'dinner',
     '雷欧奥特曼': 'Ultraman Leo',
     '复习偏微分': 'Review partial differential',
     '托福写作': 'TOEFL Writing',
     '课': 'course',
     'PPT': 'PPT',
     '午饭走路': 'Lunch walk',
     '重师游玩': 'Heavy teacher play',
     'K歌': 'go to karaoke',
     '晚饭归来': 'Return from dinner',
     '中央银行学': 'Central banking',
     '有限元': 'Finite element',
     '午饭': 'lunch',
     '托福口语': 'TOEFL Speaking',
     '万矿量化': '10000 ore quantification',
     '托福课': 'TOEFL class',
     '大决战': 'Great showdown',
     '偏微分': 'partial differential',
     '编程作业': 'Programming job',
     '睡觉': 'sleep',
     '单词': 'word',
     '玩游戏': 'play a game',
     'GMAT': 'GMAT',
     '口语视频': 'Oral video',
     '听力视频': 'Listening video',
     '蹲坑': 'latrine pit',
     'AQF': 'AQF',
     '打字': 'typing',
     '排练pr': 'Rehearsal pr',
     '公开课': 'Open class',
     '听力': 'hearing',
     '托福听力真题': 'TOEFL listening questions',
     '交材料': 'Handover materials',
     'GMAT长难句': 'GMAT long difficult sentence',
     'GMAT试题': 'GMAT questions',
     'GMAT直播': 'GMAT live broadcast',
     '写作课': 'Writing class',
     '银行会计': 'Bank Accounting',
     '复习': 'review',
     '改代码': 'Change code',
     '逐鹿九州': 'Kyushu',
     '排练ppt': 'Rehearse ppt',
     '看论文': 'Read the paper',
     'gmat': 'gmat',
     '林俊杰': 'Lin Junjie',
     '独立写作': 'Independent writing',
     '托福公开课': 'TOEFL open class',
     '托福阅读': 'TOEFL Reading',
     '托福精听': 'TOEFL Listening',
     '托福真题': 'TOEFL questions',
     '写作视频': 'Writing video',
     '手机': 'mobile phone',
     '写作': 'writing',
     '口语': 'oral language',
     '成绩': 'achievement',
     '写作和听力': 'Writing and listening',
     '排练': 'Rehearsal',
     '中央银行': 'central bank',
     '听力写作': 'Listening writing',
     'GMAT视频': 'GMAT video',
     '量化': 'quantification',
     'gis': 'gis',
     '背单词': 'recite words',
     '柯南': 'Conan',
     '炼句': 'Refine sentences',
     'python尝试': 'Python try',
     '托福听力与口语': 'TOEFL listening and speaking',
     '单词与精听': 'Words and intensive listening',
     '改作文': 'correct compositions',
     '长难句': 'Long difficult sentence',
     '拿计算器': 'Take the calculator',
     'GMAT学习': 'GMAT learning',
     '写报告': 'Write a report',
     '实习资料': 'Internship materials',
     'R': 'R',
     '理发': 'haircut',
     '写日记': 'keep a diary',
     'GRE': 'GRE',
     '课与单词': 'Lessons and words',
     '拍视频': 'Take a video',
     '审核视频': 'Audit video',
     'matlab': 'matlab',
     '经验交流会': 'have a meeting to exchange experience',
     '简历': 'resume',
     '风险管理': 'risk management',
     '罗布剧场版': 'Rob theatre Edition',
     '写总结': 'Write a summary',
     'PDE': 'PDE',
     '剪辑视频': 'Clip video',
     '洗头': 'wash hair',
     '考试': 'examination',
     '找实习': 'Find an internship',
     '听讲座': 'Listen to the lecture',
     '外出': 'go out',
     '等候': 'wait',
     '开幕式': 'The opening ceremony',
     '填信息': 'Fill in information',
     '答疑': 'answering question',
     '编程': 'programming',
     '摄影': 'Photography',
     '尝试耳机': 'Try headphones',
     '找地': 'Find land',
     '托福模考': 'TOEFL model test',
     '整理资料': 'put file in order',
     'GRE阅读': 'GRE reading',
     'GRE长难句': 'GRE long difficult sentence',
     '作图': 'Mapping',
     '打印': 'Print',
     '金融法': 'Financial Law',
     '做图': 'Drawing',
     '抢课': 'Grab class',
     '查文献': 'Literature search',
     '讲座': 'lecture',
     '买药': 'Buy medicine',
     '读论文': 'Reading papers',
     '留学咨询': 'Study abroad consultation',
     'GRE填空': 'GRE fill in the blanks',
     '咨询': 'consulting service',
     '实习工作': 'Internship work',
     '数值分析': 'numerical analysis',
     '托福': 'TOEFL',
     '论文': 'paper',
     '开会': 'attend a meeting',
     '商业伦理': 'business ethics',
     '装软件': 'Install software',
     '量化课程': 'Quantitative Curriculum',
     '量化作业': 'Quantitative operation',
     '练字': 'practise calligraphy',
     '开户': 'Open an account',
     'GRE数学': 'GRE mathematics',
     'GRE写作': 'GRE writing',
     '期权定价': 'Option pricing',
     '订酒店': 'Hotel Reservation',
     '打印成绩单': 'Print transcript',
     '量化项目': 'Quantitative project',
     '搬家': 'house-moving',
     '拿成绩单': 'Get the report card',
     '托福报名': 'TOEFL registration',
     '面试': 'interview',
     '午饭.': 'Lunch',
     '填表': 'Fill in a form',
     '可视化': 'visualization',
     '建模': 'modeling',
     '散步': 'take a walk',
     '项目管理': 'project management',
     '衍生工具': 'Derivative instruments',
     '聚餐': 'dinner party',
     '转账': 'transfer accounts',
     '改CV': 'Change CV',
     '体侧': 'Body side',
     '华尔街日报': 'Wall Street Journal',
     'kaggle': 'kaggle',
     'hackerrank': 'hackerrank',
     'C++': 'C++',
     '随机过程': 'random process',
     'leetcode': 'leetcode',
     '希腊神话': 'MYTHOS',
     'vn.py': 'vn.py',
     '推荐信': 'recommendation',
     '数据分析': 'Data analysis',
     '文书修改': 'Document modification',
     '视频内容': 'Video content',
     'youtube': 'youtube',
     '借书': 'Borrow books',
     '随机微积分': 'Stochastic calculus',
     '圣经': 'Bible',
     '文书': 'document',
     '计量': 'metering',
     '西洋画': 'Western painting',
     '算法课程': 'Algorithm Course',
     '选课指导': 'Course selection guidance',
     '考试报名': 'Examination registration',
     '复变': 'Complex transformation',
     '毕业论文': 'dissertation',
     '干洗': 'dry cleaning',
     '金数': 'Gold number',
     '金融人脉': 'Financial contacts',
     '陪诊': 'Accompany diagnosis',
     '走亲': 'Walk close',
     '算分': 'Calculate points',
     '买东西': 'shopping',
     '实变': 'Consolidation',
     '回家': 'get home',
     '人工智能': 'artificial intelligence',
     '泛函': 'functional',
     '人文书籍': 'Humanities books',
     '测度论': 'Measure theory',
     '人文课': 'Humanities course',
     '开证明': 'Open certificate',
     '导员谈话': 'Talk to the guide',
     '修图': 'Revision',
     '导师谈话': 'Tutor talk',
     '人文教程': 'Humanities course',
     '准备材料': 'Preparation of materials',
     '整理笔记': 'Organize notes',
     '写推文': 'Tweet',
     '运动': 'motion',
     '看工作': 'Watch work',
     '安装软件': 'Install software',
     '洗衣服': 'wash clothes',
     '更新设备': 'Update device',
     '做家务': 'do housework',
     '写计划': 'Write plan',
     '数据库': 'database',
     '找工作': 'job-hunting',
     '修复电脑': 'Repair computer',
     '游玩': 'play',
     '制订计划': 'Make a plan',
     '演唱会': 'vocal concert',
     '制作视频': 'Make video',
     '修U盘': 'Repair USB flash disk',
     '搜集资源': 'Collect resources',
     '缴费': 'pay',
     '接单工作': 'Order receiving work',
     '监工': 'overseer',
     'linux': 'linux',
     '数据竞赛': 'Data competition',
     '爬虫': 'crawler',
     '检查设备': 'Check equipment',
     '逛街': 'Go shopping',
     '正则': 'regular',
     '机器学习': 'machine learning',
     '清理内存': 'Clean up memory',
     '换锁': 'Change lock',
     '制定计划': 'draw up a plan',
     '下载软件': 'Download a software',
     '化妆': 'Make up',
     '接种疫苗': 'vaccination',
     '找资源': 'Find resources',
     '配置环境': 'Configuration environment',
     '深度学习': 'Deep learning',
     '大数据': 'big data',
     '线上研讨': 'Online discussion',
     '做视频': 'Make video',
     '报名考试': 'Registration examination'}




```python
df['eng_event'] = df['event'].map(translates)

df['eng_attr'] = df['attr'].map({
    '有效时间':'effective',
    '浪费时间':'wasteful',
    '必要时间':'necessary',
})

temp = df[df['year'] == '2021']
temp[['eng_event', 'eng_attr', 'date', 'column_order']].\
to_csv('2021.csv', encoding='gbk', index=False)
```


```python
# Loading and parsing data:
data = pcf.read_file(
    "2021.csv", 
    columns="date", 
    nodes="eng_event", 
    categories="eng_attr", 
    column_order="column_order"
)

# Generating the visualization
viz = pcf.visualize(
    data,
    spacing=100,
    width=88000,
    maxValue=20,
    minValue=2
)
viz
```




    
![svg](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_42_0.svg)
    



### 2.3.2) 单个类别变量 vs 数值


```python
# 2.3.2) 单个类别变量 vs 数值
# 类别变量 VS 数值变量
part = '2.3.2'
def plot_num_vs_cate(num, cate, n=30, year=2021):
    if cate != 'year':
        stats = ['max', 'min', 'mean', 'std', 'median', 'sum']
        for sts in stats:
            temp = df[df['year'] == str(year)].groupby(cate)[num].\
            agg(sts).sort_values(ascending=False)
            plt.figure(dpi=100)
            title = f"{part} bar plot of {sts} of {num} in different {cate} groups in year {year}"
            temp[:n].plot(
                kind='bar', 
                figsize=(20, 10),
            )
            plt.title(title, fontsize=20)
            plt.xlabel(cate, fontsize=20)
            plt.ylabel(f'{sts} of {num}', fontsize=20)
            plt.xticks(fontsize=20)
            plt.yticks(fontsize=20)
            file = os.path.join(path, f'{title}.png')
            plt.savefig(file, dpi=600)

for num in numeric_vars:
    for cate in cate_vars:
        plot_num_vs_cate(num, cate)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_18.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_19.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_20.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_21.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_22.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_23.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_24.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_25.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_26.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_27.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_28.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_29.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_30.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_31.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_32.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_33.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_34.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_35.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_36.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_37.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_38.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_39.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_40.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_41.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_42.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_43.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_44.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_45.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_46.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_47.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_48.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_49.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_50.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_51.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_52.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_53.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_54.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_55.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_56.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_57.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_58.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_59.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_60.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_61.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_62.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_63.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_64.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_65.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_66.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_67.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_68.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_69.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_70.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_71.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_72.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_73.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_74.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_75.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_76.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_77.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_78.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_79.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_80.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_81.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_82.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_83.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_84.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_85.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_86.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_87.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_88.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_89.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_90.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_91.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_92.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_93.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_94.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_95.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_96.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_97.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_98.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_99.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_100.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_101.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_102.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_103.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_104.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_105.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_106.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_44_107.png)
    



```python
def plot_box(num, cate, n=30, year=2021):
    temp = df[df['year'] == str(year)].groupby(cate)[num].agg('median').\
        sort_values(ascending=False)[:n]
    plt.figure(figsize=(20, 10), dpi=100)
    sns.boxplot(
        x=cate, 
        y=num, 
        data=df[df[cate].isin(temp.index)], 
        order=temp.index
    )
    title = f'{part} Boxplot of {num} wrt {cate} in year {year}'
    plt.title(title, fontsize=20)
    plt.xlabel(cate, fontsize=20)
    plt.ylabel(num, fontsize=20)
    plt.xticks(rotation=90, fontsize=20)
    plt.yticks(fontsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

for num in numeric_vars:
    for cate in cate_vars:
        plot_box(num, cate)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_18.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_45_19.png)
    


### 2.3.3) 两个类别变量 VS 数值


```python
# 2.3.3) 两个类别变量 VS 数值
part = '2.3.3'
def plot_count_plot(c1, c2, n=15, year=2021):
    temp = df[df['year'] == str(year)].groupby(c1)[c2].\
    count().sort_values(ascending=False)[:n]
    plt.figure(figsize=(20, 10), dpi=100)
    sns.countplot(
        x=c1, 
        hue=c2, 
        data=df[df[c1].isin(temp.index)], 
        order=temp.index
    )
    plt.legend() if c2 != 'week_order' else plt.legend([])
    title = f'{part} Countplot of {c1} in different {c2} group'
    plt.title(title, fontsize=20)
    plt.xlabel(c1, fontsize=20)
    plt.ylabel('Count', fontsize=20)
    plt.xticks(rotation=90, fontsize=20)
    plt.yticks(fontsize=20)
    if c2 not in ['day', 'week_order']:
        plt.legend(fontsize=20, loc=1) 
    else:
        plt.legend([])
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

for idx, v in enumerate(cate_vars):
    if idx == len(cate_vars) - 1:
        break
    for k in cate_vars[idx + 1:]:
        plot_count_plot(v, k)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_18.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_19.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_20.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_21.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_22.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_23.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_24.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_25.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_26.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_27.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_28.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_29.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_30.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_31.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_32.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_33.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_34.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_35.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_36.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_37.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_38.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_39.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_40.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_41.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_42.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_43.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_47_44.png)
    


## 2.4 衍生数据可视化

### 2.4.1) 日度汇总各类时间总时长


```python
# 2.4.1) 日度汇总各类时间总时长
part = '2.4.1'
daily_attr = df.groupby(['date', 'attr'])['duration'].\
    agg('sum').unstack().reset_index()

daily_attr = pd.merge(
    daily_attr, 
    df[['date', 'phone']].drop_duplicates(), 
    on='date'
).rename(columns={'phone':'手机时间'})

daily_attr
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>必要时间</th>
      <th>有效时间</th>
      <th>浪费时间</th>
      <th>手机时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-02-27</td>
      <td>160.0</td>
      <td>590.0</td>
      <td>80.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04</td>
      <td>650.0</td>
      <td>160.0</td>
      <td>30.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-05</td>
      <td>395.0</td>
      <td>342.0</td>
      <td>108.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-06</td>
      <td>370.0</td>
      <td>340.0</td>
      <td>130.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-07</td>
      <td>495.0</td>
      <td>265.0</td>
      <td>80.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>860</th>
      <td>2021-12-26</td>
      <td>428.0</td>
      <td>356.0</td>
      <td>87.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>861</th>
      <td>2021-12-27</td>
      <td>286.0</td>
      <td>456.0</td>
      <td>123.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>862</th>
      <td>2021-12-28</td>
      <td>201.0</td>
      <td>541.0</td>
      <td>153.0</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>863</th>
      <td>2021-12-29</td>
      <td>242.0</td>
      <td>481.0</td>
      <td>143.0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>864</th>
      <td>2021-12-30</td>
      <td>184.0</td>
      <td>545.0</td>
      <td>144.0</td>
      <td>39.0</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 5 columns</p>
</div>




```python
daily_attr.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>必要时间</th>
      <th>有效时间</th>
      <th>浪费时间</th>
      <th>手机时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>864.000000</td>
      <td>865.000000</td>
      <td>863.000000</td>
      <td>804.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>230.759259</td>
      <td>462.344509</td>
      <td>111.924681</td>
      <td>53.697761</td>
    </tr>
    <tr>
      <th>std</th>
      <td>115.502198</td>
      <td>139.615640</td>
      <td>52.560650</td>
      <td>76.298209</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>21.000000</td>
      <td>13.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>154.000000</td>
      <td>408.000000</td>
      <td>74.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>207.000000</td>
      <td>492.000000</td>
      <td>106.000000</td>
      <td>39.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>297.000000</td>
      <td>562.000000</td>
      <td>139.500000</td>
      <td>52.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>704.000000</td>
      <td>705.000000</td>
      <td>448.000000</td>
      <td>700.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
daily_attr[daily_attr['date'] >= '2021-01-01'].describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>必要时间</th>
      <th>有效时间</th>
      <th>浪费时间</th>
      <th>手机时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>293.000000</td>
      <td>293.000000</td>
      <td>292.000000</td>
      <td>293.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>278.020478</td>
      <td>473.709898</td>
      <td>109.732877</td>
      <td>31.866894</td>
    </tr>
    <tr>
      <th>std</th>
      <td>95.739442</td>
      <td>100.438667</td>
      <td>37.625262</td>
      <td>10.297927</td>
    </tr>
    <tr>
      <th>min</th>
      <td>77.000000</td>
      <td>75.000000</td>
      <td>13.000000</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>206.000000</td>
      <td>422.000000</td>
      <td>84.750000</td>
      <td>25.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>269.000000</td>
      <td>487.000000</td>
      <td>110.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>328.000000</td>
      <td>550.000000</td>
      <td>137.000000</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>643.000000</td>
      <td>705.000000</td>
      <td>253.000000</td>
      <td>75.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
title = f'{part} 日度汇总各类时间总时长'
daily_attr.set_index('date').plot(
    kind='line', figsize=(20, 10)
)

plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Sum of daily duration', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)
plt.legend(loc=0, fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_53_0.png)
    



```python
# 生成新数据
daily_attr['weekday'] = pd.to_datetime(daily_attr['date']).dt.weekday + 1
daily_attr['month'] = daily_attr['date'].apply(lambda x:str(x).split('-')[1])
daily_attr['day'] = daily_attr['date'].apply(lambda x:str(x).split('-')[2])
daily_attr['week_order'] = daily_attr['date'].map(lambda x: pd.Period(x, freq='W'))

daily_attr_copy = daily_attr.copy()
daily_attr_copy = daily_attr_copy.rename(
    columns={
        '必要时间': 'necessary time',	
        '有效时间': 'effective time',	
        '浪费时间': 'waste time',	
        '手机时间': 'phone time',
    }
)
```


```python
# 插值
daily_attr_copy = daily_attr_copy.dropna()
daily_attr_copy = daily_attr_copy[daily_attr_copy['date'] >= '2021-01-01']
def daily_interpolate(x, y, z, n=300, step=None):
    xx, yy, zz = x, y, z
    x, y, z = daily_attr_copy[x].values, daily_attr_copy[y].values, daily_attr_copy[z].values
    upper, lower = 75, 25
    xmin, xmax = np.percentile(x, lower), np.percentile(x, upper)
    ymin, ymax = np.percentile(y, lower), np.percentile(y, upper) # 不直接用最大最小避免异常值
    newfunc = interpolate.interp2d(x, y, z, kind='cubic')
    if step is not None:
        X, Y = np.arange(xmin, xmax + step, step), np.arange(ymin, ymax + step, step)
    else:
        X, Y = np.linspace(xmin, xmax, n), np.linspace(ymin, ymax, n),
    Z = newfunc(X, Y)
    plt.figure(figsize=(20, 10))
    im2 = pl.imshow(
        Z, 
        extent=[xmin, xmax, ymin, ymax], 
        cmap=cm.jet_r, 
        interpolation='bilinear', 
        origin='lower',
        aspect='auto'
    )
    title = f'{part} Relationship between {zz} VS {xx} and {yy} after projection to a plane'
    pl.xlabel(xx, fontsize=20)
    pl.ylabel(yy, fontsize=20)
    pl.xticks(fontsize=20)
    pl.yticks(fontsize=20)
    pl.title(title, fontsize=20)
    cb = pl.colorbar(im2)
    cb.ax.tick_params(labelsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)

    X, Y = np.meshgrid(X, Y)
    fig = plt.figure(figsize=(20, 10))
    ax = Axes3D(fig)
    surf2 = ax.plot_surface(
        X, 
        Y, 
        Z, 
        rstride=1, 
        cstride=1, 
        cmap=cm.jet_r,
        linewidth=0.01, 
        antialiased=True
    )
    ax.set_xlabel(xx, fontsize=20)
    ax.set_ylabel(yy, fontsize=20)
    ax.set_zlabel(zz, fontsize=20)
    pl.xticks(fontsize=15)
    pl.yticks(fontsize=15)
    ax.tick_params(axis='z',labelsize=15)
    title = f'{part} Relationship between {zz} VS {xx} and {yy}'
    ax.set_title(title, fontsize=20)
    cb = plt.colorbar(surf2, shrink=0.5, aspect=5)
    cb.ax.tick_params(labelsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600)
```


```python
x, y, z = 'waste time', 'necessary time', 'effective time'
daily_interpolate(x, y, z, n=400)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_56_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_56_1.png)
    



```python
x, y, z = 'phone time', 'necessary time', 'effective time'
daily_interpolate(x, y, z)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_57_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_57_1.png)
    


### 2.4.2) 每天的第一件和最后一件事


```python
# 2.4.2) 每天的第一件和最后一件事
part = '2.4.2'
first_last_event = pd.DataFrame()

# 每天做的第一件事
first_last_event['first_event'] = df[['date', 'event']].\
    groupby(['date'])['event'].first()

# 每天做的最后一件事
first_last_event['last_event'] = df[['date', 'event']].\
    groupby(['date'])['event'].last()

    
first_last_event = first_last_event.reset_index()
first_last_event
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>first_event</th>
      <th>last_event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-02-27</td>
      <td>托福写作与听力</td>
      <td>托福写作</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04</td>
      <td>托福听力</td>
      <td>托福听力</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-05</td>
      <td>托福听力</td>
      <td>公开课</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-06</td>
      <td>托福听力</td>
      <td>磨蹭</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-07</td>
      <td>手机</td>
      <td>排练</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>860</th>
      <td>2021-12-26</td>
      <td>写报告</td>
      <td>写日记</td>
    </tr>
    <tr>
      <th>861</th>
      <td>2021-12-27</td>
      <td>华尔街日报</td>
      <td>写日记</td>
    </tr>
    <tr>
      <th>862</th>
      <td>2021-12-28</td>
      <td>华尔街日报</td>
      <td>写日记</td>
    </tr>
    <tr>
      <th>863</th>
      <td>2021-12-29</td>
      <td>华尔街日报</td>
      <td>写日记</td>
    </tr>
    <tr>
      <th>864</th>
      <td>2021-12-30</td>
      <td>华尔街日报</td>
      <td>写日记</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 3 columns</p>
</div>




```python
# 整体的饼图
plot_pie('first_event', first_last_event, 15)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_60_0.png)
    



```python
# 2019饼图
plot_pie(
    'first_event', 
    first_last_event[first_last_event['date'] < '2020-01-01'], 
    10,
    year=2019
)
plot_pie(
    'last_event', 
    first_last_event[first_last_event['date'] < '2020-01-01'], 
    10,
    year=2019
)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_61_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_61_1.png)
    



```python
# 2020饼图
temp = first_last_event[
    (first_last_event['date'] < '2021-01-01') & (first_last_event['date'] >= '2020-01-01')
]
plot_pie('first_event', temp, 15, year=2020)
plot_pie('last_event', temp, 5, year=2020)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_62_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_62_1.png)
    



```python
# 2021饼图
temp = first_last_event[
    (first_last_event['date'] < '2022-01-01') & (first_last_event['date'] >= '2021-01-01')
]
plot_pie('first_event', temp, 15, year=2021)
plot_pie('last_event', temp, 5, year=2021)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_63_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_63_1.png)
    


### 2.4.3) 每天的第一件和最后一件事的时间


```python
# 2.4.3) 每天的第一件和最后一件事的时间
part = '2.4.3'
first_last_time = pd.merge(
    df.groupby(['date'])['start', 'start_hour'].first(), 
    df.groupby(['date'])['end', 'end_hour'].last(), 
    on='date'
).reset_index().rename(columns={
    'start':'first_start_time', 
    'start_hour':'first_start_hour',
    'end':'last_end_time', 
    'end_hour':'last_end_hour'
})

first_last_time
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>first_start_time</th>
      <th>first_start_hour</th>
      <th>last_end_time</th>
      <th>last_end_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-02-27</td>
      <td>07:40:00</td>
      <td>07</td>
      <td>21:30:00</td>
      <td>21</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04</td>
      <td>07:40:00</td>
      <td>07</td>
      <td>21:40:00</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-05</td>
      <td>07:40:00</td>
      <td>07</td>
      <td>21:45:00</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-06</td>
      <td>07:40:00</td>
      <td>07</td>
      <td>21:40:00</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-07</td>
      <td>07:40:00</td>
      <td>07</td>
      <td>21:40:00</td>
      <td>21</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>860</th>
      <td>2021-12-26</td>
      <td>08:37:05</td>
      <td>08</td>
      <td>22:55:23</td>
      <td>22</td>
    </tr>
    <tr>
      <th>861</th>
      <td>2021-12-27</td>
      <td>08:35:25</td>
      <td>08</td>
      <td>22:49:37</td>
      <td>22</td>
    </tr>
    <tr>
      <th>862</th>
      <td>2021-12-28</td>
      <td>08:36:34</td>
      <td>08</td>
      <td>23:21:50</td>
      <td>23</td>
    </tr>
    <tr>
      <th>863</th>
      <td>2021-12-29</td>
      <td>08:33:53</td>
      <td>08</td>
      <td>22:50:46</td>
      <td>22</td>
    </tr>
    <tr>
      <th>864</th>
      <td>2021-12-30</td>
      <td>08:41:11</td>
      <td>08</td>
      <td>23:06:51</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 5 columns</p>
</div>




```python
# 2019饼图
temp = first_last_time[first_last_time['date'] < '2020-01-01']
plot_pie('first_start_hour', temp, 15, year=2019)
plot_pie('last_end_hour', temp, 5, year=2019)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_66_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_66_1.png)
    



```python
# 2020饼图
temp = first_last_time[
    (first_last_time['date'] < '2021-01-01') & (first_last_time['date'] >= '2020-01-01')
]
plot_pie('first_start_hour', temp, 15, year=2020)
plot_pie('last_end_hour', temp, 5, year=2020)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_67_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_67_1.png)
    



```python
# 2021饼图
temp = first_last_time[
    (first_last_time['date'] < '2022-01-01') & (first_last_time['date'] >= '2021-01-01')
]
plot_pie('first_start_hour', temp, 15, year=2021)
plot_pie('last_end_hour', temp, 5, year=2021)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_68_0.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_68_1.png)
    


### 2.4.4) 每天做的事项数目的统计


```python
# 2.4.4) 每天做的事项数目的统计
part = '2.4.4'
df.groupby('date')['event'].count().\
    reset_index().\
    sort_values(by='event', ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45</th>
      <td>2019-04-18</td>
      <td>30</td>
    </tr>
    <tr>
      <th>129</th>
      <td>2019-07-21</td>
      <td>28</td>
    </tr>
    <tr>
      <th>131</th>
      <td>2019-07-23</td>
      <td>27</td>
    </tr>
    <tr>
      <th>122</th>
      <td>2019-07-13</td>
      <td>27</td>
    </tr>
    <tr>
      <th>116</th>
      <td>2019-07-07</td>
      <td>27</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>518</th>
      <td>2020-11-03</td>
      <td>4</td>
    </tr>
    <tr>
      <th>511</th>
      <td>2020-10-27</td>
      <td>4</td>
    </tr>
    <tr>
      <th>528</th>
      <td>2020-11-13</td>
      <td>3</td>
    </tr>
    <tr>
      <th>527</th>
      <td>2020-11-12</td>
      <td>3</td>
    </tr>
    <tr>
      <th>470</th>
      <td>2020-09-14</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 2 columns</p>
</div>




```python
title = f'{part} 每天做的事项数目的统计'
df.groupby('date')['event'].count().plot(
    figsize=(20, 10)
)
plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Count', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_71_0.png)
    



```python
title = f'{part} 每天做的事项数目的统计直方图'
df.groupby('date')['event'].count().plot(
    kind='hist', figsize=(20, 10)
)

plt.title(title, fontsize=20)
plt.xlabel('Count', fontsize=20)
plt.ylabel('Frequency', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_72_0.png)
    


### 2.4.5) 每天做事项先后编号并统计


```python
# 2.4.5) 每天做事项先后编号并统计
part = '2.4.5'
def get_order(alist):
    return range(1, 1 + len(alist))

daily_event_order = df.groupby('date')['event'].agg(get_order)
daily_event_order = pd.concat(
    [daily_event_order.explode().reset_index().rename(columns={'event':'order'}), 
    df['event'].reset_index()], axis=1
)[['date', 'event', 'order']]
daily_event_order['order'] = daily_event_order['order'].astype(int)
daily_event_order
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>event</th>
      <th>order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-02-27</td>
      <td>托福写作与听力</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-02-27</td>
      <td>python</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-02-27</td>
      <td>快递</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-02-27</td>
      <td>搜索术</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-02-27</td>
      <td>午休</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14506</th>
      <td>2021-12-30</td>
      <td>爬虫</td>
      <td>14</td>
    </tr>
    <tr>
      <th>14507</th>
      <td>2021-12-30</td>
      <td>磨蹭</td>
      <td>15</td>
    </tr>
    <tr>
      <th>14508</th>
      <td>2021-12-30</td>
      <td>数据分析</td>
      <td>16</td>
    </tr>
    <tr>
      <th>14509</th>
      <td>2021-12-30</td>
      <td>玩游戏</td>
      <td>17</td>
    </tr>
    <tr>
      <th>14510</th>
      <td>2021-12-30</td>
      <td>写日记</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
<p>14511 rows × 3 columns</p>
</div>




```python
# 每个事项平均处于每天的第几件事
event_mean_order = daily_event_order[
    (daily_event_order['date'] < '2022-01-01') & 
    (daily_event_order['date'] >= '2021-01-01')
].groupby('event')['order'].mean()

title = f'{part} 各事项平均顺序的统计柱形图'
event_mean_order.sort_values().plot(
    kind='bar', figsize=(20, 10)
)
plt.title(title, fontsize=20)
plt.xlabel('Event', fontsize=20)
plt.ylabel('Mean Order', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_75_0.png)
    



```python
# 每个次序做得最多的事
order_most_event = daily_event_order[
    (daily_event_order['date'] < '2022-01-01') & 
    (daily_event_order['date'] >= '2021-01-01')
].groupby(['order', 'event'])['date'].agg('count').reset_index()

order_most_event = order_most_event.rename(
    columns={'date': 'count'}
)
```


```python
# 每个顺序做的最多的k件事
k = 1
order_mostk_event = pd.concat(
    [order_most_event[order_most_event['order'] == m].\
    sort_values(by='count', ascending=False)[:k] 
    for m in order_most_event['order'].unique()], axis=0
)
order_mostk_event
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order</th>
      <th>event</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>华尔街日报</td>
      <td>278</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2</td>
      <td>运动</td>
      <td>175</td>
    </tr>
    <tr>
      <th>30</th>
      <td>3</td>
      <td>午饭</td>
      <td>183</td>
    </tr>
    <tr>
      <th>44</th>
      <td>4</td>
      <td>人文课</td>
      <td>133</td>
    </tr>
    <tr>
      <th>63</th>
      <td>5</td>
      <td>午休</td>
      <td>199</td>
    </tr>
    <tr>
      <th>91</th>
      <td>6</td>
      <td>玩游戏</td>
      <td>135</td>
    </tr>
    <tr>
      <th>97</th>
      <td>7</td>
      <td>人文书籍</td>
      <td>99</td>
    </tr>
    <tr>
      <th>146</th>
      <td>8</td>
      <td>量化</td>
      <td>71</td>
    </tr>
    <tr>
      <th>170</th>
      <td>9</td>
      <td>量化</td>
      <td>64</td>
    </tr>
    <tr>
      <th>192</th>
      <td>10</td>
      <td>磨蹭</td>
      <td>57</td>
    </tr>
    <tr>
      <th>217</th>
      <td>11</td>
      <td>磨蹭</td>
      <td>65</td>
    </tr>
    <tr>
      <th>244</th>
      <td>12</td>
      <td>运动</td>
      <td>63</td>
    </tr>
    <tr>
      <th>258</th>
      <td>13</td>
      <td>晚饭</td>
      <td>67</td>
    </tr>
    <tr>
      <th>269</th>
      <td>14</td>
      <td>人文课</td>
      <td>63</td>
    </tr>
    <tr>
      <th>305</th>
      <td>15</td>
      <td>磨蹭</td>
      <td>64</td>
    </tr>
    <tr>
      <th>330</th>
      <td>16</td>
      <td>磨蹭</td>
      <td>77</td>
    </tr>
    <tr>
      <th>336</th>
      <td>17</td>
      <td>写日记</td>
      <td>63</td>
    </tr>
    <tr>
      <th>357</th>
      <td>18</td>
      <td>写日记</td>
      <td>58</td>
    </tr>
    <tr>
      <th>372</th>
      <td>19</td>
      <td>写日记</td>
      <td>46</td>
    </tr>
    <tr>
      <th>382</th>
      <td>20</td>
      <td>写日记</td>
      <td>24</td>
    </tr>
    <tr>
      <th>390</th>
      <td>21</td>
      <td>写日记</td>
      <td>9</td>
    </tr>
    <tr>
      <th>395</th>
      <td>22</td>
      <td>写日记</td>
      <td>4</td>
    </tr>
    <tr>
      <th>396</th>
      <td>23</td>
      <td>写日记</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



### 2.4.6) 各事项关于日期的透视表


```python
# 2.4.6) 各事项关于日期的透视表
part = '2.4.6'
def get_pivot(df, item, layer, attr, ops):
    tmp = df.groupby([item, layer])[attr].agg(ops).to_frame('values').reset_index()
    my_pivot = pd.pivot_table(
        data=tmp, 
        index=item,
        columns=layer,
        values='values',
        fill_value=0
    )
    my_pivot.columns = [
        my_pivot.columns.names[0] + f'_{attr}_pivot_{ops}_' + str(col) 
        for col in my_pivot.columns
    ]
    return my_pivot
```


```python
# 日度时长总和透视
sum_pivot = get_pivot(df, 'date', 'event', 'duration', 'sum')
sum_pivot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_duration_pivot_sum_AQF</th>
      <th>event_duration_pivot_sum_C++</th>
      <th>event_duration_pivot_sum_GMAT</th>
      <th>event_duration_pivot_sum_GMAT学习</th>
      <th>event_duration_pivot_sum_GMAT直播</th>
      <th>event_duration_pivot_sum_GMAT视频</th>
      <th>event_duration_pivot_sum_GMAT试题</th>
      <th>event_duration_pivot_sum_GMAT长难句</th>
      <th>event_duration_pivot_sum_GRE</th>
      <th>event_duration_pivot_sum_GRE写作</th>
      <th>...</th>
      <th>event_duration_pivot_sum_金融法</th>
      <th>event_duration_pivot_sum_银行会计</th>
      <th>event_duration_pivot_sum_长难句</th>
      <th>event_duration_pivot_sum_陪诊</th>
      <th>event_duration_pivot_sum_随机微积分</th>
      <th>event_duration_pivot_sum_随机过程</th>
      <th>event_duration_pivot_sum_雷欧奥特曼</th>
      <th>event_duration_pivot_sum_面试</th>
      <th>event_duration_pivot_sum_项目管理</th>
      <th>event_duration_pivot_sum_风险管理</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-02-27</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-04</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-05</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-06</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-07</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-12-26</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-27</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-28</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-29</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-30</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 243 columns</p>
</div>




```python
# 接单工作每天总时长分析
print(
    'The mean time for 接单工作 in year 2021 every day is', sum_pivot['event_duration_pivot_sum_接单工作'][
                        sum_pivot.index >= '2021-01-01'
].mean()
)

sum_pivot['event_duration_pivot_sum_接单工作'][
    sum_pivot['event_duration_pivot_sum_接单工作'] > 0
]
```

    The mean time for 接单工作 in year 2021 every day is 72.95221843003414
    




    date
    2020-11-15    473
    2020-11-16    354
    2020-11-17     87
    2020-11-18    183
    2020-11-19    187
                 ... 
    2021-12-23    135
    2021-12-24    112
    2021-12-26    121
    2021-12-27     70
    2021-12-29     20
    Name: event_duration_pivot_sum_接单工作, Length: 228, dtype: int64




```python
title = f'{part} 每日接单工作时长折线图'

sum_pivot['event_duration_pivot_sum_接单工作'][
    sum_pivot['event_duration_pivot_sum_接单工作'] > 0
].plot(figsize=(20, 10), title=title)

plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Sum of duration', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_82_0.png)
    



```python
title = f'{part} 每日接单工作时长直方图'

sum_pivot['event_duration_pivot_sum_接单工作'][
    sum_pivot['event_duration_pivot_sum_接单工作'] > 0
].plot(
    kind='hist', figsize=(20, 10), title=title
)

plt.title(title, fontsize=20)
plt.xlabel('Sum of duration', fontsize=20)
plt.ylabel('Frequency', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_83_0.png)
    



```python
# 磨蹭每天总时长分析
print(
    'The mean time for 磨蹭 in year 2021 every day is', sum_pivot['event_duration_pivot_sum_磨蹭'][
                    sum_pivot.index >= '2021-01-01'
].mean()
)

sum_pivot['event_duration_pivot_sum_磨蹭'][
    sum_pivot['event_duration_pivot_sum_磨蹭'] > 0
]
```

    The mean time for 磨蹭 in year 2021 every day is 75.38907849829351
    




    date
    2019-02-27     40
    2019-03-04     30
    2019-03-05    108
    2019-03-06     90
    2019-03-07     60
                 ... 
    2021-12-26     42
    2021-12-27     83
    2021-12-28    105
    2021-12-29    110
    2021-12-30     89
    Name: event_duration_pivot_sum_磨蹭, Length: 815, dtype: int64




```python
title = f'{part} 每日磨蹭时长折线图'

sum_pivot['event_duration_pivot_sum_磨蹭'][
    sum_pivot['event_duration_pivot_sum_磨蹭'] > 0
].plot(figsize=(20, 10), title=title)


plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Sum of duration', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_85_0.png)
    



```python
title = f'{part} 每日磨蹭时长直方图'

sum_pivot['event_duration_pivot_sum_磨蹭'][
    sum_pivot['event_duration_pivot_sum_磨蹭'] > 0
].plot(
    kind='hist', figsize=(20, 10), title=title
)

plt.title(title, fontsize=20)
plt.xlabel('Count', fontsize=20)
plt.ylabel('Frequency', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_86_0.png)
    



```python
# 次数透视
count_pivot = get_pivot(df, 'date', 'event', 'duration', 'count')
count_pivot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_duration_pivot_count_AQF</th>
      <th>event_duration_pivot_count_C++</th>
      <th>event_duration_pivot_count_GMAT</th>
      <th>event_duration_pivot_count_GMAT学习</th>
      <th>event_duration_pivot_count_GMAT直播</th>
      <th>event_duration_pivot_count_GMAT视频</th>
      <th>event_duration_pivot_count_GMAT试题</th>
      <th>event_duration_pivot_count_GMAT长难句</th>
      <th>event_duration_pivot_count_GRE</th>
      <th>event_duration_pivot_count_GRE写作</th>
      <th>...</th>
      <th>event_duration_pivot_count_金融法</th>
      <th>event_duration_pivot_count_银行会计</th>
      <th>event_duration_pivot_count_长难句</th>
      <th>event_duration_pivot_count_陪诊</th>
      <th>event_duration_pivot_count_随机微积分</th>
      <th>event_duration_pivot_count_随机过程</th>
      <th>event_duration_pivot_count_雷欧奥特曼</th>
      <th>event_duration_pivot_count_面试</th>
      <th>event_duration_pivot_count_项目管理</th>
      <th>event_duration_pivot_count_风险管理</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2019-02-27</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-04</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-05</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-06</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2019-03-07</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-12-26</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-27</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-28</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-29</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2021-12-30</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 243 columns</p>
</div>




```python
# 接单工作次数分析
title = f'{part} 每日接单工作次数折线图'

count_pivot['event_duration_pivot_count_接单工作'][
    count_pivot['event_duration_pivot_count_接单工作'] > 0
].plot(figsize=(20, 10), title=title)

plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Count', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_88_0.png)
    



```python
title = f'{part} 每日接单工作次数直方图'

count_pivot['event_duration_pivot_count_接单工作'][
    count_pivot['event_duration_pivot_count_接单工作'] > 0
].plot(kind='hist', figsize=(20, 10), title=title)

plt.title(title, fontsize=20)
plt.xlabel('Count', fontsize=20)
plt.ylabel('Frequency', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_89_0.png)
    



```python
# 磨蹭次数分析
print(
    'The mean count for 磨蹭 in year 2021 every day is', count_pivot['event_duration_pivot_count_磨蹭'][
                    count_pivot.index >= '2021-01-01'
].mean()
)

count_pivot['event_duration_pivot_count_磨蹭'][
    count_pivot['event_duration_pivot_count_磨蹭'] > 0
]
```

    The mean count for 磨蹭 in year 2021 every day is 2.310580204778157
    




    date
    2019-02-27    1
    2019-03-04    1
    2019-03-05    4
    2019-03-06    2
    2019-03-07    2
                 ..
    2021-12-26    1
    2021-12-27    3
    2021-12-28    2
    2021-12-29    2
    2021-12-30    3
    Name: event_duration_pivot_count_磨蹭, Length: 815, dtype: int64




```python
title = f'{part} 每日磨蹭次数折线图'

count_pivot['event_duration_pivot_count_磨蹭'][
    count_pivot['event_duration_pivot_count_磨蹭'] > 0
].plot(figsize=(20, 10), title=title)

plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Count', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_91_0.png)
    



```python
title = f'{part} 每日磨蹭次数直方图'

count_pivot['event_duration_pivot_count_磨蹭'][
    count_pivot['event_duration_pivot_count_磨蹭'] > 0
].plot(kind='hist', figsize=(20, 10), title=title)

plt.title(title, fontsize=20)
plt.xlabel('Count', fontsize=20)
plt.ylabel('Frequency', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_92_0.png)
    


### 2.4.7) 每年, 月, 星期的事项关键词词云图


```python
part = '2.4.7'
def get_keys(dic, threshold=.5):
    _sum = sum(list(dic.values()))
    res, key_sum = [], 0
    for k, v in sorted(dic.items(), key=lambda x:x[1], reverse=True):
        if key_sum / _sum <= threshold:
            res.append(k)
            key_sum += v
    return ' '.join(res)

def get_key_words(info, col, threshold=1):
    info = info.groupby(col)['event'].agg(list).reset_index()
    dct = Dictionary(info['event'].values)
    corpus = [dct.doc2bow(line) for line in info['event'].values] 

    # 用TfidfModel筛选关键词
    model = TfidfModel(corpus)
    movie_profile = {}
    for i, mid in enumerate(info[col]):
        vector = model[corpus[i]]
        movie_tag = sorted(vector, key=lambda x:x[1], reverse=True)
        movie_profile[mid] = dict(map(lambda x:(dct[x[0]], x[1]), movie_tag))

    info['key_words'] = [get_keys(dic, threshold) for _, dic in movie_profile.items()]   
    return info 

# 定义生成背景字样的函数
def WordPic(text, path):
    lens = 2000
    image = Image.new("RGB",(lens,lens),"white")
    draw_table = ImageDraw.Draw(im=image)
    draw_table.text(
        xy=(0, lens // 3), 
        text=str(text), 
        fill='#000000', 
        font=ImageFont.truetype('C:\\windows\\Fonts\\STHUPO.ttf', 450)
    )
    
    # image.show()  # 直接显示图片
    image.save(os.path.join(path, 'back.png'), 'PNG')  # 保存在当前路径下，格式为PNG
    image.close()

# 筛选关键词中的event做词云图
def plot_key_word_cloud(info, col, path='', mask=None, store=True):
    info['plot_words'] = info.apply(
        lambda x: [e for e in x['event'] if e in x['key_words']],
        axis=1
    )
    for c, words in tqdm(info[[col, 'key_words']].itertuples(index=False)):
        try:
            dpi = 500
            if mask is not None:
                dpi = 1500
                WordPic(c, path)
                mask = np.array(Image.open(os.path.join(path, 'back.png')))
            
            cut_text = ' '.join(jieba.cut(''.join(words)))
            wordcloud = WordCloud(
                font_path='C:\\windows\\Fonts\\STHUPO.ttf', 
                background_color='white', mask=mask,
                collocations=False,
                scale=2
            ).generate(cut_text)
            plt.figure(dpi=200)
            plt.imshow(wordcloud, interpolation='bilinear')
            plt.axis('off')
            if store:
                plt.savefig(
                    os.path.join(path, f'{part} 按{col}分类后{c}的关键词.png'), 
                    dpi=dpi
                )
        except:
            continue
```


```python
# 年度关键词词云图
col = 'year'
year_key_words = get_key_words(df, col)
plot_key_word_cloud(year_key_words, col, path=path, mask=1)
year_key_words
```

    3it [00:47, 15.73s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>[托福写作与听力, python, 快递, 搜索术, 午休, 托福听力, 博弈论, 博弈论,...</td>
      <td>单词 偏微分 GRE填空 课 银行会计 练字 AQF 托福听力 GRE阅读 托福口语 数值分...</td>
      <td>[托福写作与听力, python, 搜索术, 托福听力, 博弈论, 博弈论, 晚饭, 雷欧奥...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>[复变, 玩游戏, 写报告, 算法课程, 午饭, 午休, 西洋画, 单词, 毕业论文, 量化...</td>
      <td>人工智能 泛函 人文书籍 实变 随机微积分 运动 单词 毕业论文 人文课 金数 python...</td>
      <td>[复变, 西洋画, 单词, 毕业论文, 随机过程, 复变, 复变, 干洗, 西洋画, 单词,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021</td>
      <td>[华尔街日报, 运动, 华尔街日报, 午饭, 人文课, 午休, 磨蹭, 华尔街日报, 玩游戏...</td>
      <td>人文课 运动 接单工作 人文书籍 机器学习 深度学习 做家务 数据分析 爬虫 大数据 gis...</td>
      <td>[运动, 人文课, 人文书籍, 运动, 人文课, linux, 运动, 人文书籍, 做家务,...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_95_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_95_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_95_4.png)
    



```python
# 2021年每月关键词
col = 'month'
month_key_words = get_key_words(df[df['year'] == '2021'], col)
plot_key_word_cloud(month_key_words, col, path=path)
month_key_words
```

    12it [00:16,  1.40s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01</td>
      <td>[华尔街日报, 运动, 华尔街日报, 午饭, 人文课, 午休, 磨蹭, 华尔街日报, 玩游戏...</td>
      <td>算法课程 检查设备 改代码 linux 做家务 快递 散步 摄影</td>
      <td>[算法课程, 算法课程, linux, 算法课程, 做家务, 算法课程, 算法课程, 做家务...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>02</td>
      <td>[华尔街日报, 运动, 华尔街日报, 午饭, 午休, 玩游戏, 人文书籍, 量化, 算法课程...</td>
      <td>算法课程 散步 正则 gis 修图 整理笔记 走亲 逛街 写推文 答疑 爬虫</td>
      <td>[算法课程, 算法课程, 散步, 算法课程, 算法课程, 散步, 逛街, 算法课程, 算法课...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>03</td>
      <td>[接单工作, 华尔街日报, 做家务, 华尔街日报, 午饭, 人文课, 午休, 玩游戏, 人文...</td>
      <td>机器学习 算法课程 快递 清理内存 写计划 写推文 爬虫 gis 做家务 数据分析 摄影</td>
      <td>[做家务, 算法课程, 算法课程, 算法课程, 做家务, 算法课程, 爬虫, 写推文, 算法...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>04</td>
      <td>[华尔街日报, 运动, 午饭, 人文课, 午休, 玩游戏, 人文书籍, 爬虫, 机器学习, ...</td>
      <td>机器学习 写报告 爬虫 摄影 快递 做家务 数据分析</td>
      <td>[爬虫, 机器学习, 爬虫, 机器学习, 爬虫, 机器学习, 爬虫, 做家务, 爬虫, 摄影...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>05</td>
      <td>[华尔街日报, 午饭, 写报告, 午休, 写报告, 玩游戏, 写报告, 晚饭, 写报告, 玩...</td>
      <td>机器学习 答疑 写报告 换锁 散步 做家务 摄影</td>
      <td>[写报告, 写报告, 写报告, 写报告, 答疑, 机器学习, 散步, 机器学习, 散步, 机...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>06</td>
      <td>[华尔街日报, 做家务, 午饭, 人文课, 午休, 玩游戏, 人文书籍, 机器学习, 人文课...</td>
      <td>gis 机器学习 数据分析 安装软件 制定计划 下载软件 快递 答疑 摄影 做家务 爬虫</td>
      <td>[做家务, 机器学习, 摄影, 机器学习, 做家务, 机器学习, 摄影, 机器学习, 摄影,...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>07</td>
      <td>[华尔街日报, 运动, 午饭, 人文课, 午休, 玩游戏, 人文书籍, 数据分析, 量化, ...</td>
      <td>数据分析 化妆 拍视频 接种疫苗 摄影 做家务 散步 爬虫</td>
      <td>[数据分析, 做家务, 数据分析, 摄影, 爬虫, 数据分析, 摄影, 化妆, 做家务, 数...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>08</td>
      <td>[华尔街日报, 运动, 午饭, 午休, 人文书籍, 量化, 摄影, 晚饭, 摄影, 晚饭, ...</td>
      <td>linux 配置环境 数据分析 找资源 摄影 做家务 爬虫</td>
      <td>[摄影, 摄影, 摄影, 摄影, 摄影, 摄影, 摄影, 摄影, 数据分析, 摄影, 数据分...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>09</td>
      <td>[华尔街日报, 运动, 午饭, 人文课, 午休, 磨蹭, 人文书籍, 量化, 摄影, 接单工...</td>
      <td>深度学习 linux 摄影 数据分析 制定计划 做家务 快递 爬虫</td>
      <td>[摄影, linux, linux, 摄影, 摄影, 摄影, linux, 做家务, 摄影,...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>[华尔街日报, 运动, 午饭, 华尔街日报, 午休, 磨蹭, 摄影, 接单工作, 运动, 晚...</td>
      <td>大数据 深度学习 托福写作 托福听力 托福阅读 摄影 买东西 监工 托福口语 线上研讨 爬虫...</td>
      <td>[摄影, 深度学习, 深度学习, 深度学习, 摄影, 深度学习, 散步, 摄影, 深度学习,...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>[华尔街日报, 运动, 午饭, 人文课, 午休, 玩游戏, 量化, 托福阅读, 磨蹭, 托福...</td>
      <td>托福写作 托福口语 托福听力 托福阅读 写报告 安装软件 做视频 报名考试 演唱会 爬虫 线...</td>
      <td>[托福阅读, 托福写作, 做家务, 托福写作, 托福听力, 安装软件, 托福写作, 做视频,...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>[华尔街日报, 运动, 量化, 午饭, 人文课, 午休, 量化, 磨蹭, 摄影, 深度学习,...</td>
      <td>写报告 gis 深度学习 散步 外出游玩 摄影 制定计划 爬虫 做家务 数据分析</td>
      <td>[摄影, 深度学习, 摄影, 写报告, 做家务, 写报告, 写报告, 摄影, 写报告, 写报...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_96_13.png)
    



```python
# 2021年 每day_period关键词
col = 'day_period'
day_period_key_words = get_key_words(df[df['year'] == '2021'], col)
plot_key_word_cloud(day_period_key_words, col, path=path)
day_period_key_words
```

    5it [00:06,  1.26s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day_period</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>afternoon</td>
      <td>[午休, 磨蹭, 华尔街日报, 玩游戏, 人文书籍, 量化, 玩游戏, 算法课程, 运动, ...</td>
      <td>午休 玩游戏 量化 晚饭 人文书籍 磨蹭 算法课程 机器学习 运动 人文课 做家务 数据分析...</td>
      <td>[午休, 磨蹭, 华尔街日报, 玩游戏, 人文书籍, 量化, 玩游戏, 算法课程, 运动, ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>evening</td>
      <td>[晚饭, 人文课, 玩游戏, linux, 磨蹭, 写日记, 晚饭, 玩游戏, 接单工作, ...</td>
      <td>写日记 晚饭 人文课 磨蹭 深度学习 量化 玩游戏 散步 摄影 托福写作 托福听力 托福口语...</td>
      <td>[晚饭, 人文课, 玩游戏, linux, 磨蹭, 写日记, 晚饭, 玩游戏, 磨蹭, 写日...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>morning</td>
      <td>[华尔街日报, 运动, 华尔街日报, 磨蹭, 华尔街日报, 运动, 华尔街日报, 做家务, ...</td>
      <td>华尔街日报 做家务 运动 磨蹭 报名考试 检查设备 写日记 线上研讨 午饭 快递 gis 写...</td>
      <td>[华尔街日报, 运动, 华尔街日报, 磨蹭, 华尔街日报, 运动, 华尔街日报, 做家务, ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>night</td>
      <td>[接单工作, 接单工作]</td>
      <td></td>
      <td>[]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>noon</td>
      <td>[华尔街日报, 午饭, 人文课, 运动, 午饭, 华尔街日报, 午饭, 午饭, 人文课, 磨...</td>
      <td>午饭 人文课 华尔街日报 磨蹭 量化 人文书籍 午休 找资源 整理笔记 监工 数据分析 运动...</td>
      <td>[华尔街日报, 午饭, 人文课, 运动, 午饭, 华尔街日报, 午饭, 午饭, 人文课, 磨...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_97_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_97_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_97_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_97_5.png)
    



```python
# 2021年 duration_attr关键词
col = 'duration_attr'
duration_attr_key_words = get_key_words(df[df['year'] == '2021'], col)
plot_key_word_cloud(duration_attr_key_words, col, path=path)
duration_attr_key_words
```

    3it [00:04,  1.56s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration_attr</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>long</td>
      <td>[华尔街日报, 量化, 算法课程, linux, 磨蹭, 华尔街日报, 量化, 算法课程, ...</td>
      <td>散步 托福阅读 下载软件 修图 外出游玩 接种疫苗 监工 走亲 逛街 安装软件 检查设备 正...</td>
      <td>[检查设备, 散步, 逛街, 散步, 散步, 走亲, 修图, 散步, 散步, 正则, 散步,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>middle</td>
      <td>[运动, 午休, 晚饭, 人文课, 午饭, 午休, 算法课程, 晚饭, 磨蹭, 接单工作, ...</td>
      <td>运动 做家务 散步 配置环境 写日记 制定计划 答疑 买东西 做视频 化妆 找资源 报名考试...</td>
      <td>[运动, 运动, 运动, 做家务, 检查设备, 运动, 运动, 做家务, 运动, 做家务, ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>short</td>
      <td>[华尔街日报, 午饭, 人文课, 磨蹭, 华尔街日报, 玩游戏, 人文书籍, 玩游戏, 运动...</td>
      <td>运动 写日记 做家务 答疑 写计划 换锁 整理笔记 正则 清理内存 写推文 制定计划</td>
      <td>[运动, 写日记, 运动, 做家务, 写日记, 运动, 运动, 写日记, 做家务, 写日记,...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_98_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_98_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_98_4.png)
    



```python
# 2021年 attr关键词
col = 'attr'
attr_key_words = get_key_words(df[df['year'] == '2021'], col, threshold=.8)
plot_key_word_cloud(attr_key_words, col, path=path)
attr_key_words
```

    3it [00:03,  1.18s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>attr</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>必要时间</td>
      <td>[运动, 午饭, 午休, 运动, 晚饭, 写日记, 运动, 午饭, 午休, 做家务, 晚饭,...</td>
      <td>运动 接单工作 写日记 午饭 晚饭 午休</td>
      <td>[运动, 午饭, 午休, 运动, 晚饭, 写日记, 运动, 午饭, 午休, 晚饭, 接单工作...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>有效时间</td>
      <td>[华尔街日报, 华尔街日报, 人文课, 华尔街日报, 人文书籍, 量化, 算法课程, 算法课...</td>
      <td>人文课 华尔街日报 量化 人文书籍 摄影 机器学习</td>
      <td>[华尔街日报, 华尔街日报, 人文课, 华尔街日报, 人文书籍, 量化, 人文课, 华尔街日...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>浪费时间</td>
      <td>[磨蹭, 玩游戏, 玩游戏, 玩游戏, 磨蹭, 磨蹭, 玩游戏, 玩游戏, 玩游戏, 磨蹭,...</td>
      <td>磨蹭 玩游戏</td>
      <td>[磨蹭, 玩游戏, 玩游戏, 玩游戏, 磨蹭, 磨蹭, 玩游戏, 玩游戏, 玩游戏, 磨蹭,...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_99_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_99_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_99_4.png)
    



```python
# 2021年 weekday关键词
col = 'weekday'
weekday_key_words = get_key_words(df[df['year'] == '2021'], col, threshold=1)
plot_key_word_cloud(weekday_key_words, col, path=path)
weekday_key_words
```

    7it [00:09,  1.35s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weekday</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>[华尔街日报, 磨蹭, 运动, 午饭, 午休, 华尔街日报, 玩游戏, 人文书籍, 量化, ...</td>
      <td>化妆 整理笔记 安装软件 写推文 正则 散步 答疑 快递 linux 大数据 托福阅读</td>
      <td>[散步, 整理笔记, 写推文, 散步, 散步, 正则, 快递, 快递, 答疑, 散步, 答疑...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>[华尔街日报, 运动, 华尔街日报, 午饭, 磨蹭, 午休, 华尔街日报, 玩游戏, 人文书...</td>
      <td>正则 下载软件 修图 做视频 外出游玩 找资源 走亲 线上研讨 制定计划 散步 答疑 lin...</td>
      <td>[散步, 走亲, 修图, 正则, 正则, 散步, 快递, 下载软件, 制定计划, 答疑, 找...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>[华尔街日报, 做家务, 午饭, 人文课, 磨蹭, 午休, 华尔街日报, 玩游戏, 人文书籍...</td>
      <td>接种疫苗 逛街 散步 制定计划 linux 答疑 快递 托福阅读</td>
      <td>[逛街, 散步, 答疑, 散步, 快递, 散步, 接种疫苗, linux, linux, l...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>[华尔街日报, 磨蹭, 运动, 华尔街日报, 午饭, 人文课, 午休, 华尔街日报, 玩游戏...</td>
      <td>检查设备 配置环境 买东西 写推文 线上研讨 大数据 安装软件 快递 linux 托福阅读 散步</td>
      <td>[检查设备, 检查设备, 散步, 写推文, 快递, 快递, 安装软件, 配置环境, 配置环境...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>[华尔街日报, 运动, 华尔街日报, 午饭, 人文课, 午休, 玩游戏, 人文书籍, 量化,...</td>
      <td>清理内存 拍视频 换锁 配置环境 大数据 制定计划 散步 答疑 linux 快递 托福阅读</td>
      <td>[快递, 散步, 清理内存, 清理内存, 答疑, 换锁, 制定计划, 拍视频, 散步, 配置...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>[接单工作, 华尔街日报, 磨蹭, 午饭, 午休, 华尔街日报, 玩游戏, 人文书籍, 量化...</td>
      <td>写计划 报名考试 安装软件 大数据 托福阅读</td>
      <td>[写计划, 大数据, 大数据, 托福阅读, 报名考试, 安装软件]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>[华尔街日报, 运动, 华尔街日报, 午饭, 人文课, 午休, 磨蹭, 华尔街日报, 玩游戏...</td>
      <td>改代码 演唱会 监工 散步 制定计划 linux 答疑 大数据 快递</td>
      <td>[linux, 改代码, 散步, 散步, 散步, 快递, 答疑, linux, linux,...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_100_8.png)
    



```python
# 2021年 mid_hour关键词
col = 'mid_hour'
midhour_key_words = get_key_words(df[df['year'] == '2021'], col, threshold=1)
plot_key_word_cloud(midhour_key_words, col, path=path)
midhour_key_words
```

    17it [00:24,  1.43s/it]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mid_hour</th>
      <th>event</th>
      <th>key_words</th>
      <th>plot_words</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>[华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街...</td>
      <td>华尔街日报</td>
      <td>[华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>[运动, 磨蹭, 运动, 做家务, 磨蹭, 运动, 运动, 磨蹭, 运动, 运动, 做家务,...</td>
      <td>运动 做家务 磨蹭 报名考试 华尔街日报 检查设备 午饭 写日记 gis 快递 答疑 摄影 ...</td>
      <td>[运动, 磨蹭, 运动, 做家务, 磨蹭, 运动, 运动, 磨蹭, 运动, 运动, 做家务,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>[华尔街日报, 午饭, 人文课, 运动, 午饭, 华尔街日报, 午饭, 午饭, 人文课, 磨...</td>
      <td>午饭 人文课 华尔街日报 磨蹭 人文书籍 量化 午休 找资源 整理笔记 监工 运动 数据分析...</td>
      <td>[华尔街日报, 午饭, 人文课, 运动, 午饭, 华尔街日报, 午饭, 午饭, 人文课, 磨...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13</td>
      <td>[午休, 午休, 磨蹭, 午休, 午休, 华尔街日报, 人文课, 午休, 人文课, 午休, ...</td>
      <td>午休 玩游戏 人文课 午饭 磨蹭 接种疫苗 逛街 人文书籍 华尔街日报 数据分析 量化 接单工作</td>
      <td>[午休, 午休, 磨蹭, 午休, 午休, 华尔街日报, 人文课, 午休, 人文课, 午休, ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14</td>
      <td>[磨蹭, 华尔街日报, 玩游戏, 华尔街日报, 玩游戏, 人文书籍, 华尔街日报, 玩游戏,...</td>
      <td>人文书籍 玩游戏 量化 磨蹭 华尔街日报 配置环境 爬虫 午休 化妆 改代码 写推文 人文课...</td>
      <td>[磨蹭, 华尔街日报, 玩游戏, 华尔街日报, 玩游戏, 人文书籍, 华尔街日报, 玩游戏,...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>15</td>
      <td>[人文书籍, 量化, 量化, 量化, 人文书籍, 量化, 人文课, 玩游戏, 人文书籍, 量...</td>
      <td>量化 机器学习 人文书籍 托福阅读 磨蹭 玩游戏 gis 爬虫 摄影 托福口语 数据分析 托...</td>
      <td>[人文书籍, 量化, 量化, 量化, 人文书籍, 量化, 人文课, 玩游戏, 人文书籍, 量...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>16</td>
      <td>[玩游戏, 玩游戏, 玩游戏, 玩游戏, 量化, 玩游戏, 玩游戏, 玩游戏, 玩游戏, 量...</td>
      <td>玩游戏 磨蹭 量化 托福写作 摄影 托福听力 写报告 深度学习 机器学习 托福口语 做视频 ...</td>
      <td>[玩游戏, 玩游戏, 玩游戏, 玩游戏, 量化, 玩游戏, 玩游戏, 玩游戏, 玩游戏, 量...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>17</td>
      <td>[算法课程, 算法课程, 算法课程, 算法课程, 算法课程, 算法课程, 算法课程, 算法课...</td>
      <td>算法课程 量化 磨蹭 机器学习 摄影 数据分析 运动 玩游戏 大数据 晚饭 托福写作 托福听...</td>
      <td>[算法课程, 算法课程, 算法课程, 算法课程, 算法课程, 算法课程, 算法课程, 算法课...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18</td>
      <td>[运动, 算法课程, 做家务, 算法课程, 运动, 晚饭, 运动, 接单工作, 运动, 磨蹭...</td>
      <td>晚饭 运动 做家务 算法课程 磨蹭 人文书籍 量化 散步 摄影 深度学习 玩游戏 写计划 人...</td>
      <td>[运动, 算法课程, 做家务, 算法课程, 运动, 晚饭, 运动, 接单工作, 运动, 磨蹭...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>19</td>
      <td>[晚饭, 人文课, 晚饭, 玩游戏, 人文课, 玩游戏, 晚饭, 玩游戏, 晚饭, 人文课,...</td>
      <td>晚饭 人文课 散步 玩游戏 磨蹭 人文书籍 修图 拍视频 换锁 接单工作 量化 爬虫 快递 ...</td>
      <td>[晚饭, 人文课, 晚饭, 玩游戏, 人文课, 玩游戏, 晚饭, 玩游戏, 晚饭, 人文课,...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>20</td>
      <td>[玩游戏, linux, 接单工作, 接单工作, 人文课, 人文课, 人文课, 接单工作, ...</td>
      <td>人文课 磨蹭 摄影 玩游戏 深度学习 大数据 快递 接单工作 linux 托福口语 晚饭 数...</td>
      <td>[玩游戏, linux, 接单工作, 接单工作, 人文课, 人文课, 人文课, 接单工作, ...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>21</td>
      <td>[接单工作, 接单工作, 磨蹭, 接单工作, 接单工作, 磨蹭, 磨蹭, 接单工作, 接单工...</td>
      <td>磨蹭 运动 摄影 深度学习 linux 托福写作 托福听力 量化 人文课 接单工作 托福口语...</td>
      <td>[接单工作, 接单工作, 磨蹭, 接单工作, 接单工作, 磨蹭, 磨蹭, 接单工作, 接单工...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22</td>
      <td>[磨蹭, 磨蹭, 接单工作, 磨蹭, 人文课, 磨蹭, 人文课, 磨蹭, 磨蹭, 人文课, ...</td>
      <td>写日记 磨蹭 量化 人文课 托福听力 托福写作 深度学习 制定计划 托福口语 机器学习 摄影...</td>
      <td>[磨蹭, 磨蹭, 接单工作, 磨蹭, 人文课, 磨蹭, 人文课, 磨蹭, 磨蹭, 人文课, ...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>23</td>
      <td>[写日记, 写日记, 写日记, 写日记, 人文课, 写日记, 写日记, 写日记, 写日记, ...</td>
      <td>写日记 安装软件 人文课 摄影 接单工作</td>
      <td>[写日记, 写日记, 写日记, 写日记, 人文课, 写日记, 写日记, 写日记, 写日记, ...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>7</td>
      <td>[接单工作, 接单工作]</td>
      <td>接单工作</td>
      <td>[接单工作, 接单工作]</td>
    </tr>
    <tr>
      <th>15</th>
      <td>8</td>
      <td>[华尔街日报, 接单工作, 接单工作, 线上研讨, 写报告, 磨蹭]</td>
      <td>线上研讨 华尔街日报 写报告 磨蹭 接单工作</td>
      <td>[华尔街日报, 接单工作, 接单工作, 线上研讨, 写报告, 磨蹭]</td>
    </tr>
    <tr>
      <th>16</th>
      <td>9</td>
      <td>[接单工作, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 接单工作, 华尔街日报...</td>
      <td>华尔街日报 爬虫 写报告 接单工作</td>
      <td>[接单工作, 华尔街日报, 华尔街日报, 华尔街日报, 华尔街日报, 接单工作, 华尔街日报...</td>
    </tr>
  </tbody>
</table>
</div>




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_101_18.png)
    


### 2.4.8) 每天事项的对应先后以及月度关联的网络图


```python
# 2.4.8) 每天事项的对应先后以及月度关联的网络图
node_color = {
    '有效时间':'r', 
    '浪费时间':'b',
    '必要时间':'g'
}

part = '2.4.8'

def sort_dic(dic:dict, reverse=True):
    temp = sorted(dic.items(), key=lambda x:x[1], reverse=reverse)
    res = '{'
    for k, v in temp:
        res += f'{k}:{v},'
    res += '}'
    return res

def net(df, col_from, col_to, year, weight=None, dis=None, directed=False):
    if weight is None:
        df['weight'] = 1
        df = df.groupby([col_from, col_to])['weight'].sum().reset_index()
        df = df.rename(columns={
            col_from:'from', 
            col_to:'to'
        })
    else:
        df = df.rename(columns={
            col_from:'from', 
            col_to:'to',  
            weight:'weight'
        })
    
    if directed:
        GA = nx.from_pandas_edgelist(
            df, 
            source="from", 
            target="to", 
            edge_attr='weight', 
            create_using=nx.DiGraph()
        )
    else:
        GA = nx.from_pandas_edgelist(
            df, 
            source="from", 
            target="to", 
            edge_attr='weight', 
        )
    print(nx.info(GA))
    author_lst = df['from'].to_list() + df['to'].to_list()

    dic = {i: author_lst.count(i) for i in author_lst if author_lst.count(i) > 0}
    nodelst = []
    node_colors = []
    sizes = []
    for m, k in dic.items():
        if node_color.get(event2attr.get(m)) is not None:
            node_colors.append(node_color.get(event2attr.get(m)))
        else:
            node_colors.append('m')
        nodelst.append(m)
        sizes.append(k * 3000)
    print('closeness_centrality:', sort_dic(nx.betweenness_centrality(GA)))
    plt.figure(figsize=(50, 50), dpi=50)
    pos = nx.spring_layout(GA, k=dis, iterations=50)

    labels = {}    
    for m,k in dic.items():
        if k >= 1:
            #set the node name as the key and the label as its value 
            labels[m] = m
    #set the argument 'with labels' to False so you have unlabeled graph

    edges = GA.edges() 
    weights = [GA[u][v]['weight'] for u,v in edges]

    nx.draw(
        GA,
        pos, 
        with_labels=False, 
        alpha=0.5,
        node_color=node_colors, 
        nodelist=nodelst, 
        node_size=sizes,
        font_family='SimHei',
    )

    #Now only add labels to the nodes you require (the hubs in my case)
    nx.draw_networkx_labels(
        GA,
        pos,
        labels,
        font_family='SimHei',
        font_size=60,
        font_color='black'
    )

    nx.draw_networkx_edges(
        GA, 
        pos, 
        width=weights, 
        edge_color='c',
        alpha=0.5, 
        arrowsize=250,
        arrows=True,
    )
    title = f'{part} {col_from}与{col_to}在{year}的网络图'
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=50)

# 月份与事项的关系图
def month2event(n):
    assert n in range(2019, 2022)
    n = str(n)
    temp = df[df['year'] == n].copy() 
    month_event = temp.groupby(['month', 'event'])['duration'].count().reset_index()
    net(month_event, 'month', 'event', year=n, weight='duration', directed=False, dis=3)

# 前后事项的网络图
def PostEvent(n):
    assert n in range(2019, 2022)
    n = str(n)
    temp = df[df['year'] == n].copy() 
    pro_post_ass = temp[['date', 'event']]
    pro_post_ass['previous_event'] = temp.groupby(['date'])['event'].shift()
    pro_post_ass['post_event'] = temp.groupby(['date'])['event'].shift(-1)
    pro_post_ass = pro_post_ass.dropna()    
    net(pro_post_ass, 'event', 'post_event', year=n, directed=True, dis=5)
```


```python
month2event(2019)
```

    Name: 
    Type: Graph
    Number of nodes: 191
    Number of edges: 382
    Average degree:   4.0000
    closeness_centrality: {03:0.4572523175320546,04:0.2692777794256113,07:0.1394011177962664,12:0.13277097048546493,11:0.12883784994447534,10:0.10803750916166831,05:0.09977897603185464,06:0.09923630697863964,08:0.06414521384918247,午休:0.04648614079325427,晚饭:0.04648614079325427,磨蹭:0.04648614079325427,午饭:0.03919373630488256,单词:0.03919373630488256,玩游戏:0.03919373630488256,02:0.03598766194153918,课:0.025507645065616487,托福写作:0.024362091998945182,托福听力:0.024362091998945182,python:0.02126713360431389,偏微分:0.020026401040076688,写日记:0.01980998609452924,改代码:0.01975553467497096,托福口语:0.01906265828995403,AQF:0.017690435733647817,量化:0.016576121288826455,快递:0.01281538101362764,托福阅读:0.011840349889026103,答疑:0.011201296343490938,写报告:0.010217375792229116,有限元:0.009321979391153366,R:0.008164247301759752,蹲坑:0.008089495525327032,银行会计:0.008089495525327032,K歌:0.007356176079295712,考试:0.005472248924211232,理发:0.005453541273174771,口语视频:0.005191397387444578,数值分析:0.003720717365208246,练字:0.00330731229167906,抢课:0.0032035590377984704,GMAT:0.0026681048478284903,万矿量化:0.0026681048478284903,中央银行学:0.0026681048478284903,写作视频:0.0026681048478284903,听力视频:0.0026681048478284903,晚饭归来:0.0026681048478284903,背单词:0.0026681048478284903,拿计算器:0.0026092820836242647,面试:0.0022317815556604638,gis:0.0022047880021490176,GRE阅读:0.0021339783876838307,睡觉:0.0018717880947989058,GRE:0.0018627976687680566,实习工作:0.0018439615705372328,搜索术:0.0015811135439913733,打印:0.0014855108260084717,简历:0.0014824578380383297,matlab:0.0013955278211271666,讲座:0.0013018506957270513,C++:0.0012423285255868252,leetcode:0.0012423285255868252,华尔街日报:0.0012423285255868252,博弈论:0.0011986661442993415,GRE填空:0.0009813980670580493,搬家:0.0007181770126040304,随机过程:0.0004354817415765359,项目管理:0.0004354817415765359,圣经:0.0004141676460435833,kaggle:0.0003926791379667068,衍生工具:0.0003926791379667068,留学咨询:0.0003452549879701593,GRE写作:0.0002766374796881582,GRE数学:0.0002766374796881582,量化课程:0.0002766374796881582,量化项目:0.0002766374796881582,金融法:0.00023040102437321737,复习偏微分:0.0,托福写作与听力:0.0,雷欧奥特曼:0.0,GMAT学习:0.0,GMAT直播:0.0,GMAT视频:0.0,GMAT试题:0.0,GMAT长难句:0.0,PPT:0.0,gmat:0.0,python尝试:0.0,中央银行:0.0,交材料:0.0,公开课:0.0,写作:0.0,写作和听力:0.0,写作课:0.0,午饭走路:0.0,单词与精听:0.0,口语:0.0,听力:0.0,听力写作:0.0,复习:0.0,大决战:0.0,成绩:0.0,手机:0.0,打字:0.0,托福公开课:0.0,托福听力与口语:0.0,托福听力真题:0.0,托福真题:0.0,托福精听:0.0,托福课:0.0,排练:0.0,排练ppt:0.0,排练pr:0.0,改作文:0.0,林俊杰:0.0,柯南:0.0,炼句:0.0,独立写作:0.0,看论文:0.0,编程作业:0.0,逐鹿九州:0.0,重师游玩:0.0,长难句:0.0,PDE:0.0,剪辑视频:0.0,听讲座:0.0,填信息:0.0,外出:0.0,实习资料:0.0,审核视频:0.0,尝试耳机:0.0,开幕式:0.0,托福模考:0.0,找地:0.0,找实习:0.0,拍视频:0.0,摄影:0.0,洗头:0.0,等候:0.0,经验交流会:0.0,编程:0.0,罗布剧场版:0.0,课与单词:0.0,风险管理:0.0,GRE长难句:0.0,买药:0.0,作图:0.0,做图:0.0,整理资料:0.0,查文献:0.0,读论文:0.0,咨询:0.0,商业伦理:0.0,开会:0.0,托福:0.0,装软件:0.0,论文:0.0,午饭.:0.0,开户:0.0,打印成绩单:0.0,托福报名:0.0,拿成绩单:0.0,期权定价:0.0,订酒店:0.0,量化作业:0.0,可视化:0.0,填表:0.0,建模:0.0,hackerrank:0.0,体侧:0.0,改CV:0.0,散步:0.0,聚餐:0.0,转账:0.0,vn.py:0.0,youtube:0.0,借书:0.0,希腊神话:0.0,推荐信:0.0,数据分析:0.0,文书修改:0.0,视频内容:0.0,随机微积分:0.0,复变:0.0,文书:0.0,毕业论文:0.0,算法课程:0.0,考试报名:0.0,西洋画:0.0,计量:0.0,选课指导:0.0,}
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_104_1.png)
    



```python
month2event(2020)
```

    Name: 
    Type: Graph
    Number of nodes: 92
    Number of edges: 296
    Average degree:   6.4348
    closeness_centrality: {01:0.2029823692109427,05:0.15495926498066973,06:0.15399296612814442,11:0.14453107382605673,08:0.12512875429519477,10:0.11779572420521407,07:0.10613535679996633,09:0.08100070691810421,02:0.07924873197891706,12:0.0727719148690161,03:0.05127174390592551,写日记:0.039619974551610544,午休:0.039619974551610544,午饭:0.039619974551610544,华尔街日报:0.039619974551610544,晚饭:0.039619974551610544,玩游戏:0.039619974551610544,磨蹭:0.039619974551610544,算法课程:0.039619974551610544,python:0.03399501175854304,单词:0.03126391360688127,04:0.029595312295767895,人文书籍:0.026456827045210882,量化:0.024778153344420014,人文课:0.017290518015537177,随机微积分:0.014712368157577487,答疑:0.014376262105025567,人工智能:0.014195720900242813,快递:0.011022440659818344,修图:0.007982155947349457,实变:0.007465874636167103,毕业论文:0.007465874636167103,运动:0.006317643413172771,散步:0.00556580994750997,写报告:0.005098831407517786,做家务:0.00430100791989382,泛函:0.003182536572888448,写推文:0.0020231750885077384,C++:0.0016561440193894428,开会:0.0014216936216715616,摄影:0.0009631726138505637,理发:0.0007376887399498576,可视化:0.0007125234637785702,讲座:0.0006592454543243918,简历:0.0005261570227648415,金数:0.0004768136204190192,金融人脉:0.0004768136204190192,准备材料:0.00047346697483546324,linux:0.0003538497665929014,接单工作:0.0003538497665929014,安装软件:0.0002844833049589899,面试:0.00026885964301785693,测度论:3.9680650483280006e-05,买东西:0.0,复变:0.0,干洗:0.0,算分:0.0,西洋画:0.0,走亲:0.0,陪诊:0.0,随机过程:0.0,回家:0.0,抢课:0.0,做图:0.0,交材料:0.0,听讲座:0.0,导员谈话:0.0,开证明:0.0,改代码:0.0,人文教程:0.0,填表:0.0,导师谈话:0.0,打印:0.0,论文:0.0,整理笔记:0.0,看工作:0.0,写计划:0.0,数据库:0.0,更新设备:0.0,洗衣服:0.0,修复电脑:0.0,找工作:0.0,制作视频:0.0,制订计划:0.0,游玩:0.0,演唱会:0.0,修U盘:0.0,搜集资源:0.0,监工:0.0,缴费:0.0,数据竞赛:0.0,爬虫:0.0,}
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_105_1.png)
    



```python
month2event(2021)
```

    Name: 
    Type: Graph
    Number of nodes: 68
    Number of edges: 261
    Average degree:   7.6765
    closeness_centrality: {11:0.1816540675332552,02:0.18040893281131606,10:0.16592556781722115,03:0.10504888626796965,07:0.09687061418463837,01:0.08603545328246136,06:0.08397692659436322,08:0.07377459850838426,12:0.06576398184713529,05:0.05471373646424981,09:0.033937891705670895,人文书籍:0.03138090273110895,人文课:0.03138090273110895,写日记:0.03138090273110895,午休:0.03138090273110895,午饭:0.03138090273110895,华尔街日报:0.03138090273110895,接单工作:0.03138090273110895,晚饭:0.03138090273110895,玩游戏:0.03138090273110895,磨蹭:0.03138090273110895,运动:0.03138090273110895,量化:0.03138090273110895,爬虫:0.022602634611299147,04:0.02204764239536538,做家务:0.021334093680330027,摄影:0.021334093680330027,数据分析:0.01399519641078937,散步:0.00938564268781081,gis:0.0029451838113563333,快递:0.0021590062725934775,深度学习:0.0021448596425087054,算法课程:0.0019485839751549072,写报告:0.0017511220137640376,答疑:0.0015645502266457378,机器学习:0.001196266994079652,写推文:0.0006918798931057058,linux:0.000674872753401214,安装软件:0.0006301919575829361,制定计划:0.00044854429427075885,托福写作:0.0004228154134067608,托福口语:0.0004228154134067608,托福听力:0.0004228154134067608,托福阅读:0.0004228154134067608,线上研讨:0.0004228154134067608,改代码:0.0,检查设备:0.0,修图:0.0,整理笔记:0.0,正则:0.0,走亲:0.0,逛街:0.0,写计划:0.0,清理内存:0.0,换锁:0.0,下载软件:0.0,化妆:0.0,拍视频:0.0,接种疫苗:0.0,找资源:0.0,配置环境:0.0,买东西:0.0,大数据:0.0,监工:0.0,做视频:0.0,报名考试:0.0,演唱会:0.0,外出游玩:0.0,}
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_106_1.png)
    



```python
PostEvent(2019)
```

    Name: 
    Type: DiGraph
    Number of nodes: 172
    Number of edges: 1122
    Average in degree:   6.5233
    Average out degree:   6.5233
    closeness_centrality: {磨蹭:0.2689928545282383,晚饭:0.15082003635428495,午饭:0.130910124141229,玩游戏:0.12184725836014403,午休:0.08737071349783798,偏微分:0.06164382960553884,托福听力:0.05051191444021736,单词:0.04756417246778019,托福口语:0.042428777894809894,托福写作:0.041728131830994754,写日记:0.035104497186089434,K歌:0.03250773993808049,课:0.023979542184815957,练字:0.02341739809425364,AQF:0.023332059728657244,有限元:0.02108823017594834,华尔街日报:0.020905049231176566,银行会计:0.020548254696734342,答疑:0.01932385022494907,蹲坑:0.018253193576662937,GRE填空:0.01626022369540655,R:0.014259726568760001,GMAT长难句:0.013540354314929438,听力视频:0.012374194984748682,林俊杰:0.011296215852155874,PPT:0.011248710010319917,托福阅读:0.011142591401048313,午饭走路:0.011042311661506708,重师游玩:0.010835913312693497,数值分析:0.01047497020896129,python:0.009826393104955446,炼句:0.008255933952528379,写作和听力:0.008255933952528379,改代码:0.008152500545125802,中央银行学:0.00808071500583512,GRE阅读:0.007855948686380586,金融法:0.0077608088157148595,希腊神话:0.007743503707736928,博弈论:0.0069639316204959684,实习工作:0.0062570543234517,大决战:0.00614816314248276,西洋画:0.006019752074599924,背单词:0.005741676124027088,项目管理:0.005713033926064328,GMAT试题:0.005710354317165462,matlab:0.0056897144822841425,hackerrank:0.005686619308910331,独立写作:0.00565015479876161,编程:0.0056415548675610595,外出:0.0056415548675610595,找地:0.0056415548675610595,看论文:0.0056415548675610595,雷欧奥特曼:0.0056415548675610595,托福公开课:0.0054437564499484,排练:0.005435156518747851,摄影:0.00543515651874785,gmat:0.0054351565187478485,复习偏微分:0.0054351565187478485,等候:0.005435156518747848,托福模考:0.005435156518747848,晚饭归来:0.003730567911057835,量化:0.0034764421087624077,GMAT:0.0034396491771589437,C++:0.0029915826770370965,成绩:0.0028207774337805297,写作:0.002786377708978328,快递:0.0026759332510206866,GRE:0.002251642157100918,GRE写作:0.0020666458553682287,量化课程:0.0019503824881759704,写报告:0.001684763863744852,kaggle:0.0011915136214420998,编程作业:0.0011652730721866985,简历:0.0011203083477737538,leetcode:0.0010638941716083097,算法课程:0.0009199066361637303,面试:0.000899315034478795,万矿量化:0.0008500050734412576,随机过程:0.0008246222320504611,考试:0.0006846776324102859,写作视频:0.0006775234664811549,量化作业:0.000580879915285178,中央银行:0.00053704179091176,圣经:0.0005248595538208204,拿计算器:0.00044357608796387403,gis:0.0003860056759056176,搜索术:0.00036377195682360606,理发:0.00035342858015386015,拍视频:0.0003346845219910235,打印:0.0003114794950201255,量化项目:0.0003112554220361724,GRE数学:0.0002929457460396445,睡觉:0.0002807697596139289,散步:0.00016315742777225207,借书:0.0001570935472905246,风险管理:0.00014076585800012011,衍生工具:0.000140231829417321,体侧:0.00011110416167175713,口语视频:9.562510238257154e-05,口语:6.879944960440316e-05,可视化:5.494400489240531e-05,vn.py:4.652153258964405e-05,计量:4.046062869592281e-05,听力:3.945407033234961e-05,留学咨询:3.9273019149180134e-05,选课指导:3.270605164613542e-05,GMAT视频:3.268205973110649e-05,听讲座:3.0140711255262335e-05,作图:2.0379863951641692e-05,GRE长难句:1.4818342991717604e-05,期权定价:1.1856191888816141e-05,剪辑视频:9.828492800629022e-06,数据分析:9.555479111722663e-06,聚餐:4.873294346978557e-06,整理资料:4.510186140733097e-06,GMAT直播:0.0,打印成绩单:0.0,托福报名:0.0,PDE:0.0,经验交流会:0.0,python尝试:0.0,交材料:0.0,做图:0.0,写作课:0.0,抢课:0.0,排练ppt:0.0,考试报名:0.0,复习:0.0,尝试耳机:0.0,推荐信:0.0,洗头:0.0,午饭.:0.0,讲座:0.0,咨询:0.0,商业伦理:0.0,填信息:0.0,填表:0.0,GMAT学习:0.0,实习资料:0.0,审核视频:0.0,视频内容:0.0,建模:0.0,开会:0.0,开户:0.0,打字:0.0,托福:0.0,排练pr:0.0,搬家:0.0,柯南:0.0,逐鹿九州:0.0,托福听力真题:0.0,托福课:0.0,订酒店:0.0,托福真题:0.0,托福精听:0.0,找实习:0.0,拿成绩单:0.0,改CV:0.0,改作文:0.0,随机微积分:0.0,文书:0.0,文书修改:0.0,转账:0.0,查文献:0.0,毕业论文:0.0,公开课:0.0,罗布剧场版:0.0,装软件:0.0,论文:0.0,读论文:0.0,课与单词:0.0,长难句:0.0,}
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_107_1.png)
    



```python
PostEvent(2020)
```

    Name: 
    Type: DiGraph
    Number of nodes: 79
    Number of edges: 585
    Average in degree:   7.4051
    Average out degree:   7.4051
    closeness_centrality: {磨蹭:0.19847676892816918,华尔街日报:0.16954090026832686,玩游戏:0.12686995777595692,晚饭:0.084557167067304,午饭:0.08248795571101021,午休:0.07666060438462056,写日记:0.06805367008193336,运动:0.06633375315654648,人文书籍:0.06279252585038551,毕业论文:0.05026527476866241,算法课程:0.04059942805895062,单词:0.03758041634922656,人文课:0.03466882917535755,接单工作:0.02696962952566258,量化:0.023993260576316986,python:0.022974608640712726,随机微积分:0.020893085709818595,人工智能:0.01909307557305843,安装软件:0.014495289720304647,实变:0.01433451507668957,C++:0.013031828617953019,面试:0.01232101232101232,修图:0.005147687817163926,泛函:0.004719697109202765,做家务:0.0036577283148220697,写报告:0.00214573418746181,金数:0.0020229496434742804,快递:0.001739220732326772,答疑:0.0014366167480158753,写推文:0.0013996729818601442,金融人脉:0.0013614091536169456,填表:0.0011513517008022503,数据库:0.001093307712663589,复变:0.0005893151054441377,散步:0.0005584820145259705,找工作:0.0004245754245754245,测度论:0.0002603178023346091,走亲:0.00016352694924123498,摄影:6.724045185583647e-05,开会:6.66000666000666e-05,西洋画:6.66000666000666e-05,做图:5.55000555000555e-05,linux:5.5032686611633974e-05,打印:4.995004995004995e-05,讲座:4.757147614290471e-05,论文:3.9176509764745056e-05,看工作:3.468753468753469e-05,随机过程:2.3785738071452354e-05,买东西:0.0,交材料:0.0,准备材料:0.0,人文教程:0.0,修U盘:0.0,演唱会:0.0,写计划:0.0,制作视频:0.0,制订计划:0.0,游玩:0.0,算分:0.0,开证明:0.0,简历:0.0,陪诊:0.0,可视化:0.0,听讲座:0.0,回家:0.0,更新设备:0.0,导员谈话:0.0,导师谈话:0.0,干洗:0.0,监工:0.0,搜集资源:0.0,改代码:0.0,数据竞赛:0.0,整理笔记:0.0,理发:0.0,洗衣服:0.0,爬虫:0.0,修复电脑:0.0,缴费:0.0,}
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_108_1.png)
    



```python
PostEvent(2021)
```

    Name: 
    Type: DiGraph
    Number of nodes: 56
    Number of edges: 423
    Average in degree:   7.5536
    Average out degree:   7.5536
    closeness_centrality: {玩游戏:0.18249125558531543,磨蹭:0.1661710459193416,接单工作:0.14802918578585458,午饭:0.126913468958689,量化:0.11630089596948588,午休:0.06400425125704232,摄影:0.06316299627445138,晚饭:0.06098139046187643,运动:0.05199228253188912,人文课:0.047404551397264905,华尔街日报:0.04202643268116109,托福写作:0.039858432812978274,人文书籍:0.030351762997727284,写日记:0.0295568577513022,爬虫:0.0286987321730262,深度学习:0.018723169834280948,走亲:0.018181818181818184,修图:0.017508417508417515,做家务:0.011000346457784619,机器学习:0.01065731816681718,gis:0.007130221674190773,散步:0.006343026128379664,写报告:0.0055097445195406245,数据分析:0.005128604449053523,托福听力:0.002769878732132852,算法课程:0.0018726323778783364,快递:0.0012252141797596346,托福口语:0.001078703032451039,安装软件:0.0006129672796339464,答疑:0.000523926129986736,接种疫苗:0.0002805836139169472,正则:0.00010791677458344124,linux:8.417508417508418e-05,配置环境:5.180005180005181e-05,下载软件:0.0,买东西:0.0,写推文:0.0,大数据:0.0,拍视频:0.0,做视频:0.0,写计划:0.0,制定计划:0.0,化妆:0.0,外出游玩:0.0,改代码:0.0,逛街:0.0,托福阅读:0.0,找资源:0.0,报名考试:0.0,换锁:0.0,演唱会:0.0,整理笔记:0.0,检查设备:0.0,线上研讨:0.0,清理内存:0.0,监工:0.0,}
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_109_1.png)
    


## 2.5 一键式EDA

### 2.5.1 原始数据


```python
AV = AutoViz_Class()
dft = AV.AutoViz(
    filename=None,  
    sep=",",  
    depVar="duration",  
    dfte=df,  
    header=0,
    verbose=0,  
    lowess=True,  
    chart_format="svg",  
    max_rows_analyzed=150000,  
    max_cols_analyzed=30,
)
```

    Shape of your Data Set loaded: (14511, 21)
    ############## C L A S S I F Y I N G  V A R I A B L E S  ####################
    Classifying variables in data set...
    week_order of type=period[W-SUN] is not classified
        Number of Numeric Columns =  1
        Number of Integer-Categorical Columns =  2
        Number of String-Categorical Columns =  9
        Number of Factor-Categorical Columns =  0
        Number of String-Boolean Columns =  0
        Number of Numeric-Boolean Columns =  0
        Number of Discrete String Columns =  7
        Number of NLP String Columns =  0
        Number of Date Time Columns =  0
        Number of ID Columns =  0
        Number of Columns to Delete =  0
    No of columns classified 19 does not match 20 total cols. Continuing...
     Missing columns = ['week_order']
            7 variables removed since they were ID or low-information variables
    
    ################ Regression VISUALIZATION Started #####################
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_112_7.png)
    


    All Plots done
    Time to run AutoViz (in seconds) = 16.150
    
     ###################### VISUALIZATION Completed ########################
    

### 2.5.2 衍生数据


```python
AV = AutoViz_Class()
dft = AV.AutoViz(
    filename=None,  
    sep=",",  
    depVar="effective time",  
    dfte=daily_attr_copy,  
    header=0,
    verbose=0,  
    lowess=True,  
    chart_format="svg",  
    max_rows_analyzed=150000,  
    max_cols_analyzed=30,
)
```

    Shape of your Data Set loaded: (292, 9)
    ############## C L A S S I F Y I N G  V A R I A B L E S  ####################
    Classifying variables in data set...
    week_order of type=period[W-SUN] is not classified
        Number of Numeric Columns =  3
        Number of Integer-Categorical Columns =  1
        Number of String-Categorical Columns =  1
        Number of Factor-Categorical Columns =  0
        Number of String-Boolean Columns =  0
        Number of Numeric-Boolean Columns =  0
        Number of Discrete String Columns =  1
        Number of NLP String Columns =  0
        Number of Date Time Columns =  0
        Number of ID Columns =  1
        Number of Columns to Delete =  0
    No of columns classified 7 does not match 8 total cols. Continuing...
     Missing columns = ['week_order']
            2 variables removed since they were ID or low-information variables
    
    ################ Regression VISUALIZATION Started #####################
    Using Lowess Smoothing. This might take a few minutes for large data sets...
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_1.png)
    


    Using Lowess Smoothing. This might take a few minutes for large data sets...
    Number of All Scatter Plots = 6
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_114_9.png)
    


    All Plots done
    Time to run AutoViz (in seconds) = 3.453
    
     ###################### VISUALIZATION Completed ########################
    

# 3.数据分析

## 3.1 方差分析每月或是每年的事项是否有差异

### 3.1.1 原始事项时长数据的方差分析


```python
# 原始事项数据的方差分析
part = '3.1.1'

def vr_event(data, num, cate):
    formula = f'{num}~C({cate})'
    anova_re_2019 = anova_lm(ols(formula, data=data[[num, cate]]).fit())
    res = anova_re_2019.loc[f'C({cate})', 'PR(>F)']
    return res
```


```python
# 事项时长数据
vr_duration_table = pd.DataFrame()
for event in tqdm(df['event'].unique()):
    for cate in cate_vars:
        if cate not in ['event', 'attr']:
            temp = df[df['event'] == event].copy()
            temp[cate] = temp[cate].astype(str)
            res = vr_event(temp, 'duration', cate)
            vr_duration_table.loc[event, cate] = res

# 该表格是各个事项的时长数据关于各分类变量的方差分析结果
vr_duration_table
```

    100%|██████████| 243/243 [00:14<00:00, 16.66it/s]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>weekday</th>
      <th>mid_hour</th>
      <th>day_period</th>
      <th>week_order</th>
      <th>duration_attr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>托福写作与听力</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>python</th>
      <td>0.008460</td>
      <td>2.287125e-02</td>
      <td>0.739882</td>
      <td>8.399767e-01</td>
      <td>5.757493e-11</td>
      <td>1.195543e-08</td>
      <td>1.238277e-01</td>
      <td>9.591669e-44</td>
    </tr>
    <tr>
      <th>快递</th>
      <td>0.010206</td>
      <td>3.445722e-01</td>
      <td>0.730032</td>
      <td>1.954784e-01</td>
      <td>3.759866e-01</td>
      <td>1.737118e-01</td>
      <td>4.138766e-01</td>
      <td>2.937760e-09</td>
    </tr>
    <tr>
      <th>搜索术</th>
      <td>NaN</td>
      <td>1.000000e+00</td>
      <td>NaN</td>
      <td>5.792850e-15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000e+00</td>
      <td>1.113672e-01</td>
    </tr>
    <tr>
      <th>午休</th>
      <td>0.000013</td>
      <td>4.856760e-08</td>
      <td>0.864952</td>
      <td>2.972783e-01</td>
      <td>2.546873e-05</td>
      <td>1.956907e-01</td>
      <td>6.523863e-15</td>
      <td>9.438105e-45</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>大数据</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.038696</td>
      <td>6.211273e-01</td>
      <td>5.265412e-01</td>
      <td>6.896051e-01</td>
      <td>5.445203e-01</td>
      <td>4.238756e-04</td>
    </tr>
    <tr>
      <th>线上研讨</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>做视频</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>报名考试</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>外出游玩</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>243 rows × 8 columns</p>
</div>




```python
# 选取那些在不同分类情况下时长有显著差异的数据
vr_duration_table.to_excel('事项时长数据的方差分析结果.xlsx', index=True)
significant_event = vr_duration_table[vr_duration_table > .05].dropna(axis=0, how='all')
significant_event
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>weekday</th>
      <th>mid_hour</th>
      <th>day_period</th>
      <th>week_order</th>
      <th>duration_attr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>python</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.739882</td>
      <td>0.839977</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.123828</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>快递</th>
      <td>NaN</td>
      <td>0.344572</td>
      <td>0.730032</td>
      <td>0.195478</td>
      <td>0.375987</td>
      <td>0.173712</td>
      <td>0.413877</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>搜索术</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>0.111367</td>
    </tr>
    <tr>
      <th>午休</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.864952</td>
      <td>0.297278</td>
      <td>NaN</td>
      <td>0.195691</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>托福听力</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.786872</td>
      <td>0.706346</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>机器学习</th>
      <td>NaN</td>
      <td>0.434528</td>
      <td>0.665255</td>
      <td>0.402006</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.141308</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>制定计划</th>
      <td>NaN</td>
      <td>0.544331</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.592593</td>
      <td>0.592593</td>
      <td>NaN</td>
      <td>0.074074</td>
    </tr>
    <tr>
      <th>配置环境</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>深度学习</th>
      <td>NaN</td>
      <td>0.378635</td>
      <td>0.731785</td>
      <td>0.193446</td>
      <td>NaN</td>
      <td>0.524222</td>
      <td>0.113776</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>大数据</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.621127</td>
      <td>0.526541</td>
      <td>0.689605</td>
      <td>0.544520</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>114 rows × 8 columns</p>
</div>




```python
# 对于有显著差异的事项 做出在不同分类中均值的bar图
mins = 30  # 剔除掉出现次数少的事项
for e in tqdm(significant_event.index):
    if len(df[df['event'] == e]) >= mins:
        for c in significant_event.columns:
            if significant_event.loc[e, c] >= .05:
                plt.figure(dpi=100)
                df[df['event'] == e].groupby(c)['duration'].agg('mean').plot(
                    kind='bar', figsize=(20, 10)
                )
                title = f'{part} mean value of {e} duration in different {c} groups'
                plt.title(title, fontsize=20)
                plt.xlabel(e, fontsize=20)
                plt.ylabel('Mean value', fontsize=20)
                plt.xticks(fontsize=20)
                plt.yticks(fontsize=20)
                file = os.path.join(path, f'{title}.png')
                plt.savefig(file, dpi=600) 
```

    100%|██████████| 114/114 [07:23<00:00,  3.89s/it]
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_18.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_19.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_20.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_21.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_22.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_23.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_24.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_25.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_26.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_27.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_28.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_29.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_30.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_31.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_32.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_33.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_34.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_35.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_36.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_37.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_38.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_39.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_40.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_41.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_42.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_43.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_44.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_45.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_46.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_47.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_48.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_49.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_50.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_51.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_52.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_53.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_54.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_55.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_56.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_57.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_58.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_59.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_60.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_61.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_62.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_63.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_64.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_65.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_66.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_67.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_68.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_69.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_70.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_71.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_72.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_73.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_74.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_75.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_76.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_77.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_78.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_79.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_80.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_81.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_82.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_83.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_84.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_85.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_86.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_87.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_88.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_89.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_90.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_91.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_92.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_93.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_94.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_95.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_96.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_97.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_98.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_99.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_100.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_101.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_102.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_103.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_104.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_105.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_106.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_107.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_108.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_109.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_110.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_111.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_112.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_113.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_114.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_115.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_116.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_117.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_118.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_119.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_120.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_121.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_122.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_123.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_124.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_125.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_126.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_127.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_128.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_129.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_130.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_131.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_132.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_133.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_134.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_135.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_136.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_137.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_138.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_139.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_140.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_141.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_142.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_143.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_144.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_145.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_146.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_147.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_148.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_149.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_150.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_151.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_152.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_153.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_154.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_155.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_156.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_157.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_158.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_159.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_160.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_161.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_162.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_163.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_164.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_165.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_166.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_167.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_168.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_169.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_170.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_171.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_172.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_173.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_174.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_175.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_176.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_177.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_178.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_179.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_180.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_181.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_182.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_183.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_184.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_185.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_186.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_121_187.png)
    



```python
# 只分析2021年
vr_duration_table2021 = pd.DataFrame()
for event in tqdm(df['event'].unique()):
    for cate in cate_vars:
        if cate not in ['event', 'attr', 'year']:
            try:
                temp = df[
                    (df['event'] == event) & (df['year'] == '2021')
                ].copy()
                temp[cate] = temp[cate].astype(str)
                res = vr_event(temp, 'duration', cate)
                vr_duration_table2021.loc[event, cate] = res
            except:
                continue

# 该表格是各个事项的时长数据关于各分类变量的方差分析结果
vr_duration_table2021
```

    100%|██████████| 243/243 [00:07<00:00, 32.98it/s]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>day</th>
      <th>weekday</th>
      <th>mid_hour</th>
      <th>day_period</th>
      <th>week_order</th>
      <th>duration_attr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>快递</th>
      <td>7.926446e-01</td>
      <td>0.043095</td>
      <td>0.039968</td>
      <td>9.421247e-01</td>
      <td>6.530451e-01</td>
      <td>8.359495e-01</td>
      <td>6.599521e-05</td>
    </tr>
    <tr>
      <th>午休</th>
      <td>7.725330e-05</td>
      <td>0.979915</td>
      <td>0.525451</td>
      <td>1.977387e-02</td>
      <td>1.133697e-02</td>
      <td>1.920352e-02</td>
      <td>2.649979e-21</td>
    </tr>
    <tr>
      <th>托福听力</th>
      <td>9.362410e-01</td>
      <td>0.485662</td>
      <td>0.598792</td>
      <td>2.075327e-01</td>
      <td>5.233486e-01</td>
      <td>9.796707e-01</td>
      <td>5.671253e-05</td>
    </tr>
    <tr>
      <th>磨蹭</th>
      <td>4.063176e-02</td>
      <td>0.970911</td>
      <td>0.854755</td>
      <td>2.621718e-47</td>
      <td>5.064039e-43</td>
      <td>7.553800e-01</td>
      <td>2.046428e-274</td>
    </tr>
    <tr>
      <th>晚饭</th>
      <td>6.731768e-02</td>
      <td>0.753323</td>
      <td>0.342607</td>
      <td>1.197458e-02</td>
      <td>8.626609e-02</td>
      <td>3.066117e-02</td>
      <td>4.110896e-58</td>
    </tr>
    <tr>
      <th>托福写作</th>
      <td>1.270000e-01</td>
      <td>0.075552</td>
      <td>0.093025</td>
      <td>5.576692e-02</td>
      <td>5.771516e-01</td>
      <td>6.046176e-01</td>
      <td>6.065773e-05</td>
    </tr>
    <tr>
      <th>午饭</th>
      <td>3.009939e-02</td>
      <td>0.846894</td>
      <td>0.158690</td>
      <td>6.287452e-01</td>
      <td>6.287452e-01</td>
      <td>9.198414e-02</td>
      <td>7.819864e-43</td>
    </tr>
    <tr>
      <th>托福口语</th>
      <td>9.315423e-02</td>
      <td>0.869367</td>
      <td>0.530828</td>
      <td>2.233843e-02</td>
      <td>8.544254e-01</td>
      <td>3.651650e-02</td>
      <td>2.357912e-07</td>
    </tr>
    <tr>
      <th>玩游戏</th>
      <td>7.507849e-07</td>
      <td>0.466641</td>
      <td>0.592380</td>
      <td>1.094706e-11</td>
      <td>3.061504e-04</td>
      <td>5.110503e-06</td>
      <td>8.130205e-81</td>
    </tr>
    <tr>
      <th>改代码</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>托福阅读</th>
      <td>9.518172e-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.863034e-01</td>
      <td>NaN</td>
      <td>3.342717e-02</td>
      <td>5.421885e-02</td>
    </tr>
    <tr>
      <th>量化</th>
      <td>5.088518e-07</td>
      <td>0.560456</td>
      <td>0.773548</td>
      <td>8.901629e-45</td>
      <td>1.570896e-17</td>
      <td>2.186819e-04</td>
      <td>1.244397e-114</td>
    </tr>
    <tr>
      <th>gis</th>
      <td>1.154778e-01</td>
      <td>0.628618</td>
      <td>0.611986</td>
      <td>2.751180e-06</td>
      <td>1.159390e-03</td>
      <td>5.492023e-01</td>
      <td>4.295845e-11</td>
    </tr>
    <tr>
      <th>写报告</th>
      <td>6.480088e-01</td>
      <td>0.964611</td>
      <td>0.556786</td>
      <td>6.949625e-03</td>
      <td>2.502906e-02</td>
      <td>5.876396e-01</td>
      <td>2.256104e-09</td>
    </tr>
    <tr>
      <th>写日记</th>
      <td>2.451365e-49</td>
      <td>0.999992</td>
      <td>0.944358</td>
      <td>1.389361e-07</td>
      <td>5.258538e-03</td>
      <td>5.339987e-37</td>
      <td>2.851894e-10</td>
    </tr>
    <tr>
      <th>拍视频</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>答疑</th>
      <td>2.793277e-01</td>
      <td>NaN</td>
      <td>0.220503</td>
      <td>NaN</td>
      <td>1.399653e-01</td>
      <td>4.976682e-01</td>
      <td>1.515890e-02</td>
    </tr>
    <tr>
      <th>摄影</th>
      <td>3.079386e-03</td>
      <td>0.859708</td>
      <td>0.168377</td>
      <td>5.491870e-06</td>
      <td>7.272031e-04</td>
      <td>1.177880e-01</td>
      <td>9.209185e-34</td>
    </tr>
    <tr>
      <th>散步</th>
      <td>2.534746e-01</td>
      <td>0.283462</td>
      <td>0.253895</td>
      <td>4.432428e-02</td>
      <td>4.432428e-02</td>
      <td>3.433660e-03</td>
      <td>3.573194e-05</td>
    </tr>
    <tr>
      <th>华尔街日报</th>
      <td>1.478247e-16</td>
      <td>0.888128</td>
      <td>0.675506</td>
      <td>3.751310e-197</td>
      <td>4.434402e-142</td>
      <td>7.666762e-09</td>
      <td>2.576908e-193</td>
    </tr>
    <tr>
      <th>数据分析</th>
      <td>6.896219e-03</td>
      <td>0.862360</td>
      <td>0.113386</td>
      <td>1.126484e-02</td>
      <td>3.549157e-02</td>
      <td>1.811878e-02</td>
      <td>3.974370e-14</td>
    </tr>
    <tr>
      <th>算法课程</th>
      <td>8.813985e-02</td>
      <td>0.972934</td>
      <td>0.856683</td>
      <td>4.681672e-14</td>
      <td>5.377906e-01</td>
      <td>4.891463e-01</td>
      <td>2.625435e-28</td>
    </tr>
    <tr>
      <th>走亲</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>买东西</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>人文书籍</th>
      <td>7.702579e-12</td>
      <td>0.774076</td>
      <td>0.568494</td>
      <td>6.826124e-14</td>
      <td>5.987598e-04</td>
      <td>1.671589e-11</td>
      <td>6.077370e-57</td>
    </tr>
    <tr>
      <th>人文课</th>
      <td>2.241461e-12</td>
      <td>0.530914</td>
      <td>0.414100</td>
      <td>7.758154e-40</td>
      <td>2.866802e-15</td>
      <td>2.494553e-08</td>
      <td>5.195867e-170</td>
    </tr>
    <tr>
      <th>修图</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>整理笔记</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>写推文</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>运动</th>
      <td>9.561012e-09</td>
      <td>0.821133</td>
      <td>0.899159</td>
      <td>2.036463e-06</td>
      <td>7.786457e-08</td>
      <td>2.419798e-04</td>
      <td>1.646115e-63</td>
    </tr>
    <tr>
      <th>安装软件</th>
      <td>2.634993e-01</td>
      <td>NaN</td>
      <td>0.840474</td>
      <td>NaN</td>
      <td>2.325962e-02</td>
      <td>6.754731e-01</td>
      <td>2.634993e-01</td>
    </tr>
    <tr>
      <th>做家务</th>
      <td>1.292822e-01</td>
      <td>0.564260</td>
      <td>0.267426</td>
      <td>5.178016e-02</td>
      <td>1.468062e-02</td>
      <td>1.246769e-01</td>
      <td>1.384203e-19</td>
    </tr>
    <tr>
      <th>写计划</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>演唱会</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>接单工作</th>
      <td>3.164137e-02</td>
      <td>0.897259</td>
      <td>0.316416</td>
      <td>2.412853e-25</td>
      <td>5.401493e-09</td>
      <td>1.800110e-01</td>
      <td>1.899822e-88</td>
    </tr>
    <tr>
      <th>监工</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>linux</th>
      <td>3.357252e-01</td>
      <td>0.857805</td>
      <td>0.939453</td>
      <td>4.291239e-01</td>
      <td>1.264326e-01</td>
      <td>1.892193e-01</td>
      <td>1.102479e-02</td>
    </tr>
    <tr>
      <th>爬虫</th>
      <td>6.731029e-01</td>
      <td>0.321596</td>
      <td>0.756109</td>
      <td>1.608248e-01</td>
      <td>2.027449e-02</td>
      <td>3.451654e-01</td>
      <td>1.048123e-10</td>
    </tr>
    <tr>
      <th>检查设备</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>逛街</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>正则</th>
      <td>NaN</td>
      <td>0.758368</td>
      <td>0.758368</td>
      <td>NaN</td>
      <td>7.583679e-01</td>
      <td>NaN</td>
      <td>9.170127e-02</td>
    </tr>
    <tr>
      <th>机器学习</th>
      <td>4.345283e-01</td>
      <td>0.665255</td>
      <td>0.402006</td>
      <td>1.044380e-05</td>
      <td>3.144944e-02</td>
      <td>1.413082e-01</td>
      <td>1.847961e-17</td>
    </tr>
    <tr>
      <th>清理内存</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>换锁</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>制定计划</th>
      <td>5.443311e-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.925926e-01</td>
      <td>5.925926e-01</td>
      <td>NaN</td>
      <td>7.407407e-02</td>
    </tr>
    <tr>
      <th>下载软件</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>化妆</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>接种疫苗</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>找资源</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>配置环境</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>3.333333e-01</td>
      <td>3.333333e-01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>深度学习</th>
      <td>3.786353e-01</td>
      <td>0.731785</td>
      <td>0.193446</td>
      <td>1.075374e-03</td>
      <td>5.242218e-01</td>
      <td>1.137761e-01</td>
      <td>5.953479e-15</td>
    </tr>
    <tr>
      <th>大数据</th>
      <td>NaN</td>
      <td>0.038696</td>
      <td>0.621127</td>
      <td>5.265412e-01</td>
      <td>6.896051e-01</td>
      <td>5.445203e-01</td>
      <td>4.238756e-04</td>
    </tr>
    <tr>
      <th>线上研讨</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>做视频</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>报名考试</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>外出游玩</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
significant_event2021 = vr_duration_table2021[vr_duration_table2021 > .05].\
    dropna(axis=0, how='all')

mins = 20

for e in tqdm(significant_event2021.index):
    if len(df[df['event'] == e]) >= mins:
        for c in significant_event2021.columns:
            if significant_event2021.loc[e, c] >= .05:
                plt.figure(dpi=100)
                df[
                    (df['event'] == e) & (df['year'] == '2021')
                ].groupby(c)['duration'].agg('mean').plot(
                    kind='bar', figsize=(20, 10)
                )
                title = f'{part} mean value of {e} duration in different {c} groups in year 2021'
                plt.title(title, fontsize=20)
                plt.xlabel(e, fontsize=20)
                plt.ylabel('Mean value', fontsize=20)
                plt.xticks(fontsize=20)
                plt.yticks(fontsize=20)
                file = os.path.join(path, f'{title}.png')
                plt.savefig(file, dpi=600) 
```

    100%|██████████| 34/34 [04:07<00:00,  7.29s/it]
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_10.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_11.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_18.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_19.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_20.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_21.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_22.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_23.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_24.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_25.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_26.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_27.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_28.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_29.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_30.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_31.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_32.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_33.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_34.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_35.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_36.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_37.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_38.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_39.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_40.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_41.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_42.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_43.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_44.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_45.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_46.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_47.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_48.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_49.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_50.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_51.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_52.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_53.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_54.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_55.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_56.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_57.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_58.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_59.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_60.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_61.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_62.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_63.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_64.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_65.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_66.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_67.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_68.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_69.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_70.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_71.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_72.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_73.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_74.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_75.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_76.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_77.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_78.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_79.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_80.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_81.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_82.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_83.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_84.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_85.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_86.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_87.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_88.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_89.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_90.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_91.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_92.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_93.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_94.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_95.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_96.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_97.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_98.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_99.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_100.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_101.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_102.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_103.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_123_104.png)
    


### 3.1.2 衍生数据的方差分析


```python
part = '3.1.2'

daily_attr['weekday'] = pd.to_datetime(daily_attr['date']).dt.weekday + 1
daily_attr['year'] = daily_attr['date'].apply(lambda x:str(x).split('-')[0])
daily_attr['month'] = daily_attr['date'].apply(lambda x:str(x).split('-')[1])
daily_attr['day'] = daily_attr['date'].apply(lambda x:str(x).split('-')[2])
daily_attr['week_order'] = daily_attr['date'].map(lambda x: pd.Period(x, freq='W'))
daily_attr
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>必要时间</th>
      <th>有效时间</th>
      <th>浪费时间</th>
      <th>手机时间</th>
      <th>weekday</th>
      <th>month</th>
      <th>day</th>
      <th>week_order</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-02-27</td>
      <td>160.0</td>
      <td>590.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>02</td>
      <td>27</td>
      <td>2019-02-25/2019-03-03</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-03-04</td>
      <td>650.0</td>
      <td>160.0</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>1</td>
      <td>03</td>
      <td>04</td>
      <td>2019-03-04/2019-03-10</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-03-05</td>
      <td>395.0</td>
      <td>342.0</td>
      <td>108.0</td>
      <td>NaN</td>
      <td>2</td>
      <td>03</td>
      <td>05</td>
      <td>2019-03-04/2019-03-10</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-03-06</td>
      <td>370.0</td>
      <td>340.0</td>
      <td>130.0</td>
      <td>NaN</td>
      <td>3</td>
      <td>03</td>
      <td>06</td>
      <td>2019-03-04/2019-03-10</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-03-07</td>
      <td>495.0</td>
      <td>265.0</td>
      <td>80.0</td>
      <td>NaN</td>
      <td>4</td>
      <td>03</td>
      <td>07</td>
      <td>2019-03-04/2019-03-10</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>860</th>
      <td>2021-12-26</td>
      <td>428.0</td>
      <td>356.0</td>
      <td>87.0</td>
      <td>25.0</td>
      <td>7</td>
      <td>12</td>
      <td>26</td>
      <td>2021-12-20/2021-12-26</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>861</th>
      <td>2021-12-27</td>
      <td>286.0</td>
      <td>456.0</td>
      <td>123.0</td>
      <td>19.0</td>
      <td>1</td>
      <td>12</td>
      <td>27</td>
      <td>2021-12-27/2022-01-02</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>862</th>
      <td>2021-12-28</td>
      <td>201.0</td>
      <td>541.0</td>
      <td>153.0</td>
      <td>34.0</td>
      <td>2</td>
      <td>12</td>
      <td>28</td>
      <td>2021-12-27/2022-01-02</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>863</th>
      <td>2021-12-29</td>
      <td>242.0</td>
      <td>481.0</td>
      <td>143.0</td>
      <td>28.0</td>
      <td>3</td>
      <td>12</td>
      <td>29</td>
      <td>2021-12-27/2022-01-02</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>864</th>
      <td>2021-12-30</td>
      <td>184.0</td>
      <td>545.0</td>
      <td>144.0</td>
      <td>39.0</td>
      <td>4</td>
      <td>12</td>
      <td>30</td>
      <td>2021-12-27/2022-01-02</td>
      <td>2021</td>
    </tr>
  </tbody>
</table>
<p>865 rows × 10 columns</p>
</div>




```python
# 变量类型划分
num_vars = [
    '有效时间', '浪费时间', '必要时间', '手机时间'
]

cates_vars = [
    'year', 'month', 'day', 'weekday', 'week_order'
]

# 逐一进行方差分析
daily_sum_table = pd.DataFrame()
for num in tqdm(num_vars):
    for cate in cates_vars:
        temp = daily_attr[[num, cate]].copy()
        temp[cate] = temp[cate].astype(str)
        res = vr_event(temp, num, cate)
        daily_sum_table.loc[num, cate] = res

# 该表格是各个事项的时长日度求和数据数据关于各分类变量的方差分析结果
daily_sum_table
```

    100%|██████████| 4/4 [00:00<00:00,  7.93it/s]
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>weekday</th>
      <th>week_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>有效时间</th>
      <td>5.884050e-02</td>
      <td>2.376362e-20</td>
      <td>0.933719</td>
      <td>0.027069</td>
      <td>6.170587e-59</td>
    </tr>
    <tr>
      <th>浪费时间</th>
      <td>1.115667e-15</td>
      <td>6.135712e-07</td>
      <td>0.835219</td>
      <td>0.009328</td>
      <td>2.039158e-29</td>
    </tr>
    <tr>
      <th>必要时间</th>
      <td>1.298475e-17</td>
      <td>3.365409e-19</td>
      <td>0.951459</td>
      <td>0.466769</td>
      <td>8.977049e-46</td>
    </tr>
    <tr>
      <th>手机时间</th>
      <td>3.592321e-24</td>
      <td>2.900792e-38</td>
      <td>0.997665</td>
      <td>0.737953</td>
      <td>1.301161e-294</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 对于有显著差异的事项 做出在不同分类中均值的bar图
for e in tqdm(daily_sum_table.index):
    for c in daily_sum_table.columns:
        if daily_sum_table.loc[e, c] >= .05:
            plt.figure(dpi=100)
            daily_attr.groupby(c)[e].agg('mean').plot(
                kind='bar', figsize=(20, 10)
            )
            title = f'{part} mean value of {e} duration in different {c} groups'
            plt.title(title, fontsize=20)
            plt.xlabel(e, fontsize=20)
            plt.ylabel('Mean value', fontsize=20)
            plt.xticks(fontsize=20)
            plt.yticks(fontsize=20)
            file = os.path.join(path, f'{title}.png')
            plt.savefig(file, dpi=600) 
```

    100%|██████████| 4/4 [00:16<00:00,  4.20s/it]
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_127_7.png)
    


## 3.2 LSTM预测前后事项

### 3.2.1 建立字符索引


```python
corpus_chars = df['event'].values
idx_to_char = list(set(corpus_chars)) # 去重，得到索引到字符的映射
char_to_idx = {char: i for i, char in enumerate(idx_to_char)} # 字符到索引的映射
vocab_size = len(char_to_idx)
print(vocab_size)
print('len(corpus_chars) = ', len(corpus_chars))

corpus_indices = [char_to_idx[char] for char in corpus_chars]  # 将每个字符转化为索引，得到一个索引的序列
sample = corpus_indices[: 20]
print('chars:', ' '.join([idx_to_char[idx] for idx in sample]))
print('indices:', sample)
```

    243
    len(corpus_chars) =  14511
    chars: 托福写作与听力 python 快递 搜索术 午休 托福听力 博弈论 博弈论 磨蹭 晚饭 雷欧奥特曼 复习偏微分 托福写作 托福听力 课 磨蹭 PPT 午饭走路 重师游玩 K歌
    indices: [112, 50, 103, 177, 215, 33, 4, 4, 126, 222, 104, 5, 120, 33, 161, 126, 16, 94, 38, 37]
    


```python
def load_data():
    idx_to_char = list(set(corpus_chars))
    char_to_idx = dict([(char, i) for i, char in enumerate(idx_to_char)])
    vocab_size = len(char_to_idx)
    corpus_indices = [char_to_idx[char] for char in corpus_chars]
    return corpus_indices, char_to_idx, idx_to_char, vocab_size
```


```python
# 随机采样
def data_iter_random(corpus_indices, batch_size, num_steps, device=None):
    # 减1是因为对于长度为n的序列，X最多只有包含其中的前n - 1个字符
    num_examples = (len(corpus_indices) - 1) // num_steps  # 下取整，得到不重叠情况下的样本个数
    example_indices = [i * num_steps for i in range(num_examples)]  # 每个样本的第一个字符在corpus_indices中的下标
    random.shuffle(example_indices)

    def _data(i):
        # 返回从i开始的长为num_steps的序列
        return corpus_indices[i: i + num_steps]
    if device is None:
        device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    
    for i in range(0, num_examples, batch_size):
        # 每次选出batch_size个随机样本
        batch_indices = example_indices[i: i + batch_size]  # 当前batch的各个样本的首字符的下标
        X = [_data(j) for j in batch_indices]
        Y = [_data(j + 1) for j in batch_indices]
        yield torch.tensor(X, device=device), torch.tensor(Y, device=device)
```

### 3.2.2 建立LSTM模型


```python
corpus_indices, char_to_idx, idx_to_char, vocab_size = load_data()
num_inputs, num_hiddens, num_outputs = vocab_size, 128, vocab_size
pred_period, pred_len, prefixes = 50, 50, ['磨蹭', '运动']
rnn_layer = nn.LSTM(input_size=vocab_size, hidden_size=num_hiddens)
num_steps, batch_size = 35, 2
X = torch.rand(num_steps, batch_size, vocab_size)
state = None
Y, state_new = rnn_layer(X, state)
print(Y, state_new)
```

    tensor([[[ 0.1505, -0.0121, -0.1201,  ...,  0.0154,  0.0102,  0.1917],
             [ 0.1206,  0.0872, -0.1786,  ...,  0.1695,  0.0934,  0.0650]],
    
            [[ 0.2729,  0.1025, -0.1804,  ...,  0.0060, -0.0280,  0.2460],
             [ 0.1685,  0.1387, -0.1548,  ...,  0.0490,  0.0618,  0.1571]],
    
            [[ 0.2348,  0.1259, -0.2105,  ..., -0.0201, -0.0590,  0.1245],
             [ 0.3138,  0.1439, -0.1368,  ...,  0.0341,  0.0782,  0.0061]],
    
            ...,
    
            [[ 0.3405,  0.0985, -0.1234,  ..., -0.0847,  0.0904,  0.0674],
             [ 0.3142,  0.1637, -0.1401,  ..., -0.0214,  0.2267,  0.1097]],
    
            [[ 0.3618,  0.1303, -0.1274,  ..., -0.0620,  0.0613,  0.0844],
             [ 0.2891,  0.1465, -0.0816,  ..., -0.0151,  0.1045,  0.0894]],
    
            [[ 0.3636,  0.2133, -0.2550,  ..., -0.1056,  0.0514,  0.0532],
             [ 0.3543,  0.1144, -0.1102,  ..., -0.0843,  0.1358,  0.0147]]],
           grad_fn=<StackBackward>) (tensor([[[ 0.3636,  0.2133, -0.2550, -0.0327, -0.0671, -0.1316, -0.0432,
               0.0469, -0.0175, -0.2203, -0.3237,  0.1286, -0.0785, -0.3350,
               0.0219,  0.0313, -0.4987,  0.1275, -0.0659,  0.0532, -0.1015,
              -0.1563, -0.0931,  0.0859,  0.2320, -0.2938,  0.0311, -0.2622,
               0.2913, -0.0138,  0.1545,  0.0733,  0.1229,  0.0146, -0.1122,
              -0.1745,  0.1701,  0.1961,  0.1625,  0.2665,  0.0442, -0.1725,
               0.0552, -0.0501, -0.0454, -0.0565,  0.0964,  0.0485,  0.2265,
               0.1797,  0.0405, -0.1239,  0.0497, -0.0369, -0.0441,  0.2496,
              -0.2488, -0.1359, -0.1834, -0.0923,  0.0778,  0.1960, -0.1513,
              -0.0541,  0.3140, -0.1445,  0.0692,  0.0402, -0.0396,  0.0880,
               0.1814,  0.0010, -0.2044,  0.0960,  0.0595, -0.3913,  0.3976,
              -0.0875, -0.0566,  0.1413, -0.2758,  0.3505,  0.0044,  0.4046,
              -0.0319, -0.1561, -0.2721,  0.2143, -0.2466,  0.1356, -0.1619,
              -0.0259, -0.1643,  0.3315,  0.1936, -0.1417,  0.0277, -0.1735,
               0.1285,  0.0301,  0.0394, -0.3125, -0.1247, -0.0819,  0.0497,
              -0.4048, -0.0828, -0.1393, -0.0803,  0.4764, -0.1217, -0.2000,
              -0.0858, -0.2750,  0.1232, -0.1464,  0.0010,  0.1947,  0.1134,
               0.0592,  0.1375, -0.2348,  0.0620,  0.1457,  0.1755, -0.1056,
               0.0514,  0.0532],
             [ 0.3543,  0.1144, -0.1102, -0.1269, -0.1908, -0.1522,  0.0499,
              -0.0257, -0.0071, -0.1593, -0.1807,  0.1036, -0.0805, -0.2709,
               0.0891,  0.0974, -0.4413,  0.0931, -0.0788, -0.0837,  0.0950,
              -0.1788,  0.0219,  0.0896,  0.2312, -0.2203,  0.0045, -0.2710,
               0.2728,  0.0314,  0.1076, -0.1126,  0.2052,  0.0672, -0.0509,
              -0.2367,  0.0697,  0.0893,  0.1611,  0.2617,  0.1252, -0.0906,
              -0.0278,  0.0224, -0.0296, -0.0117,  0.0529,  0.0950,  0.2971,
               0.1355,  0.1353, -0.0670,  0.0739,  0.1207,  0.0461,  0.3151,
              -0.1852, -0.1280, -0.0977, -0.2161,  0.1130,  0.0965, -0.2107,
              -0.1578,  0.2630, -0.1469, -0.0527, -0.0718,  0.0500,  0.0280,
               0.1881,  0.2066, -0.1421, -0.0014, -0.0814, -0.4617,  0.3670,
              -0.0771,  0.0202,  0.0410,  0.0629,  0.1904, -0.0662,  0.3721,
               0.1830, -0.2885, -0.2606,  0.0781, -0.2184, -0.0938, -0.0256,
              -0.0382, -0.1304,  0.2858,  0.1708, -0.2095,  0.0728, -0.3210,
               0.0786, -0.0177,  0.0499, -0.1097, -0.1129, -0.0528,  0.0883,
              -0.3740,  0.1289, -0.0825, -0.0121,  0.3731, -0.1105, -0.1701,
              -0.0307, -0.3474,  0.1078, -0.1825,  0.0239,  0.1874, -0.0181,
               0.1899,  0.1472, -0.3656,  0.0956,  0.2391,  0.1745, -0.0843,
               0.1358,  0.0147]]], grad_fn=<StackBackward>), tensor([[[ 0.8028,  0.5036, -0.5144, -0.0807, -0.1176, -0.2258, -0.0780,
               0.1464, -0.0309, -0.4068, -0.5055,  0.4644, -0.1360, -0.6058,
               0.0431,  0.0674, -1.1181,  0.2989, -0.1112,  0.0801, -0.1605,
              -0.3258, -0.2317,  0.3170,  0.6387, -0.5458,  0.0634, -0.4735,
               0.4368, -0.0387,  0.2790,  0.1456,  0.4945,  0.0420, -0.2953,
              -0.3813,  0.3779,  0.4991,  0.4590,  0.6961,  0.1057, -0.3433,
               0.1096, -0.0886, -0.1321, -0.1222,  0.3529,  0.1119,  0.4884,
               0.3759,  0.1204, -0.3546,  0.1350, -0.0643, -0.0813,  0.5251,
              -0.7117, -0.1854, -0.5705, -0.3533,  0.1244,  0.3007, -0.3222,
              -0.0876,  0.6190, -0.3032,  0.1414,  0.1102, -0.0803,  0.1543,
               0.4882,  0.0021, -0.3326,  0.2236,  0.1072, -0.7093,  0.6763,
              -0.1869, -0.1689,  0.4229, -0.4230,  0.6927,  0.0135,  0.7949,
              -0.0554, -0.2334, -0.4573,  0.3699, -0.4286,  0.2959, -0.3188,
              -0.1080, -0.3023,  0.6269,  0.3685, -0.8215,  0.0589, -0.4954,
               0.2659,  0.0544,  0.1460, -0.7042, -0.3362, -0.1364,  0.1003,
              -0.7804, -0.1289, -0.4125, -0.1194,  0.8486, -0.4195, -0.3277,
              -0.1331, -0.6847,  0.2405, -0.2582,  0.0018,  0.4020,  0.2293,
               0.1113,  0.3993, -0.5739,  0.1317,  0.3278,  0.3919, -0.2769,
               0.0964,  0.1030],
             [ 0.7726,  0.3164, -0.3003, -0.2459, -0.2936, -0.2228,  0.0930,
              -0.0550, -0.0146, -0.2776, -0.3366,  0.5018, -0.1309, -0.5009,
               0.1563,  0.1668, -0.9630,  0.1573, -0.1463, -0.1366,  0.1575,
              -0.4154,  0.0584,  0.2055,  0.6111, -0.5179,  0.0093, -0.4390,
               0.3835,  0.0747,  0.1845, -0.2056,  0.6121,  0.2358, -0.1518,
              -0.4285,  0.1598,  0.2085,  0.4223,  0.6072,  0.2889, -0.2568,
              -0.0759,  0.0484, -0.0704, -0.0290,  0.1742,  0.1850,  0.5002,
               0.2592,  0.4573, -0.2163,  0.2250,  0.2500,  0.1075,  0.6684,
              -0.4719, -0.1777, -0.3661, -0.5484,  0.1719,  0.1390, -0.4617,
              -0.3927,  0.4537, -0.2850, -0.1285, -0.1412,  0.0966,  0.0557,
               0.4659,  0.5444, -0.2580, -0.0034, -0.1382, -0.8836,  0.6850,
              -0.1801,  0.0543,  0.1564,  0.1208,  0.4228, -0.1974,  0.8138,
               0.3049, -0.5190, -0.3990,  0.1246, -0.3926, -0.1601, -0.0605,
              -0.1630, -0.2080,  0.7139,  0.3266, -0.8636,  0.2152, -0.6077,
               0.1978, -0.0458,  0.2075, -0.1846, -0.2509, -0.0852,  0.1751,
              -0.7417,  0.2107, -0.2086, -0.0175,  0.7400, -0.3038, -0.2729,
              -0.0513, -0.5554,  0.2092, -0.3404,  0.0399,  0.3816, -0.0351,
               0.3130,  0.3474, -0.7754,  0.2127,  0.5402,  0.3775, -0.2647,
               0.2298,  0.0249]]], grad_fn=<StackBackward>))
    


```python
def one_hot(x, n_class, dtype=torch.float32):
    result = torch.zeros(len(x), n_class, dtype=dtype, device=x.device)  # shape: (n, n_class)
    result.scatter_(1, x.long().view(-1, 1), 1)  # result[i, x[i, 0]] = 1
    return result
    
def to_onehot(X, n_class):
    return [one_hot(X[:, i], n_class) for i in range(X.shape[1])]

class RNNModel(nn.Module):
    def __init__(self, rnn_layer, vocab_size):
        super(RNNModel, self).__init__()
        self.rnn = rnn_layer
        self.hidden_size = rnn_layer.hidden_size * (2 if rnn_layer.bidirectional else 1) 
        self.vocab_size = vocab_size
        self.dense = nn.Linear(self.hidden_size, vocab_size)

    def forward(self, inputs, state):
        # inputs.shape: (batch_size, num_steps)
        X = to_onehot(inputs, vocab_size)
        X = torch.stack(X)  # X.shape: (num_steps, batch_size, vocab_size)
        hiddens, state = self.rnn(X, state)
        hiddens = hiddens.view(-1, hiddens.shape[-1])  # hiddens.shape: (num_steps * batch_size, hidden_size)
        output = self.dense(hiddens)
        return output, state
```


```python
# 实现一个预测函数，与前面的区别在于前向计算和初始化隐藏状态
def predict_rnn_pytorch(prefix, num_chars, model, vocab_size, device, idx_to_char,
                      char_to_idx):
    state = None
    output = [char_to_idx[prefix[0]]]  # output记录prefix加上预测的num_chars个字符
    for t in range(num_chars + len(prefix) - 1):
        X = torch.tensor([output[-1]], device=device).view(1, 1)
        (Y, state) = model(X, state)  # 前向计算不需要传入模型参数
        if t < len(prefix) - 1:
            output.append(char_to_idx[prefix[t + 1]])
        else:
            output.append(Y.argmax(dim=1).item())
    return '=>'.join([idx_to_char[i] for i in output])
```


```python
device = 'cpu'
model = RNNModel(rnn_layer, vocab_size).to(device)
predict_rnn_pytorch(['运动'], 10, model, vocab_size, device, idx_to_char, char_to_idx)
```




    '运动=>导师谈话=>整理资料=>gis=>整理资料=>gis=>整理资料=>gis=>整理资料=>gis=>整理资料'



### 3.2.3 模型训练


```python
def grad_clipping(params, theta, device):
    norm = torch.tensor([0.0], device=device)
    for param in params:
        norm += (param.grad.data ** 2).sum()
    norm = norm.sqrt().item()
    if norm > theta:
        for param in params:
            param.grad.data *= (theta / norm)

def data_iter_consecutive(corpus_indices, batch_size, num_steps, device=None):
    if device is None:
        device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    corpus_len = len(corpus_indices) // batch_size * batch_size  # 保留下来的序列的长度
    corpus_indices = corpus_indices[: corpus_len]  # 仅保留前corpus_len个字符
    indices = torch.tensor(corpus_indices, device=device)
    indices = indices.view(batch_size, -1)  # resize成(batch_size, )
    batch_num = (indices.shape[1] - 1) // num_steps
    for i in range(batch_num):
        i = i * num_steps
        X = indices[:, i: i + num_steps]
        Y = indices[:, i + 1: i + num_steps + 1]
        yield X, Y
```


```python
def train_and_predict_rnn_pytorch(model, num_hiddens, vocab_size, device,
                                corpus_indices, idx_to_char, char_to_idx,
                                num_epochs, num_steps, lr, clipping_theta,
                                batch_size, pred_period, pred_len, prefixes):
    loss = nn.CrossEntropyLoss()
    optimizer = torch.optim.Adam(model.parameters(), lr=lr)
    model.to(device)
    for epoch in tqdm(range(num_epochs)):
        l_sum, n = 0.0, 0
        data_iter = data_iter_consecutive(corpus_indices, batch_size, num_steps, device) # 相邻采样
        state = None
        for X, Y in data_iter:
            loss_list = []
            if state is not None:
                # 使用detach函数从计算图分离隐藏状态
                if isinstance (state, tuple): # LSTM, state:(h, c)  
                    state[0].detach_()
                    state[1].detach_()
                else: 
                    state.detach_()
            (output, state) = model(X, state) # output.shape: (num_steps * batch_size, vocab_size)
            y = torch.flatten(Y.T)
            l = loss(output, y.long())
            loss_list.append(l)
            optimizer.zero_grad()
            l.backward()
            grad_clipping(model.parameters(), clipping_theta, device)
            optimizer.step()
            l_sum += l.item() * y.shape[0]
            n += y.shape[0]
        

        if (epoch + 1) % pred_period == 0:
            for prefix in prefixes:
                print(' -', predict_rnn_pytorch(
                    prefix, pred_len, model, vocab_size, device, idx_to_char,
                    char_to_idx))
```


```python
rnn_layer = nn.LSTM(input_size=vocab_size, hidden_size=num_hiddens)
model = RNNModel(rnn_layer, vocab_size).to(device)
num_epochs, batch_size, lr, clipping_theta = 2000, 64, 1e-2, 1e-2
print_num = 10
pred_period = num_epochs / print_num
pred_len, prefixes = 15, [
    ['华尔街日报'], 
    ['晚饭'], 
    ['摄影'], 
    ['接单工作'], 
    ['gis'],
    ['量化'], 
    ['玩游戏'],
]
train_and_predict_rnn_pytorch(model, num_hiddens, vocab_size, device,
    corpus_indices, idx_to_char, char_to_idx,
    num_epochs, num_steps, lr, clipping_theta,
    batch_size, pred_period, pred_len, prefixes
)
```

     10%|█         | 200/2000 [01:00<09:08,  3.28it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 摄影=>磨蹭=>写日记=>华尔街日报=>做家务=>华尔街日报=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>摄影=>磨蹭=>运动
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - gis=>晚饭=>玩游戏=>接单工作=>磨蹭=>人文课=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>华尔街日报=>人文书籍=>接单工作
     - 量化=>写日记=>量化=>磨蹭=>摄影=>磨蹭=>运动=>晚饭=>磨蹭=>深度学习=>磨蹭=>量化=>磨蹭=>写日记=>华尔街日报=>运动
     - 玩游戏=>GRE填空=>AQF=>晚饭=>磨蹭=>单词=>磨蹭=>数值分析=>写日记=>R=>磨蹭=>GRE填空=>磨蹭=>练字=>GRE填空=>单词
    

     20%|██        | 400/2000 [02:01<08:09,  3.27it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 摄影=>磨蹭=>运动=>磨蹭=>写日记=>接单工作=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>数据分析=>做家务
     - 接单工作=>午饭=>午休=>接单工作=>人文书籍=>量化=>玩游戏=>算法课程=>磨蹭=>运动=>接单工作=>晚饭=>人文课=>磨蹭=>华尔街日报=>写日记
     - gis=>晚饭=>玩游戏=>接单工作=>托福口语=>玩游戏=>写日记=>接单工作=>华尔街日报=>午饭=>人文课=>午休=>玩游戏=>接单工作=>人文书籍=>量化
     - 量化=>午饭=>磨蹭=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>量化=>运动=>晚饭=>磨蹭=>接单工作=>磨蹭=>写日记=>华尔街日报
     - 玩游戏=>GRE填空=>AQF=>晚饭=>磨蹭=>单词=>磨蹭=>数值分析=>写日记=>R=>磨蹭=>GRE填空=>磨蹭=>练字=>GRE填空=>单词
    

     30%|███       | 600/2000 [03:01<07:06,  3.28it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 摄影=>磨蹭=>写日记=>华尔街日报=>做家务=>华尔街日报=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>摄影=>磨蹭=>运动
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - gis=>晚饭=>玩游戏=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭=>华尔街日报=>磨蹭=>华尔街日报=>写日记
     - 量化=>午饭=>磨蹭=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>量化=>运动=>晚饭=>磨蹭=>接单工作=>磨蹭=>写日记=>华尔街日报
     - 玩游戏=>GRE填空=>午饭=>玩游戏=>磨蹭=>午休=>GRE填空=>磨蹭=>单词=>托福阅读=>单词=>磨蹭=>晚饭=>单词=>GRE写作=>写日记
    

     40%|████      | 800/2000 [04:02<06:09,  3.25it/s]

     - 华尔街日报=>磨蹭=>随机过程=>数值分析=>写日记=>偏微分=>玩游戏=>算法课程=>午饭=>午休=>西洋画=>磨蹭=>课=>答疑=>晚饭=>磨蹭
     - 晚饭=>玩游戏=>GRE写作=>磨蹭=>GRE填空=>写日记=>磨蹭=>GRE填空=>磨蹭=>GRE填空=>单词=>午饭=>午休=>单词=>GRE填空=>磨蹭
     - 摄影=>磨蹭=>写日记=>华尔街日报=>做家务=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>数据分析=>量化=>运动=>晚饭=>人文课=>摄影
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - gis=>晚饭=>玩游戏=>接单工作=>磨蹭=>人文课=>写日记=>华尔街日报=>接单工作=>午饭=>午休=>玩游戏=>华尔街日报=>人文书籍=>华尔街日报=>晚饭
     - 量化=>写日记=>量化=>磨蹭=>摄影=>磨蹭=>运动=>晚饭=>磨蹭=>深度学习=>磨蹭=>量化=>磨蹭=>写日记=>华尔街日报=>运动
     - 玩游戏=>GRE填空=>午饭=>玩游戏=>单词=>午休=>磨蹭=>单词=>晚饭=>磨蹭=>单词=>GRE写作=>写日记=>单词=>抢课=>托福听力
    

     50%|█████     | 1000/2000 [05:01<04:44,  3.52it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 摄影=>磨蹭=>写日记=>华尔街日报=>做家务=>华尔街日报=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>摄影=>磨蹭=>运动
     - 接单工作=>午饭=>午休=>接单工作=>人文书籍=>量化=>玩游戏=>算法课程=>磨蹭=>运动=>接单工作=>晚饭=>人文课=>磨蹭=>华尔街日报=>写日记
     - gis=>晚饭=>玩游戏=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>机器学习=>量化
     - 量化=>写日记=>量化=>磨蹭=>摄影=>磨蹭=>运动=>晚饭=>磨蹭=>深度学习=>磨蹭=>量化=>磨蹭=>写日记=>华尔街日报=>运动
     - 玩游戏=>GRE填空=>午饭=>玩游戏=>磨蹭=>午休=>GRE填空=>磨蹭=>单词=>托福阅读=>单词=>磨蹭=>晚饭=>单词=>GRE写作=>写日记
    

     60%|██████    | 1200/2000 [06:02<04:11,  3.19it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 摄影=>磨蹭=>写日记=>华尔街日报=>做家务=>华尔街日报=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>摄影=>磨蹭=>运动
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - gis=>晚饭=>磨蹭=>接单工作=>玩游戏=>磨蹭=>python=>写日记=>python=>运动=>午饭=>磨蹭=>午休=>玩游戏=>人文书籍=>机器学习
     - 量化=>午饭=>磨蹭=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>量化=>运动=>晚饭=>磨蹭=>接单工作=>磨蹭=>写日记=>华尔街日报
     - 玩游戏=>GRE填空=>AQF=>晚饭=>磨蹭=>单词=>磨蹭=>数值分析=>写日记=>R=>磨蹭=>GRE填空=>磨蹭=>练字=>GRE填空=>单词
    

     70%|███████   | 1400/2000 [07:03<03:08,  3.18it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 摄影=>磨蹭=>运动=>磨蹭=>写日记=>接单工作=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>数据分析=>做家务
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭
     - gis=>晚饭=>快递=>磨蹭=>人文课=>机器学习=>写日记=>华尔街日报=>运动=>午饭=>午休=>玩游戏=>华尔街日报=>人文书籍=>gis=>玩游戏
     - 量化=>写日记=>量化=>磨蹭=>摄影=>磨蹭=>运动=>晚饭=>磨蹭=>深度学习=>磨蹭=>量化=>磨蹭=>写日记=>华尔街日报=>运动
     - 玩游戏=>GRE填空=>AQF=>晚饭=>磨蹭=>单词=>磨蹭=>数值分析=>写日记=>R=>磨蹭=>GRE填空=>磨蹭=>练字=>GRE填空=>单词
    

     80%|████████  | 1600/2000 [08:01<01:59,  3.35it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 摄影=>磨蹭=>运动=>磨蹭=>写日记=>接单工作=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>数据分析=>做家务
     - 接单工作=>午饭=>午休=>接单工作=>人文书籍=>量化=>玩游戏=>算法课程=>磨蹭=>运动=>接单工作=>晚饭=>人文课=>磨蹭=>华尔街日报=>写日记
     - gis=>晚饭=>快递=>磨蹭=>人文课=>机器学习=>写日记=>华尔街日报=>运动=>午饭=>午休=>玩游戏=>华尔街日报=>人文书籍=>gis=>玩游戏
     - 量化=>写日记=>量化=>磨蹭=>摄影=>磨蹭=>运动=>晚饭=>磨蹭=>深度学习=>磨蹭=>量化=>磨蹭=>写日记=>华尔街日报=>运动
     - 玩游戏=>GRE填空=>午饭=>玩游戏=>磨蹭=>午休=>GRE填空=>磨蹭=>单词=>托福阅读=>单词=>磨蹭=>晚饭=>单词=>GRE写作=>写日记
    

     90%|█████████ | 1800/2000 [08:58<01:01,  3.27it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 摄影=>磨蹭=>运动=>磨蹭=>写日记=>接单工作=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>数据分析=>做家务
     - 接单工作=>午饭=>午休=>接单工作=>人文书籍=>量化=>玩游戏=>算法课程=>磨蹭=>运动=>接单工作=>晚饭=>人文课=>磨蹭=>华尔街日报=>写日记
     - gis=>晚饭=>算法课程=>磨蹭=>华尔街日报=>午饭=>午休=>单词=>磨蹭=>机器学习=>量化=>晚饭=>散步=>人文课=>机器学习=>磨蹭
     - 量化=>午饭=>磨蹭=>午休=>玩游戏=>人文书籍=>量化=>玩游戏=>量化=>运动=>晚饭=>磨蹭=>接单工作=>磨蹭=>写日记=>华尔街日报
     - 玩游戏=>GRE填空=>AQF=>晚饭=>磨蹭=>单词=>磨蹭=>数值分析=>写日记=>R=>磨蹭=>GRE填空=>磨蹭=>练字=>GRE填空=>单词
    

    100%|██████████| 2000/2000 [09:55<00:00,  3.36it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 摄影=>磨蹭=>运动=>磨蹭=>写日记=>接单工作=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>量化=>数据分析=>做家务
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭
     - gis=>晚饭=>算法课程=>接单工作=>晚饭=>磨蹭=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>午饭=>午休=>接单工作=>玩游戏=>人文书籍
     - 量化=>写日记=>量化=>磨蹭=>摄影=>磨蹭=>运动=>晚饭=>磨蹭=>深度学习=>磨蹭=>量化=>磨蹭=>写日记=>华尔街日报=>运动
     - 玩游戏=>GRE填空=>AQF=>晚饭=>磨蹭=>单词=>磨蹭=>数值分析=>写日记=>R=>磨蹭=>GRE填空=>磨蹭=>练字=>GRE填空=>单词
    

    
    


```python
rnn_layer = nn.GRU(input_size=vocab_size, hidden_size=num_hiddens)
model = RNNModel(rnn_layer, vocab_size).to(device)
num_epochs, batch_size, lr, clipping_theta = 2000, 64, 1e-2, 1e-2
print_num = 10
pred_period = num_epochs / print_num
pred_len, prefixes = 15, [
    ['华尔街日报'], 
    ['晚饭'], 
    ['接单工作'], 
    ['托福听力'], 
    ['磨蹭'],
    ['写日记']
]
train_and_predict_rnn_pytorch(model, num_hiddens, vocab_size, device,
    corpus_indices, idx_to_char, char_to_idx,
    num_epochs, num_steps, lr, clipping_theta,
    batch_size, pred_period, pred_len, prefixes
)
```

     10%|█         | 200/2000 [00:48<07:20,  4.08it/s]

     - 华尔街日报=>晚饭=>华尔街日报=>人文课=>随机微积分=>写日记=>量化=>玩游戏=>可视化=>午饭=>午休=>python=>单词=>华尔街日报=>晚饭=>修图
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - 托福听力=>磨蹭=>量化=>磨蹭=>晚饭=>散步=>华尔街日报=>磨蹭=>托福听力=>磨蹭=>单词=>人文课=>磨蹭=>写日记=>单词=>玩游戏
     - 磨蹭=>写日记=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>磨蹭=>机器学习=>晚饭=>晚饭=>人文课=>接单工作=>磨蹭
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>量化=>磨蹭=>摄影=>写报告=>运动=>磨蹭=>晚饭=>散步=>接单工作=>磨蹭
    

     20%|██        | 400/2000 [01:38<06:57,  3.83it/s]

     - 华尔街日报=>晚饭=>华尔街日报=>人文课=>随机微积分=>写日记=>量化=>玩游戏=>可视化=>午饭=>午休=>python=>单词=>华尔街日报=>晚饭=>修图
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭
     - 托福听力=>磨蹭=>量化=>磨蹭=>午饭=>磨蹭=>午休=>磨蹭=>单词=>课=>磨蹭=>GRE阅读=>晚饭=>磨蹭=>GRE阅读=>GRE数学
     - 磨蹭=>写日记=>GRE阅读=>磨蹭=>单词=>银行会计=>玩游戏=>单词=>午饭=>磨蹭=>午休=>GRE长难句=>玩游戏=>GRE阅读=>玩游戏=>单词
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>量化=>磨蹭=>摄影=>写报告=>运动=>磨蹭=>晚饭=>散步=>接单工作=>磨蹭
    

     30%|███       | 600/2000 [02:27<05:57,  3.92it/s]

     - 华尔街日报=>晚饭=>华尔街日报=>人文课=>随机微积分=>写日记=>量化=>玩游戏=>可视化=>午饭=>午休=>python=>单词=>华尔街日报=>晚饭=>修图
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 接单工作=>午饭=>午休=>接单工作=>人文书籍=>量化=>玩游戏=>算法课程=>磨蹭=>运动=>接单工作=>晚饭=>人文课=>磨蹭=>华尔街日报=>写日记
     - 托福听力=>磨蹭=>晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>托福写作=>写日记=>托福口语=>磨蹭=>课=>玩游戏=>午饭=>午饭=>午休
     - 磨蹭=>写日记=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>磨蹭=>机器学习=>晚饭=>晚饭=>人文课=>接单工作=>磨蹭
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>磨蹭=>午休=>华尔街日报=>玩游戏=>人文书籍=>量化=>玩游戏=>算法课程=>运动=>晚饭=>人文课
    

     40%|████      | 800/2000 [03:15<04:51,  4.12it/s]

     - 华尔街日报=>磨蹭=>随机过程=>数值分析=>写日记=>偏微分=>玩游戏=>算法课程=>午饭=>午休=>西洋画=>磨蹭=>课=>答疑=>晚饭=>磨蹭
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭
     - 托福听力=>磨蹭=>晚饭=>磨蹭=>托福口语=>磨蹭=>托福写作=>写日记=>托福口语=>磨蹭=>托福写作=>练字=>午饭=>午休=>托福听力=>磨蹭
     - 磨蹭=>写日记=>GRE阅读=>磨蹭=>单词=>银行会计=>玩游戏=>单词=>午饭=>磨蹭=>午休=>GRE长难句=>玩游戏=>GRE阅读=>玩游戏=>单词
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>磨蹭=>午休=>华尔街日报=>玩游戏=>人文书籍=>量化=>玩游戏=>算法课程=>运动=>晚饭=>人文课
    

     50%|█████     | 1000/2000 [04:02<04:00,  4.16it/s]

     - 华尔街日报=>磨蹭=>随机过程=>数值分析=>写日记=>偏微分=>玩游戏=>算法课程=>午饭=>午休=>西洋画=>磨蹭=>课=>答疑=>晚饭=>磨蹭
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭
     - 托福听力=>磨蹭=>晚饭=>磨蹭=>托福口语=>万矿量化=>磨蹭=>托福写作=>写日记=>托福口语=>玩游戏=>GRE填空=>单词=>午饭=>单词=>午休
     - 磨蹭=>写日记=>GRE阅读=>磨蹭=>单词=>银行会计=>玩游戏=>单词=>午饭=>磨蹭=>午休=>GRE长难句=>玩游戏=>GRE阅读=>玩游戏=>单词
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>量化=>磨蹭=>摄影=>写报告=>运动=>磨蹭=>晚饭=>散步=>接单工作=>磨蹭
    

     60%|██████    | 1200/2000 [04:50<03:14,  4.11it/s]

     - 华尔街日报=>晚饭=>华尔街日报=>人文课=>随机微积分=>写日记=>量化=>玩游戏=>可视化=>午饭=>午休=>python=>单词=>华尔街日报=>晚饭=>修图
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - 托福听力=>托福写作=>磨蹭=>晚饭=>磨蹭=>托福口语=>磨蹭=>托福写作=>写日记=>托福口语=>玩游戏=>单词=>课=>磨蹭=>写日记=>GRE阅读
     - 磨蹭=>写日记=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>磨蹭=>机器学习=>晚饭=>晚饭=>人文课=>接单工作=>磨蹭
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>量化=>磨蹭=>摄影=>写报告=>运动=>晚饭=>人文书籍=>磨蹭=>摄影=>磨蹭
    

     70%|███████   | 1400/2000 [05:38<02:27,  4.06it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>磨蹭=>接单工作=>玩游戏=>单词=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报
     - 托福听力=>托福写作=>磨蹭=>晚饭=>托福口语=>玩游戏=>AQF=>磨蹭=>托福听力=>课=>磨蹭=>答疑=>托福听力=>晚饭=>磨蹭=>托福写作
     - 磨蹭=>写日记=>GRE阅读=>磨蹭=>单词=>银行会计=>玩游戏=>单词=>午饭=>磨蹭=>单词=>午休=>GRE长难句=>AQF=>GRE阅读=>AQF
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>量化=>磨蹭=>摄影=>写报告=>运动=>磨蹭=>晚饭=>散步=>接单工作=>磨蹭
    

     80%|████████  | 1600/2000 [06:27<01:36,  4.14it/s]

     - 华尔街日报=>磨蹭=>随机过程=>数值分析=>写日记=>偏微分=>玩游戏=>算法课程=>午饭=>午休=>西洋画=>磨蹭=>课=>答疑=>晚饭=>磨蹭
     - 晚饭=>磨蹭=>单词=>人文课=>python=>写日记=>python=>玩游戏=>毕业论文=>午饭=>毕业论文=>午休=>人文书籍=>泛函=>华尔街日报=>晚饭
     - 接单工作=>玩游戏=>接单工作=>磨蹭=>运动=>晚饭=>人文课=>接单工作=>磨蹭=>接单工作=>写日记=>华尔街日报=>玩游戏=>接单工作=>华尔街日报=>午饭
     - 托福听力=>托福写作=>磨蹭=>晚饭=>托福口语=>磨蹭=>AQF=>托福听力=>磨蹭=>写日记=>华尔街日报=>单词=>GRE填空=>练字=>GRE填空=>单词
     - 磨蹭=>写日记=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>磨蹭=>机器学习=>晚饭=>晚饭=>人文课=>接单工作=>磨蹭
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>磨蹭=>午休=>华尔街日报=>玩游戏=>人文书籍=>量化=>玩游戏=>算法课程=>运动=>晚饭=>人文课
    

     90%|█████████ | 1800/2000 [07:15<00:50,  3.98it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>磨蹭=>托福口语=>单词=>改代码=>单词=>午饭=>托福口语
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>玩游戏=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>华尔街日报=>人文书籍=>随机微积分=>算法课程=>玩游戏=>运动
     - 托福听力=>托福写作=>磨蹭=>晚饭=>托福口语=>托福听力=>玩游戏=>写日记=>华尔街日报=>磨蹭=>单词=>玩游戏=>磨蹭=>单词=>午饭=>磨蹭
     - 磨蹭=>写日记=>华尔街日报=>运动=>午饭=>人文课=>午休=>玩游戏=>人文书籍=>磨蹭=>机器学习=>晚饭=>晚饭=>人文课=>接单工作=>磨蹭
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>磨蹭=>午休=>华尔街日报=>玩游戏=>人文书籍=>量化=>玩游戏=>算法课程=>运动=>晚饭=>人文课
    

    100%|██████████| 2000/2000 [08:04<00:00,  4.13it/s]

     - 华尔街日报=>运动=>晚饭=>人工智能=>修图=>磨蹭=>人工智能=>随机微积分=>写日记=>人工智能=>玩游戏=>运动=>算法课程=>午饭=>算法课程=>午休
     - 晚饭=>磨蹭=>托福口语=>改代码=>磨蹭=>整理资料=>写日记=>托福听力=>托福听力=>托福口语=>磨蹭=>托福口语=>托福写作=>玩游戏=>晚饭=>磨蹭
     - 接单工作=>磨蹭=>写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>人文书籍=>随机微积分=>玩游戏=>算法课程=>玩游戏=>华尔街日报=>运动=>晚饭
     - 托福听力=>课=>磨蹭=>托福听力=>磨蹭=>托福听力=>磨蹭=>单词=>托福听力=>磨蹭=>托福听力=>磨蹭=>单词=>磨蹭=>GRE长难句=>玩游戏
     - 磨蹭=>写日记=>GRE阅读=>磨蹭=>单词=>银行会计=>玩游戏=>单词=>晚饭=>玩游戏=>讲座=>磨蹭=>银行会计=>爬虫=>写日记=>R
     - 写日记=>华尔街日报=>运动=>华尔街日报=>午饭=>午休=>玩游戏=>磨蹭=>人文书籍=>量化=>磨蹭=>算法课程=>磨蹭=>写计划=>快递=>人文课
    

    
    

## 3.3 时长数据的简单聚类


```python
part = '3.3'

dates = pd.DataFrame(
    pd.date_range(
    start='2021-01-01',
    end='2021-12-30'
).astype(str), columns=['date']
)

data = pd.merge(
    dates, daily_attr[num_vars + ['date']], on='date', how='left'
)
```


```python
mergings = linkage(data.drop('date', axis=1).dropna())
plt.figure(figsize=(20, 10))
dendrogram(
    mergings,
    leaf_rotation=90,
    leaf_font_size=10, 
)
plt.yticks(fontsize=20)
title = f'{part} 2021时长数据层次聚类图'
plt.title(title, fontsize=10)
plt.savefig(os.path.join(path, f'{title}.png'), dpi=600)
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_145_0.png)
    


## 3.4 关于日期的缺失值处理


```python
# 对日度数据做处理 只分析2021年
part = '3.4'

# 生成新特征
data['weekday'] = pd.to_datetime(data['date']).dt.weekday + 1
data['month'] = data['date'].apply(lambda x:str(x).split('-')[1])
data['day'] = data['date'].apply(lambda x:str(x).split('-')[2])
data['week_order'] = data['date'].map(lambda x: pd.Period(x, freq='W'))

data.set_index('date')[num_vars].plot(
    figsize=(20, 10)
)

title = '各类时长每日总和的折线图'
plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Sum of duration', fontsize=20)
plt.yticks(fontsize=20)
plt.xticks(fontsize=20)
plt.legend(loc=1, fontsize=20)

print('缺失的行数有', data['有效时间'].isnull().sum())
```

    缺失的行数有 71
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_147_1.png)
    



```python
# 采样三次样条处理缺失
for col in data.columns:
    if '时间' in col:
        upper, lower = data[col].max(), data[col].min()
        data[col] = data[col].interpolate(method='spline', order=3)
        # 避免插值结果太超过想象
        data[col] = np.where(abs(data[col]) > upper, upper, data[col])
        data[col] = np.where(data[col] < lower, lower, data[col])
data = data.fillna(axis=0, method='bfill') 


title = f'{part} 处理缺失后的每日时长总和图'
data.set_index('date')[num_vars].plot(
    figsize=(20, 10), title=title
)

plt.title(title, fontsize=20)
plt.xlabel('Date', fontsize=20)
plt.ylabel('Sum of duration', fontsize=20)
plt.yticks(fontsize=20)
plt.xticks(fontsize=20)
plt.legend(loc=1, fontsize=20)

file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600) 

print('缺失的行数有', data['有效时间'].isnull().sum())
```

    缺失的行数有 0
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_148_1.png)
    


## 3.5 关于日期的傅里叶分解求周期


```python
part = '3.5'

def FRT(raw, k):
    fft_size = 1024*4
    peak_num =3 #找前几个周期；
    figure_flag = 1 #傅里叶变换是否画图，0：不画图 1：画图
    #获取指数同比序列
    seq = raw[k]
    seq_log = np.array(seq)
    dseq_log = signal.detrend(seq_log) #去趋势项
    freq_index = [i for i in range(fft_size)]
    freq_index[:int(fft_size/2+1)] = [i / fft_size for i in range(0, int(fft_size / 2 + 1))]
    # freq_index(fft_size/2+2:end) = [-fft_size/2+1:1:-1]/fft_size
    freq_index[int(fft_size/2+1):] = [i / fft_size for i in range(int(-fft_size / 2 + 1), 0)]
    # data_fft = abs(fftshift(fft(dseq_log, fft_size)));
    data_fft = abs(np.fft.fftshift(np.fft.fft(dseq_log, fft_size)))
    #freq_index = fftshift(freq_index);
    freq_index = np.fft.fftshift(freq_index)
    peak_num = 3

    loc_raw = list(signal.find_peaks(data_fft[int(fft_size/2):])[0])
    peak_raw = data_fft[int(fft_size/2):][loc_raw]
    data_dict = { key: value for key,value in zip(loc_raw,peak_raw)}
    temp = sorted(data_dict.items(),key=lambda x:x[1],reverse=True)
    loc_peaks = temp[:peak_num]

    plt.figure(figsize=(20,10))
    plt.plot(freq_index[int(fft_size/2+1):],data_fft[int(fft_size/2+1):])
    plt.grid(True)
    plt.xlabel('频率(Hz)', fontsize=20)
    plt.ylabel('幅度', fontsize=20)
    title = f'{part} {k}幅度频率图'
    plt.title(title, fontsize=20)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    for i in range(peak_num):
        plt.text(freq_index[loc_peaks[i][0]+int(fft_size/2-1)],
        loc_peaks[i][1],
        '[' + str(round(1 / freq_index[loc_peaks[i][0] + int(fft_size/2-1)],2)) + \
            ',' + str(round(loc_peaks[i][1])) + ']',
        fontsize=20
        )
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600) 

    # dseq_log,fft_size,peak_num,figure_flag
    def period_mean_fft(data,nfft,peak_num,figure_flag):
        data_n = np.array(data)
        if len(data_n.shape)>1 and data_n.shape[-1]>data_n.shape[0]:
            data_n = data_n.T
        Y_fft = np.fft.fft(data_n,nfft)
        nfft = len(Y_fft)
        Y_fft = np.delete(Y_fft,0)
        #power = abs(Y(1:floor(nfft/2))).^2;  %求功率谱
        power = np.abs(np.square(Y_fft[:int(np.floor(nfft/2))]))  #求功率谱
        #Amplitude = abs(Y(1:floor(nfft/2)));  %求振幅
        amplitude = np.abs(Y_fft[:int(np.floor(nfft/2))])  #求振幅
        nyquist = 1/2
        #freq = (1:floor(nfft/2))/(floor(nfft/2))*nyquist; 
        # %求频率，从低频到高频，最高的频率是nyquist,最低的频率是2/N
        freq = [nyquist*i/np.floor(nfft/2) for i in range(1,int(np.floor(nfft/2)+1))]
        freq = np.array(freq)
        period = 1/freq
        #[peaks,posi] = findpeaks(power,'NPeaks',peak_num,'SortStr','descend');
        loc_raw = list(signal.find_peaks(power)[0])
        peak_raw = power[loc_raw]
        data_dict = { key: value for key,value in zip(loc_raw,peak_raw)}
        temp = sorted(data_dict.items(),key=lambda x:x[1],reverse=True)
        loc_peaks = temp[:peak_num]
        posi = [loc_peaks[i][0] for i in range(peak_num)]
        T_fft = period[posi]
        if figure_flag == 1:
            plt.figure(figsize=(20,10))
            plt.plot(period,power)
            plt.grid(True)
            plt.xlabel('周期', fontsize=20)
            plt.ylabel('功率', fontsize=20)
            title = f'{part} {k}的周期-振幅图'
            plt.title(title, fontsize=20)
            for i in range(peak_num):
                plt.text(period[loc_peaks[i][0]],
                loc_peaks[i][1],
                '[' + str(round(period[loc_peaks[i][0]], 2)) + \
                    ',' + str(round(loc_peaks[i][1])) + ']',
                fontsize=20
                )
            plt.xticks(fontsize=20)
            plt.yticks(fontsize=20)
            plt.xlim(12,300)
            file = os.path.join(path, f'{title}.png')
            plt.savefig(file, dpi=600) 

        return T_fft

    return period_mean_fft(dseq_log,fft_size,peak_num,figure_flag)
```


```python
# 有效时间
FRT(data, '有效时间')
```




    array([105.02564103, 170.66666667, 341.33333333])




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_151_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_151_2.png)
    



```python
# 浪费时间
FRT(data, '浪费时间')
```




    array([146.28571429,  26.5974026 ,  77.28301887])




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_152_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_152_2.png)
    



```python
# 必要时间
FRT(data, '必要时间')
```




    array([105.02564103, 170.66666667,  69.42372881])




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_153_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_153_2.png)
    



```python
# 手机时间
FRT(data, '手机时间')
```




    array([ 14.07560137, 273.06666667,  12.92113565])




    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_154_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_154_2.png)
    


## 3.6 关于日期的传统时间序列分析

### 3.6.1 ARIMA分析


```python
part = '3.6.1'

def cum_sum(data, n=1):
    if n == 1:
        return data.cumsum()
    return cum_sum(data, n - 1).cumsum() 

def diff(data, n):
    if n == 1:
        return data.diff()
    return diff(data, n - 1).diff()


#ARIMA
class ARIMA_auto:
    def __init__(self, data, col):
        self.col = col
        self.data = data
        self.result_ARMA = self.fit()
        self.predictions_ARMA = self.pre()
        self.arch_p = self.arch_diag()

    # Test seasonality and stationarity 
    def diff_stat(self):
        nor_p = stats.shapiro(self.data)
        if nor_p[1] > 0.05:
            print(f'{self.col} can be assumed to be normally distributed')
        else:
            print(f'{self.col} cannot be assumed to be normally distributed')

        # ACF
        fig, ax = plt.subplots(figsize=(20, 10))
        fig = plot_acf(self.data, alpha=0.05, ax=ax, lags=10, unbiased=True)
        title = f'{part} {self.col}的ACF图'
        plt.xlabel('Order', fontsize=20)
        plt.ylabel('ACF', fontsize=20)
        plt.title(title, fontsize=20)   
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600) 

        # PACF
        fig, ax = plt.subplots(figsize=(20, 10))
        fig = plot_pacf(self.data, alpha=0.05, ax=ax, lags=10)
        title = f'{part} {self.col}的PACF图'
        plt.xlabel('Order', fontsize=20)
        plt.ylabel('PACF', fontsize=20)
        plt.title(title, fontsize=20)   
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600) 

        # 时间序列分解
        ts = seasonal_decompose(self.data, freq=12)
        plt.figure(figsize=(20, 10))
        ts.plot()
        title = f'{part} {self.col}的时间序列分解图'
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600)

        p_value = adfuller(self.data)[1]
        if p_value < 0.05:
            print(f'{self.col} is stationary')
            return 0
        print(f'{self.col} is not stationary')
        i = 1 
        p_value = adfuller(diff(self.data, i).dropna())[1]
        while p_value >= 0.05:
            i += 1
            p_value = adfuller(diff(self.data, i).dropna())[1]
        return i


    # find the order for ARMA 
    @staticmethod
    def find_order(series):
        order = st.arma_order_select_ic(
                series, 
                max_ar=3,
                max_ma=3, 
                ic=['aic', 'bic', 'hqic']
            )
        order_min = order.aic_min_order
        p = order_min[0]
        q = order_min[1]
        return p, q

    @staticmethod
    def _fit(series, order):
        p, d, q = order
        if d == 0:
            model = ARMA(
                    series, 
                    order=(p, q)
            )
        else:
            model = ARMA(
                    diff(series, d).dropna(), 
                    order=(p, q)
            )
        return model.fit(disp=-1)

    def fit(self):
        # find the order for differentiation
        d = self.diff_stat()
        if d > 0:
            p, q = self.find_order(diff(self.data, d).dropna())
        else:
            p, q = self.find_order(self.data)

        self.arima_order = p, d, q
        # fit the ARMA        
        try:
            return self._fit(self.data, self.arima_order)
        except:
            d += 1
            p, q = self.find_order(diff(self.data, d).dropna())
            self.arima_order = p, d, q
            return self._fit(self.data, self.arima_order)

    # predict
    def pre(self):
        predictions_ARMA_diff = pd.Series(
            self.result_ARMA.fittedvalues, 
            copy=True,
            index=self.data.index
        )
        plt.figure(figsize=(20, 10))
        if self.arima_order[1] > 0:
            predictions_ARMA = cum_sum(predictions_ARMA_diff, self.arima_order[1])
        else:
            predictions_ARMA = predictions_ARMA_diff

        temp = pd.concat(
            [self.data, predictions_ARMA], axis=1
        )
        temp.columns = ['original data', 'fitted data']
        colormaps = {
                'original data':'blue',
                'fitted data':'red'
            }
        for col in temp.columns:
            temp[col].plot(
                style=colormaps.get(col)
            )
        plt.legend(loc=1, fontsize=20)
        title = f'{part} {self.col} ARIMA({self.arima_order[0]}, {self.arima_order[1]}, {self.arima_order[2]})'
        plt.xlabel('Date', fontsize=20)
        plt.ylabel('Duration', fontsize=20)
        plt.title(title, fontsize=20)   
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600)
        return predictions_ARMA

    # test ARCH effect
    def arch_diag(self):
        # ARIMA残差正态检验
        fig = plt.figure(figsize=(20, 10))
        ax1 = plt.subplot(121)
        resid = (self.data - self.predictions_ARMA).dropna()
        resid.hist(ax=ax1, bins=100)  
        resid.plot(ax=ax1, kind='kde')  
        plt.xlabel('Square of residuals', fontsize=20)
        plt.ylabel('Frequency', fontsize=20)
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        ax2 = plt.subplot(122)
        stats.probplot(resid, dist='norm', plot=ax2, fit=True)  # test normality
        plt.xlabel('Theoritical quantitles', fontsize=20)
        plt.ylabel('Real quantitles', fontsize=20)
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        plt.title('Probability Plot', fontsize=20)
        title = f'{part} {self.col}的ARIMA残差正态检验图'
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600)


        #test ARCH effect 
        resid2 = pd.DataFrame(resid.apply(lambda x : x ** 2))  
        resid2.plot(figsize=(20, 10))
        title = f'{part} {self.col} Time Series of Residual squares'
        plt.xlabel('Date', fontsize=20)
        plt.ylabel('Residual squares', fontsize=20)
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        plt.legend([])
        plt.title(title, fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600)

        # LB test
        q, p = acorr_ljungbox(resid2)
        with plt.style.context('ggplot'):
            fig = plt.figure(figsize=(20, 10))
            axes = fig.subplots(1, 2)
            axes[0].plot(q, label='Q')
            axes[0].tick_params(axis='x',labelsize=20)
            axes[0].tick_params(axis='y',labelsize=20)
            axes[0].set_ylabel('Q', fontsize=20)
            axes[0].set_xlabel('Qrder', fontsize=20)
            axes[1].plot(p, label='p')
            axes[1].tick_params(axis='x',labelsize=20)
            axes[1].tick_params(axis='y',labelsize=20)
            axes[1].set_ylabel('P', fontsize=20)
            axes[1].set_xlabel('Qrder', fontsize=20)
            axes[0].legend(fontsize=20)
            axes[1].legend(fontsize=20)
            plt.tight_layout()
            title = f'{part} {self.col}的GARCH检验图'
            file = os.path.join(path, f'{title}.png')
            plt.savefig(file, dpi=600) 

        if max(p) < .05:
            print(f'There exists strong ARCH effect for {self.col}')
        else:
            print(f'There does not exist strong ARCH effect for {self.col}')
        return max(p)
```


```python
# 4类时间的ARIMA分析
arima_dict = {}
for col in num_vars:
    try:
        arima_dict[col] = ARIMA_auto(data.set_index('date')[col], col) 
    except:
        continue
```

    有效时间 cannot be assumed to be normally distributed
    有效时间 is stationary
    There exists strong ARCH effect for 有效时间
    浪费时间 cannot be assumed to be normally distributed
    浪费时间 is stationary
    There does not exist strong ARCH effect for 浪费时间
    必要时间 cannot be assumed to be normally distributed
    必要时间 is stationary
    There exists strong ARCH effect for 必要时间
    手机时间 cannot be assumed to be normally distributed
    手机时间 is stationary
    There exists strong ARCH effect for 手机时间
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_2.png)
    



    <Figure size 1440x720 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_6.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_7.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_8.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_9.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_10.png)
    



    <Figure size 1440x720 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_12.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_13.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_14.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_15.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_16.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_17.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_18.png)
    



    <Figure size 1440x720 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_20.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_21.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_22.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_23.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_24.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_25.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_26.png)
    



    <Figure size 1440x720 with 0 Axes>



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_28.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_29.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_30.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_31.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_158_32.png)
    


### 3.6.2 GARCH分析


```python
part = '3.6.2'

class garch_auto:
    def __init__(self, data, col, order, dist='normal', n=20):
        self.data = data
        self.col = col
        self.arch = self.fit(order, dist=dist)
        self.n = n
        self.arch_pred = self.predict_garch(self.arch, n=self.n)

    def fit(self, order, dist):
        garch = arch_model(
            self.data, 
            mean='AR', 
            lags=order[0], 
            vol='GARCH', 
            p=1, 
            q=1, 
            dist=dist
        ).fit()
        
        self.condition_vol = pd.Series(
            garch.conditional_volatility,
            index=self.data.index
        )
        temp = pd.concat(
            [self.condition_vol, self.data], axis=1
        )
        temp.columns = ['conditional volatility', 'real values']
        print(garch.summary)

        # show the plot
        plt.figure(figsize=(20, 10))
        colormaps = {
                'conditional volatility':'blue',
                'real values':'red'
            }
        for col in temp.columns:
            temp[col].plot(
                style=colormaps.get(col)
            )
        plt.legend(loc=1, fontsize=20)
        title = f'{part} {self.col}波动率分解图'
        plt.xlabel('Date', fontsize=20)
        plt.ylabel('Volatility', fontsize=20)
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        plt.title(title, fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600) 
        return garch

    #predict 
    def predict_garch(self, garch, n=100, ar_p=1):
        params = garch.params.values
        conditional_volatility = garch.conditional_volatility
        garch_ret = []
        bef_ret = np.array(self.data[-(n + ar_p):])  
        a = np.array(params[1:ar_p + 1])  
        w = a[::-1] 
        for i in range(n):  
            fit = params[0] + w.dot(bef_ret[i:ar_p + i])  
            garch_ret.append(fit)

        bef2 = [conditional_volatility.values[-1]]  
        for i in range(n):
            alpha0 = params[ar_p + 1]
            alpha1 = params[ar_p + 2]
            beta1 = params[ar_p + 3]
            new = alpha0 + (alpha1 + beta1) * (bef2[-1])
            bef2 = np.append(bef2, new)
        garch_vol_pre = bef2[-n:]

        # summary the data into one df
        index = pd.date_range(
            start=pd.to_datetime(self.data.index[0]),
            periods=n + len(self.data)
        )
        
        # add NA so that the length matches
        condition_vol = self.condition_vol.to_list() + [np.nan] * n
        real_value = self.data.to_list() + [np.nan] * n
        predicted_volatility = [np.nan] * len(self.data) + garch_vol_pre.tolist()

        # summarize the data
        predict = pd.concat(
            [
                pd.Series(condition_vol),
                pd.Series(real_value),
                pd.Series(predicted_volatility),
            ], axis=1
        )
        predict.index = index
        predict.columns = [
                'conditional volatility', 'real values', 'predicted_volatility'
            ]

        # plot the dataset
        plt.figure(figsize=(20, 10))
        colormaps = {
                'conditional volatility':'blue',
                'real values':'red',
                'predicted_volatility':'green'
            }
        for col in predict.columns:
            predict[col].plot(
                style=colormaps.get(col)
            )
        plt.legend(loc=1, fontsize=20)
        title = f'{part} {self.col}向前{n}步波动率预测图'
        plt.xlabel('Date', fontsize=20)
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        plt.title(title, fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600) 
        return predict
```


```python
# 检验是否存在GARCH效应
arch_p_dict = {
    k: v.arch_p for k, v in arima_dict.items() 
}
print(arch_p_dict)
```

    {'有效时间': 0.0015691728636190092, '浪费时间': 0.05210111562453904, '必要时间': 1.2595570294020931e-05, '手机时间': 6.204653762485581e-06}
    


```python
# 对存在GARCH效应的序列做GARCH建模
garch_dict = {}
garch_pre = {}
for name, p in arch_p_dict.items():
    if p < .05:
        garch_dict[name] = garch_auto(data.set_index('date')[name], name, arima_dict[name].arima_order)
```

    Iteration:      1,   Func. Count:      7,   Neg. LLF: 259299.07432494292
    Iteration:      2,   Func. Count:     18,   Neg. LLF: 2122.1842131736767
    Iteration:      3,   Func. Count:     25,   Neg. LLF: 2148.970499852906
    Iteration:      4,   Func. Count:     33,   Neg. LLF: 2108.0700309590993
    Iteration:      5,   Func. Count:     40,   Neg. LLF: 2099.372220166189
    Iteration:      6,   Func. Count:     46,   Neg. LLF: 2099.371384376879
    Iteration:      7,   Func. Count:     52,   Neg. LLF: 2099.3711133586867
    Iteration:      8,   Func. Count:     58,   Neg. LLF: 2099.3696106823836
    Iteration:      9,   Func. Count:     64,   Neg. LLF: 2099.362397369402
    Iteration:     10,   Func. Count:     70,   Neg. LLF: 2099.334576069179
    Iteration:     11,   Func. Count:     76,   Neg. LLF: 2099.308907149442
    Iteration:     12,   Func. Count:     82,   Neg. LLF: 2099.3088940357065
    Iteration:     13,   Func. Count:     88,   Neg. LLF: 2099.3088908831614
    Iteration:     14,   Func. Count:     94,   Neg. LLF: 2099.308874407825
    Iteration:     15,   Func. Count:    100,   Neg. LLF: 2099.30879649927
    Iteration:     16,   Func. Count:    106,   Neg. LLF: 2099.3086295046473
    Iteration:     17,   Func. Count:    112,   Neg. LLF: 2099.308369268505
    Iteration:     18,   Func. Count:    118,   Neg. LLF: 2099.3070632074323
    Iteration:     19,   Func. Count:    124,   Neg. LLF: 2099.3046920986544
    Iteration:     20,   Func. Count:    130,   Neg. LLF: 2099.2909839153144
    Iteration:     21,   Func. Count:    136,   Neg. LLF: 2099.254294984412
    Iteration:     22,   Func. Count:    142,   Neg. LLF: 2099.211861543838
    Iteration:     23,   Func. Count:    148,   Neg. LLF: 2099.000396290508
    Iteration:     24,   Func. Count:    154,   Neg. LLF: 2098.6503026376595
    Iteration:     25,   Func. Count:    160,   Neg. LLF: 2098.5988610808226
    Iteration:     26,   Func. Count:    166,   Neg. LLF: 2098.596368472826
    Iteration:     27,   Func. Count:    172,   Neg. LLF: 2098.5960015766696
    Iteration:     28,   Func. Count:    178,   Neg. LLF: 2098.5957701456146
    Iteration:     29,   Func. Count:    184,   Neg. LLF: 2098.5957838100508
    Iteration:     30,   Func. Count:    192,   Neg. LLF: 2098.595758259997
    Iteration:     31,   Func. Count:    198,   Neg. LLF: 2098.5957577962927
    Optimization terminated successfully    (Exit mode 0)
                Current function value: 2098.5957573195965
                Iterations: 31
                Function evaluations: 199
                Gradient evaluations: 31
    <bound method ARCHModelResult.summary of                            AR - GARCH Model Results                           
    ==============================================================================
    Dep. Variable:                   有效时间   R-squared:                       0.385
    Mean Model:                        AR   Adj. R-squared:                  0.384
    Vol Model:                      GARCH   Log-Likelihood:               -2098.60
    Distribution:                  Normal   AIC:                           4207.19
    Method:            Maximum Likelihood   BIC:                           4226.66
                                            No. Observations:                  363
    Date:                Fri, Dec 31 2021   Df Residuals:                      361
    Time:                        00:22:18   Df Model:                            2
                                     Mean Model                                 
    ============================================================================
                     coef    std err          t      P>|t|      95.0% Conf. Int.
    ----------------------------------------------------------------------------
    Const        163.6982     23.403      6.995  2.655e-12 [1.178e+02,2.096e+02]
    有效时间[1]        0.6616  4.662e-02     14.192  1.025e-45     [  0.570,  0.753]
                                  Volatility Model                              
    ============================================================================
                     coef    std err          t      P>|t|      95.0% Conf. Int.
    ----------------------------------------------------------------------------
    omega       3069.8984   1226.242      2.504  1.230e-02 [6.665e+02,5.473e+03]
    alpha[1]       0.3259      0.128      2.549  1.081e-02   [7.532e-02,  0.577]
    beta[1]        0.2344      0.200      1.171      0.242     [ -0.158,  0.627]
    ============================================================================
    
    Covariance estimator: robust
    ARCHModelResult, id: 0x26a4520d6a0>
    Iteration:      1,   Func. Count:      8,   Neg. LLF: 62320.66632589102
    Iteration:      2,   Func. Count:     20,   Neg. LLF: 4559.907876257534
    Iteration:      3,   Func. Count:     29,   Neg. LLF: 2123.5938685506753
    Iteration:      4,   Func. Count:     37,   Neg. LLF: 2150.9471788430747
    Iteration:      5,   Func. Count:     46,   Neg. LLF: 2078.5390809931146
    Iteration:      6,   Func. Count:     53,   Neg. LLF: 2078.5290947472986
    Iteration:      7,   Func. Count:     60,   Neg. LLF: 2078.5263836664008
    Iteration:      8,   Func. Count:     67,   Neg. LLF: 2078.5246315831423
    Iteration:      9,   Func. Count:     74,   Neg. LLF: 2078.5137674811353
    Iteration:     10,   Func. Count:     81,   Neg. LLF: 2078.4938102850765
    Iteration:     11,   Func. Count:     88,   Neg. LLF: 2078.464621720056
    Iteration:     12,   Func. Count:     95,   Neg. LLF: 2078.44197381132
    Iteration:     13,   Func. Count:    102,   Neg. LLF: 2078.4359710610115
    Iteration:     14,   Func. Count:    109,   Neg. LLF: 2078.435286299403
    Iteration:     15,   Func. Count:    116,   Neg. LLF: 2078.435258011945
    Iteration:     16,   Func. Count:    123,   Neg. LLF: 2078.435248981171
    Iteration:     17,   Func. Count:    130,   Neg. LLF: 2078.435202107898
    Iteration:     18,   Func. Count:    137,   Neg. LLF: 2078.435117185267
    Iteration:     19,   Func. Count:    144,   Neg. LLF: 2078.434719661538
    Iteration:     20,   Func. Count:    151,   Neg. LLF: 2078.4340565499488
    Iteration:     21,   Func. Count:    158,   Neg. LLF: 2078.430412198938
    Iteration:     22,   Func. Count:    165,   Neg. LLF: 2078.4234551314808
    Iteration:     23,   Func. Count:    172,   Neg. LLF: 2078.393601146274
    Iteration:     24,   Func. Count:    179,   Neg. LLF: 2078.348086556013
    Iteration:     25,   Func. Count:    186,   Neg. LLF: 2078.1438191969182
    Iteration:     26,   Func. Count:    193,   Neg. LLF: 2077.904572362542
    Iteration:     27,   Func. Count:    200,   Neg. LLF: 2077.608031685726
    Iteration:     28,   Func. Count:    207,   Neg. LLF: 2077.451866246465
    Iteration:     29,   Func. Count:    214,   Neg. LLF: 2077.423344329933
    Iteration:     30,   Func. Count:    221,   Neg. LLF: 2077.422395767743
    Iteration:     31,   Func. Count:    228,   Neg. LLF: 2077.4223390244865
    Iteration:     32,   Func. Count:    235,   Neg. LLF: 2077.4223302422206
    Iteration:     33,   Func. Count:    242,   Neg. LLF: 2077.4223655292453
    Optimization terminated successfully    (Exit mode 0)
                Current function value: 2077.422330242952
                Iterations: 33
                Function evaluations: 252
                Gradient evaluations: 33
    <bound method ARCHModelResult.summary of                            AR - GARCH Model Results                           
    ==============================================================================
    Dep. Variable:                   必要时间   R-squared:                       0.415
    Mean Model:                        AR   Adj. R-squared:                  0.411
    Vol Model:                      GARCH   Log-Likelihood:               -2077.42
    Distribution:                  Normal   AIC:                           4166.84
    Method:            Maximum Likelihood   BIC:                           4190.19
                                            No. Observations:                  362
    Date:                Fri, Dec 31 2021   Df Residuals:                      359
    Time:                        00:22:23   Df Model:                            3
                                    Mean Model                                
    ==========================================================================
                     coef    std err          t      P>|t|    95.0% Conf. Int.
    --------------------------------------------------------------------------
    Const         99.5952     14.747      6.754  1.443e-11 [ 70.691,1.285e+02]
    必要时间[1]        0.6401  6.769e-02      9.457  3.184e-21   [  0.507,  0.773]
    必要时间[2]       -0.0168  6.773e-02     -0.249      0.804   [ -0.150,  0.116]
                                  Volatility Model                              
    ============================================================================
                     coef    std err          t      P>|t|      95.0% Conf. Int.
    ----------------------------------------------------------------------------
    omega       1226.8051    335.331      3.658  2.537e-04 [5.696e+02,1.884e+03]
    alpha[1]       0.3025  9.288e-02      3.257  1.126e-03     [  0.120,  0.485]
    beta[1]        0.5233  7.420e-02      7.052  1.758e-12     [  0.378,  0.669]
    ============================================================================
    
    Covariance estimator: robust
    ARCHModelResult, id: 0x26a47fbaef0>
    Iteration:      1,   Func. Count:      9,   Neg. LLF: 101169.83279638311
    Iteration:      2,   Func. Count:     22,   Neg. LLF: 9934.768402156049
    Iteration:      3,   Func. Count:     33,   Neg. LLF: 1952.8783269778314
    Iteration:      4,   Func. Count:     43,   Neg. LLF: 1292.402461337734
    Iteration:      5,   Func. Count:     52,   Neg. LLF: 1302.707415648918
    Iteration:      6,   Func. Count:     61,   Neg. LLF: 1273.2908717302503
    Iteration:      7,   Func. Count:     70,   Neg. LLF: 1270.2623436581057
    Iteration:      8,   Func. Count:     78,   Neg. LLF: 1269.7733463812278
    Iteration:      9,   Func. Count:     86,   Neg. LLF: 1269.715984834263
    Iteration:     10,   Func. Count:     94,   Neg. LLF: 1269.44248254428
    Iteration:     11,   Func. Count:    102,   Neg. LLF: 1269.229570514795
    Iteration:     12,   Func. Count:    110,   Neg. LLF: 1269.1456413965502
    Iteration:     13,   Func. Count:    118,   Neg. LLF: 1269.1318012902386
    Iteration:     14,   Func. Count:    126,   Neg. LLF: 1269.1294951942891
    Iteration:     15,   Func. Count:    134,   Neg. LLF: 1269.1291375794663
    Iteration:     16,   Func. Count:    142,   Neg. LLF: 1269.1291260511052
    Iteration:     17,   Func. Count:    149,   Neg. LLF: 1269.129126051128
    Optimization terminated successfully    (Exit mode 0)
                Current function value: 1269.1291260511052
                Iterations: 17
                Function evaluations: 149
                Gradient evaluations: 17
    <bound method ARCHModelResult.summary of                            AR - GARCH Model Results                           
    ==============================================================================
    Dep. Variable:                   手机时间   R-squared:                       0.495
    Mean Model:                        AR   Adj. R-squared:                  0.491
    Vol Model:                      GARCH   Log-Likelihood:               -1269.13
    Distribution:                  Normal   AIC:                           2552.26
    Method:            Maximum Likelihood   BIC:                           2579.48
                                            No. Observations:                  361
    Date:                Fri, Dec 31 2021   Df Residuals:                      357
    Time:                        00:22:29   Df Model:                            4
                                     Mean Model                                
    ===========================================================================
                     coef    std err          t      P>|t|     95.0% Conf. Int.
    ---------------------------------------------------------------------------
    Const          8.2871      1.869      4.433  9.289e-06    [  4.623, 11.951]
    手机时间[1]        0.8079  9.124e-02      8.854  8.461e-19    [  0.629,  0.987]
    手机时间[2]       -0.1939  7.284e-02     -2.661  7.784e-03 [ -0.337,-5.109e-02]
    手机时间[3]        0.1199  4.441e-02      2.699  6.951e-03  [3.283e-02,  0.207]
                                Volatility Model                            
    ========================================================================
                     coef    std err          t      P>|t|  95.0% Conf. Int.
    ------------------------------------------------------------------------
    omega         30.6658      9.722      3.154  1.609e-03 [ 11.611, 49.721]
    alpha[1]       0.5492      0.131      4.182  2.884e-05 [  0.292,  0.807]
    beta[1]        0.1211      0.157      0.771      0.441 [ -0.187,  0.429]
    ========================================================================
    
    Covariance estimator: robust
    ARCHModelResult, id: 0x26a42041eb8>
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_162_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_162_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_162_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_162_4.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_162_5.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_162_6.png)
    


### 3.6.3 VAR分析


```python
part = '3.6.3'

class VAR:
    def __init__(self, df, arima_dict):
        self.df = df.astype(float)
        self.cols = ','.join(list(self.df.columns))
        self.arima_dic = arima_dict
        self.model, self.model_res = self.fit()

    def fit(self):
        cols = self.df.columns
        varLagNum = [self.arima_dic.get(col).arima_order[0] for col in cols]
        orgMod = sm.tsa.VARMAX(self.df, order=varLagNum,trend='c',exog=None)
        fitMod = orgMod.fit(maxiter=200,disp=True)
        print(fitMod.summary())
        resid = fitMod.resid
        result = {'fitMod':fitMod,'resid':resid}
        return fitMod, result

    def Test_Cusum(self):
        result = statsmodels.stats.diagnostic.\
            breaks_cusumolsresid(self.model_res.get('resid'))
        if result[1] > .05:
            print('There is no drifting')
        else:
            print('There is drifting')
        return result

    def impulse_responses(self):
        title = f'{part} {self.cols} VAR模型的脉冲响应分析'
        ax = self.model.impulse_responses(20, orthogonalized=True).\
            plot(figsize=(20, 10))
        plt.xlabel('Prediction length', fontsize=20)
        plt.ylabel('Sum of duration', fontsize=20)
        plt.xticks(fontsize=20)
        plt.yticks(fontsize=20)
        plt.title(title, fontsize=20)
        plt.legend(loc=1, fontsize=20)
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600) 


    def variance_decompositon(self):
        md = sm.tsa.VAR(self.df.values)
        re = md.fit(2)
        fevd = re.fevd(10)
        print(fevd.summary())
        fevd.plot(figsize=(20, 10))
        plt.legend(list(self.df.columns), fontsize=20)
        title = f'{part} {self.cols} VAR模型的方差分解'
        file = os.path.join(path, f'{title}.png')
        plt.savefig(file, dpi=600) 
```


```python
price_vol_int_var = VAR(data[list(arima_dict.keys())], arima_dict)
price_vol_int_var.impulse_responses()
price_vol_int_var.variance_decompositon()
```

                                      Statespace Model Results                                  
    ============================================================================================
    Dep. Variable:     ['有效时间', '浪费时间', '必要时间', '手机时间']   No. Observations:                  364
    Model:                                   VARMA(1,3)   Log Likelihood               -7156.298
                                            + intercept   AIC                          14468.596
    Date:                              Fri, 31 Dec 2021   BIC                          14772.574
    Time:                                      00:27:31   HQIC                         14589.413
    Sample:                                           0                                         
                                                  - 364                                         
    Covariance Type:                                opg                                         
    ================================================================================================
    Ljung-Box (L1) (Q):     0.00, 0.00, 0.00, 0.02   Jarque-Bera (JB):   29.32, 1.55, 2417.39, 26.50
    Prob(Q):                0.99, 0.98, 0.96, 0.88   Prob(JB):                0.00, 0.46, 0.00, 0.00
    Heteroskedasticity (H): 1.01, 1.16, 1.21, 0.65   Skew:                 -0.39, -0.03, -1.98, 0.43
    Prob(H) (two-sided):    0.97, 0.42, 0.29, 0.02   Kurtosis:               4.15, 3.31, 14.99, 4.00
                              Results for equation 有效时间                           
    ==============================================================================
                     coef    std err          z      P>|z|      [0.025      0.975]
    ------------------------------------------------------------------------------
    intercept    261.3774    620.855      0.421      0.674    -955.477    1478.231
    L1.有效时间        0.6079      0.530      1.147      0.252      -0.431       1.647
    L1.浪费时间       -0.2831      1.361     -0.208      0.835      -2.950       2.384
    L1.必要时间       -0.2848      0.761     -0.374      0.708      -1.777       1.207
    L1.手机时间        1.0417      1.668      0.624      0.532      -2.228       4.312
    L1.e(有效时间)    -0.1457      0.550     -0.265      0.791      -1.223       0.931
    L1.e(浪费时间)     0.1333      1.405      0.095      0.924      -2.620       2.887
    L1.e(必要时间)     0.1701      0.776      0.219      0.826      -1.350       1.690
    L1.e(手机时间)    -1.3665      1.835     -0.745      0.456      -4.962       2.229
    L2.e(有效时间)    -0.0700      0.275     -0.254      0.799      -0.609       0.469
    L2.e(浪费时间)     0.2713      0.531      0.511      0.609      -0.769       1.312
    L2.e(必要时间)     0.2171      0.397      0.546      0.585      -0.562       0.996
    L2.e(手机时间)    -0.7720      1.624     -0.475      0.635      -3.955       2.411
    L3.e(有效时间)     0.0397      0.119      0.334      0.738      -0.193       0.273
    L3.e(浪费时间)     0.0039      0.226      0.017      0.986      -0.439       0.446
    L3.e(必要时间)     0.1481      0.134      1.102      0.270      -0.115       0.411
    L3.e(手机时间)    -0.1401      1.156     -0.121      0.904      -2.406       2.126
                              Results for equation 浪费时间                           
    ==============================================================================
                     coef    std err          z      P>|z|      [0.025      0.975]
    ------------------------------------------------------------------------------
    intercept     70.7759    219.579      0.322      0.747    -359.590     501.142
    L1.有效时间        0.0134      0.199      0.067      0.946      -0.377       0.404
    L1.浪费时间        0.5339      0.469      1.138      0.255      -0.386       1.453
    L1.必要时间       -0.0630      0.271     -0.232      0.816      -0.594       0.468
    L1.手机时间       -0.2840      0.620     -0.458      0.647      -1.499       0.932
    L1.e(有效时间)     0.0249      0.213      0.117      0.907      -0.392       0.442
    L1.e(浪费时间)    -0.1737      0.479     -0.362      0.717      -1.113       0.765
    L1.e(必要时间)     0.0944      0.277      0.341      0.733      -0.448       0.637
    L1.e(手机时间)     0.3943      0.687      0.574      0.566      -0.952       1.741
    L2.e(有效时间)    -0.0393      0.100     -0.393      0.694      -0.235       0.157
    L2.e(浪费时间)    -0.0467      0.173     -0.270      0.787      -0.386       0.293
    L2.e(必要时间)    -0.0267      0.142     -0.188      0.851      -0.304       0.251
    L2.e(手机时间)    -0.2382      0.596     -0.400      0.690      -1.407       0.930
    L3.e(有效时间)    -0.0018      0.056     -0.031      0.975      -0.112       0.109
    L3.e(浪费时间)     0.1168      0.091      1.285      0.199      -0.061       0.295
    L3.e(必要时间)    -0.0107      0.058     -0.185      0.853      -0.125       0.103
    L3.e(手机时间)     0.1922      0.403      0.477      0.634      -0.598       0.983
                              Results for equation 必要时间                           
    ==============================================================================
                     coef    std err          z      P>|z|      [0.025      0.975]
    ------------------------------------------------------------------------------
    intercept    192.2662    497.479      0.386      0.699    -782.774    1167.307
    L1.有效时间       -0.1072      0.466     -0.230      0.818      -1.021       0.807
    L1.浪费时间       -0.3422      1.050     -0.326      0.745      -2.401       1.716
    L1.必要时间        0.7008      0.601      1.166      0.244      -0.478       1.879
    L1.手机时间       -0.6609      1.203     -0.549      0.583      -3.019       1.697
    L1.e(有效时间)     0.0185      0.484      0.038      0.970      -0.930       0.967
    L1.e(浪费时间)     0.4263      1.096      0.389      0.697      -1.722       2.575
    L1.e(必要时间)    -0.1917      0.612     -0.313      0.754      -1.392       1.008
    L1.e(手机时间)     1.0779      1.303      0.827      0.408      -1.476       3.632
    L2.e(有效时间)    -0.0666      0.236     -0.282      0.778      -0.529       0.396
    L2.e(浪费时间)    -0.1243      0.425     -0.293      0.770      -0.957       0.708
    L2.e(必要时间)    -0.2106      0.314     -0.670      0.503      -0.826       0.405
    L2.e(手机时间)     1.0923      1.296      0.843      0.399      -1.448       3.632
    L3.e(有效时间)    -0.0859      0.127     -0.675      0.500      -0.335       0.163
    L3.e(浪费时间)    -0.0476      0.189     -0.252      0.801      -0.417       0.322
    L3.e(必要时间)    -0.1283      0.127     -1.013      0.311      -0.377       0.120
    L3.e(手机时间)    -0.4324      0.899     -0.481      0.631      -2.195       1.330
                              Results for equation 手机时间                           
    ==============================================================================
                     coef    std err          z      P>|z|      [0.025      0.975]
    ------------------------------------------------------------------------------
    intercept     15.5228     59.957      0.259      0.796    -101.990     133.036
    L1.有效时间       -0.0170      0.055     -0.310      0.756      -0.125       0.091
    L1.浪费时间        0.0275      0.125      0.220      0.826      -0.217       0.272
    L1.必要时间       -0.0197      0.074     -0.266      0.790      -0.165       0.126
    L1.手机时间        0.8485      0.128      6.625      0.000       0.597       1.100
    L1.e(有效时间)     0.0186      0.057      0.327      0.744      -0.093       0.130
    L1.e(浪费时间)    -0.0438      0.127     -0.344      0.731      -0.294       0.206
    L1.e(必要时间)     0.0215      0.077      0.279      0.781      -0.130       0.173
    L1.e(手机时间)    -0.1579      0.142     -1.110      0.267      -0.437       0.121
    L2.e(有效时间)    -0.0024      0.028     -0.084      0.933      -0.057       0.052
    L2.e(浪费时间)    -0.0299      0.049     -0.612      0.541      -0.126       0.066
    L2.e(必要时间)    -0.0131      0.039     -0.336      0.737      -0.089       0.063
    L2.e(手机时间)    -0.1656      0.132     -1.254      0.210      -0.424       0.093
    L3.e(有效时间)     0.0006      0.021      0.026      0.979      -0.040       0.041
    L3.e(浪费时间)    -0.0179      0.027     -0.659      0.510      -0.071       0.035
    L3.e(必要时间)    -0.0057      0.021     -0.276      0.783      -0.046       0.035
    L3.e(手机时间)    -0.0614      0.104     -0.593      0.553      -0.264       0.142
                                   Error covariance matrix                                
    ======================================================================================
                             coef    std err          z      P>|z|      [0.025      0.975]
    --------------------------------------------------------------------------------------
    sqrt.var.有效时间         81.9851      5.189     15.799      0.000      71.815      92.156
    sqrt.cov.有效时间.浪费时间    -3.1712      2.763     -1.148      0.251      -8.587       2.245
    sqrt.var.浪费时间         36.3364      1.684     21.580      0.000      33.036      39.637
    sqrt.cov.有效时间.必要时间   -53.0860      4.710    -11.271      0.000     -62.317     -43.855
    sqrt.cov.浪费时间.必要时间   -28.6460      4.702     -6.093      0.000     -37.861     -19.431
    sqrt.var.必要时间         51.4018      2.945     17.454      0.000      45.630      57.174
    sqrt.cov.有效时间.手机时间    -1.2554      0.702     -1.789      0.074      -2.631       0.120
    sqrt.cov.浪费时间.手机时间    -0.8640      0.577     -1.498      0.134      -1.994       0.266
    sqrt.cov.必要时间.手机时间     0.8607      0.922      0.933      0.351      -0.946       2.668
    sqrt.var.手机时间          8.3504      0.316     26.432      0.000       7.731       8.970
    ======================================================================================
    
    Warnings:
    [1] Covariance matrix calculated using the outer product of gradients (complex-step).
    FEVD for y1
               y1        y2        y3        y4
    0    1.000000  0.000000  0.000000  0.000000
    1    0.991137  0.000148  0.005814  0.002902
    2    0.987368  0.000145  0.008718  0.003769
    3    0.982489  0.000214  0.009284  0.008012
    4    0.977202  0.000299  0.009648  0.012852
    5    0.972754  0.000381  0.010063  0.016802
    6    0.969503  0.000439  0.010469  0.019589
    7    0.967312  0.000473  0.010798  0.021416
    8    0.965902  0.000492  0.011038  0.022567
    9    0.965016  0.000502  0.011202  0.023280
    
    FEVD for y2
               y1        y2        y3        y4
    0    0.005234  0.994766  0.000000  0.000000
    1    0.005180  0.991934  0.000864  0.002022
    2    0.006871  0.982011  0.003374  0.007743
    3    0.009058  0.970310  0.005918  0.014715
    4    0.010527  0.962352  0.006600  0.020521
    5    0.011261  0.957989  0.006638  0.024113
    6    0.011494  0.955798  0.006617  0.026092
    7    0.011526  0.954749  0.006625  0.027099
    8    0.011519  0.954238  0.006648  0.027595
    9    0.011523  0.953970  0.006670  0.027837
    
    FEVD for y3
               y1        y2        y3        y4
    0    0.450906  0.127513  0.421580  0.000000
    1    0.490187  0.110999  0.396416  0.002398
    2    0.524730  0.108931  0.363526  0.002814
    3    0.544765  0.106504  0.346064  0.002667
    4    0.554515  0.104949  0.337843  0.002693
    5    0.559013  0.103972  0.334012  0.003003
    6    0.561023  0.103390  0.332136  0.003451
    7    0.561905  0.103045  0.331159  0.003891
    8    0.562288  0.102839  0.330620  0.004253
    9    0.562455  0.102715  0.330310  0.004520
    
    FEVD for y4
               y1        y2        y3        y4
    0    0.016426  0.010573  0.007725  0.965276
    1    0.013580  0.020721  0.007308  0.958391
    2    0.012869  0.023735  0.010583  0.952812
    3    0.016901  0.024630  0.018113  0.940356
    4    0.023745  0.024511  0.023510  0.928234
    5    0.030878  0.024216  0.026443  0.918464
    6    0.036771  0.023960  0.027961  0.911308
    7    0.041053  0.023780  0.028761  0.906406
    8    0.043948  0.023660  0.029200  0.903191
    9    0.045833  0.023584  0.029450  0.901133
    
    
    None
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_165_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_165_2.png)
    


## 3.7 关于日期的NeuralProphet 时间序列


```python
part = '3.7'

NP_dict = {}
for col in num_vars:
    nprophet_model = NeuralProphet()
    test_length = 30
    temp = data.rename(columns={'date':'ds', col: 'y'})
    metrics = nprophet_model.fit(temp[['ds', 'y']], freq="D")
    future_df = nprophet_model.make_future_dataframe(
        temp[['ds', 'y']], 
        periods = test_length, 
        n_historic_predictions=len(temp[['ds', 'y']])
    )
    preds_df_2 = nprophet_model.predict(future_df)
    title = f'{part} {col}的NeuralProphet时间序列预测图'
    nprophet_model.plot(
        preds_df_2, 
        ylabel=col, 
        figsize=(20, 10),
    );
    plt.xlabel('Date', fontsize=20)
    plt.ylabel(col, fontsize=20)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.title(title, fontsize=20)
    file = os.path.join(path, f'{title}.png')
    plt.savefig(file, dpi=600) 
    NP_dict[col] = nprophet_model, preds_df_2
```

    INFO: nprophet.utils - set_auto_seasonalities: Disabling yearly seasonality. Run NeuralProphet with yearly_seasonality=True to override this.
    INFO: nprophet.utils - set_auto_seasonalities: Disabling daily seasonality. Run NeuralProphet with daily_seasonality=True to override this.
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set batch_size to 8
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set epochs to 87
    100%|██████████| 100/100 [00:00<00:00, 1345.32it/s]
    INFO: nprophet - _lr_range_test: learning rate range test found optimal lr: 6.58E-01
    Epoch[87/87]: 100%|██████████| 87/87 [00:03<00:00, 28.52it/s, SmoothL1Loss=0.0107, MAE=71.7, RegLoss=0]
    INFO: nprophet.utils - set_auto_seasonalities: Disabling yearly seasonality. Run NeuralProphet with yearly_seasonality=True to override this.
    INFO: nprophet.utils - set_auto_seasonalities: Disabling daily seasonality. Run NeuralProphet with daily_seasonality=True to override this.
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set batch_size to 8
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set epochs to 87
     96%|█████████▌| 96/100 [00:00<00:00, 1411.45it/s]
    INFO: nprophet - _lr_range_test: learning rate range test found optimal lr: 5.34E-01
    Epoch[87/87]: 100%|██████████| 87/87 [00:03<00:00, 28.79it/s, SmoothL1Loss=0.0226, MAE=29.7, RegLoss=0]
    INFO: nprophet.utils - set_auto_seasonalities: Disabling yearly seasonality. Run NeuralProphet with yearly_seasonality=True to override this.
    INFO: nprophet.utils - set_auto_seasonalities: Disabling daily seasonality. Run NeuralProphet with daily_seasonality=True to override this.
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set batch_size to 8
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set epochs to 87
     92%|█████████▏| 92/100 [00:00<00:00, 1381.32it/s]
    INFO: nprophet - _lr_range_test: learning rate range test found optimal lr: 5.34E-01
    Epoch[87/87]: 100%|██████████| 87/87 [00:03<00:00, 28.56it/s, SmoothL1Loss=0.0249, MAE=73.3, RegLoss=0]
    INFO: nprophet.utils - set_auto_seasonalities: Disabling yearly seasonality. Run NeuralProphet with yearly_seasonality=True to override this.
    INFO: nprophet.utils - set_auto_seasonalities: Disabling daily seasonality. Run NeuralProphet with daily_seasonality=True to override this.
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set batch_size to 8
    INFO: nprophet.config - set_auto_batch_epoch: Auto-set epochs to 87
     97%|█████████▋| 97/100 [00:00<00:00, 1426.16it/s]
    INFO: nprophet - _lr_range_test: learning rate range test found optimal lr: 1.00E+00
    Epoch[87/87]: 100%|██████████| 87/87 [00:03<00:00, 28.73it/s, SmoothL1Loss=0.0255, MAE=7.47, RegLoss=0]
    


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_167_1.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_167_2.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_167_3.png)
    



    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_167_4.png)
    


# 4.数据挖掘

## 4.1 通过生成聚合特征做日度时长数据的特征工程


```python
nums = [
    '浪费时间', '必要时间', '手机时间'
]

cates = [
    'month', 'day', 'weekday'
]

y = '有效时间'
```


```python
# 基于A/B的统计特征
for num_var in tqdm(nums):
    for cate_var in cates:
        for sts in ['mean', 'median', 'std', 'max', 'min']:
            data[f'{cate_var}_{num_var}_{sts}'] = data.groupby(cate_var)[num_var].\
                transform(sts).values
        data[f'{cate_var}_{num_var}_cv'] = data[f'{cate_var}_{num_var}_std'] / \
            data[f'{cate_var}_{num_var}_mean']
```

    100%|██████████| 3/3 [00:00<00:00, 88.22it/s]
    


```python
# 流量平滑特征
# 基于A/B的统计特征
for num_var in tqdm(nums):
    for cate_var in cates:
        data[f'{num_var}_div_{cate_var}_{num_var}_mean'] = data[num_var] / \
            (data[f'{cate_var}_{num_var}_mean'] + 1e-5)
        data[f'{num_var}_div_{cate_var}_{num_var}_median'] = data[num_var] / \
            (data[f'{cate_var}_{num_var}_median'] + 1e-5)
        # 黄金组合特征
        data[f'{num_var}_minus_{cate_var}_{num_var}_mean'] = data[num_var] - \
            data[f'{cate_var}_{num_var}_mean']        
```

    100%|██████████| 3/3 [00:00<00:00, 299.94it/s]
    


```python
# 相邻有序类别统计特征的变化
sts_list = ['max', 'min', 'mean', 'std', 'median']
for num_var in tqdm(nums):
    for cate_var in cates:
        for sts in sts_list:
            data[f'{cate_var}_{num_var}_{sts}_diff']  = data[f'{cate_var}_{num_var}_{sts}'] - \
                data.groupby(cate_var)[f'{cate_var}_{num_var}_{sts}'].shift()        
            data[f'{cate_var}_{num_var}_{sts}_ratio'] = data[f'{cate_var}_{num_var}_{sts}'] / \
                data.groupby(cate_var)[f'{cate_var}_{num_var}_{sts}'].shift() 
            data[f'{cate_var}_{num_var}_{sts}_diff'].fillna(method='bfill', inplace=True)
            data[f'{cate_var}_{num_var}_{sts}_ratio'].fillna(method='bfill', inplace=True)
```

    100%|██████████| 3/3 [00:00<00:00, 42.85it/s]
    

## 4.2 类别变量的one-hot encoding


```python
for cate_var in cates:
    onehot = pd.get_dummies(data[cate_var], drop_first=True, prefix=cate_var + '_')
    data = pd.concat([data.drop(cate_var, axis=1), onehot], axis=1)

data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>有效时间</th>
      <th>浪费时间</th>
      <th>必要时间</th>
      <th>手机时间</th>
      <th>week_order</th>
      <th>month_浪费时间_mean</th>
      <th>month_浪费时间_median</th>
      <th>month_浪费时间_std</th>
      <th>month_浪费时间_max</th>
      <th>...</th>
      <th>day__28</th>
      <th>day__29</th>
      <th>day__30</th>
      <th>day__31</th>
      <th>weekday__2</th>
      <th>weekday__3</th>
      <th>weekday__4</th>
      <th>weekday__5</th>
      <th>weekday__6</th>
      <th>weekday__7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-01-01</td>
      <td>507.0</td>
      <td>193.0</td>
      <td>178.0</td>
      <td>33.0</td>
      <td>2020-12-28/2021-01-03</td>
      <td>107.754481</td>
      <td>96.0</td>
      <td>45.756487</td>
      <td>193.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-01-02</td>
      <td>507.0</td>
      <td>193.0</td>
      <td>178.0</td>
      <td>33.0</td>
      <td>2020-12-28/2021-01-03</td>
      <td>107.754481</td>
      <td>96.0</td>
      <td>45.756487</td>
      <td>193.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-01-03</td>
      <td>507.0</td>
      <td>193.0</td>
      <td>178.0</td>
      <td>33.0</td>
      <td>2020-12-28/2021-01-03</td>
      <td>107.754481</td>
      <td>96.0</td>
      <td>45.756487</td>
      <td>193.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-01-04</td>
      <td>393.0</td>
      <td>140.0</td>
      <td>337.0</td>
      <td>24.0</td>
      <td>2021-01-04/2021-01-10</td>
      <td>107.754481</td>
      <td>96.0</td>
      <td>45.756487</td>
      <td>193.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-01-05</td>
      <td>472.0</td>
      <td>96.0</td>
      <td>294.0</td>
      <td>39.0</td>
      <td>2021-01-04/2021-01-10</td>
      <td>107.754481</td>
      <td>96.0</td>
      <td>45.756487</td>
      <td>193.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>359</th>
      <td>2021-12-26</td>
      <td>356.0</td>
      <td>87.0</td>
      <td>428.0</td>
      <td>25.0</td>
      <td>2021-12-20/2021-12-26</td>
      <td>115.570441</td>
      <td>122.5</td>
      <td>38.564538</td>
      <td>204.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>360</th>
      <td>2021-12-27</td>
      <td>456.0</td>
      <td>123.0</td>
      <td>286.0</td>
      <td>19.0</td>
      <td>2021-12-27/2022-01-02</td>
      <td>115.570441</td>
      <td>122.5</td>
      <td>38.564538</td>
      <td>204.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>361</th>
      <td>2021-12-28</td>
      <td>541.0</td>
      <td>153.0</td>
      <td>201.0</td>
      <td>34.0</td>
      <td>2021-12-27/2022-01-02</td>
      <td>115.570441</td>
      <td>122.5</td>
      <td>38.564538</td>
      <td>204.0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>362</th>
      <td>2021-12-29</td>
      <td>481.0</td>
      <td>143.0</td>
      <td>242.0</td>
      <td>28.0</td>
      <td>2021-12-27/2022-01-02</td>
      <td>115.570441</td>
      <td>122.5</td>
      <td>38.564538</td>
      <td>204.0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>363</th>
      <td>2021-12-30</td>
      <td>545.0</td>
      <td>144.0</td>
      <td>184.0</td>
      <td>39.0</td>
      <td>2021-12-27/2022-01-02</td>
      <td>115.570441</td>
      <td>122.5</td>
      <td>38.564538</td>
      <td>204.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>364 rows × 224 columns</p>
</div>



## 4.3 利用boruta筛选特征


```python
# 划分数据集
train, test = train_test_split(data, test_size=.2)
X = train.drop(['date', 'week_order', y], axis=1)
Y = train[y]
```


```python
clf = XGBRegressor()
boruta = BorutaPy(
   estimator = clf, 
   n_estimators = 'auto',
   max_iter = 100 # number of trials to perform
)

# 模型训练
boruta.fit(np.array(X), np.array(Y))   
# 输出结果
green_area = X.columns[boruta.support_].to_list()
blue_area  = X.columns[boruta.support_weak_].to_list()
print('features in the green area:', green_area)
print('features in the blue area:', blue_area)
cols = green_area + blue_area
train = train[cols]
```

    features in the green area: ['必要时间', 'month_必要时间_mean', '浪费时间_minus_month_浪费时间_mean', '浪费时间_div_weekday_浪费时间_median', '浪费时间_minus_weekday_浪费时间_mean', '必要时间_div_weekday_必要时间_mean', '必要时间_div_weekday_必要时间_median', '必要时间_minus_weekday_必要时间_mean', 'day__23']
    features in the blue area: ['浪费时间_div_month_浪费时间_median', '必要时间_div_month_必要时间_mean', '必要时间_div_day_必要时间_median']
    

## 4.4 利用PCA降维


```python
dt = data[cols]
pca = PCA(n_components=0.9)
dt = pd.DataFrame(pca.fit_transform(StandardScaler().fit_transform(dt)))
dt
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-4.175109</td>
      <td>3.245598</td>
      <td>0.114472</td>
      <td>-0.317084</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-4.092849</td>
      <td>2.804508</td>
      <td>0.163216</td>
      <td>-0.410487</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-4.290725</td>
      <td>3.108437</td>
      <td>0.115717</td>
      <td>-0.337178</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.324721</td>
      <td>2.253641</td>
      <td>-0.351841</td>
      <td>0.285948</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.354614</td>
      <td>-0.205698</td>
      <td>-0.088636</td>
      <td>-0.185837</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>359</th>
      <td>3.437312</td>
      <td>0.632171</td>
      <td>1.123133</td>
      <td>-1.525288</td>
    </tr>
    <tr>
      <th>360</th>
      <td>-0.062250</td>
      <td>0.881814</td>
      <td>1.442080</td>
      <td>-1.946709</td>
    </tr>
    <tr>
      <th>361</th>
      <td>-2.571995</td>
      <td>1.416339</td>
      <td>1.562749</td>
      <td>-2.126608</td>
    </tr>
    <tr>
      <th>362</th>
      <td>-1.198541</td>
      <td>1.456460</td>
      <td>1.517209</td>
      <td>-2.015115</td>
    </tr>
    <tr>
      <th>363</th>
      <td>-2.511375</td>
      <td>0.935755</td>
      <td>1.638123</td>
      <td>-2.242519</td>
    </tr>
  </tbody>
</table>
<p>364 rows × 4 columns</p>
</div>




```python
X_train = dt.loc[train.index, :]
X_test = dt.loc[test.index, :]
y_train = data.loc[train.index, y]
y_test = data.loc[test.index, y]
```

## 4.5 利用optuna优化参数


```python
sampler = TPESampler(seed=10) # for reproducibility

def objective(trial):
    dtrain = lgb.Dataset(X_train, label=y_train)
    
    param = {
        'objective': 'regression_l2',
        'metric': 'mse',
        'verbosity': -1,
        'boosting_type': 'gbdt',
        'lambda_l1': trial.suggest_loguniform('lambda_l1', 1e-8, 10.0),
        'lambda_l2': trial.suggest_loguniform('lambda_l2', 1e-8, 10.0),
        'num_leaves': trial.suggest_int('num_leaves', 2, 512),
        'learning_rate': trial.suggest_loguniform('learning_rate', 1e-8, 1.0),
        'n_estimators': trial.suggest_int('n_estimators', 700, 3000),
        'feature_fraction': trial.suggest_uniform('feature_fraction', 0.4, 1.0),
        'bagging_fraction': trial.suggest_uniform('bagging_fraction', 0.4, 1.0),
        'bagging_freq': trial.suggest_int('bagging_freq', 1, 7),
        'min_child_samples': trial.suggest_int('min_child_samples', 5, 100),
    }

    gbm = lgb.train(param, dtrain)
    return mean_squared_error(y_test, gbm.predict(X_test))

study = optuna.create_study(direction='minimize', sampler=sampler)
study.optimize(objective, n_trials=100)
lgb_params = study.best_params
print(lgb_params)
```

    [32m[I 2021-12-31 00:28:16,475][0m A new study created in memory with name: no-name-bcc3cafc-8d71-4891-a042-f9d0efe5167c[0m
    [32m[I 2021-12-31 00:28:16,726][0m Trial 0 finished with value: 4043.2722180536102 and parameters: {'lambda_l1': 0.08747537025773001, 'lambda_l2': 1.537331564587801e-08, 'num_leaves': 325, 'learning_rate': 0.00978207662259244, 'n_estimators': 1847, 'feature_fraction': 0.5348779873185086, 'bagging_fraction': 0.5188377188557745, 'bagging_freq': 6, 'min_child_samples': 21}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:16,974][0m Trial 1 finished with value: 14967.611796433881 and parameters: {'lambda_l1': 6.238186113062485e-08, 'lambda_l2': 0.014731208123898084, 'num_leaves': 489, 'learning_rate': 1.075439863800637e-08, 'n_estimators': 1878, 'feature_fraction': 0.8875725769912681, 'bagging_fraction': 0.7675156400976328, 'bagging_freq': 6, 'min_child_samples': 33}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:17,083][0m Trial 2 finished with value: 14966.404854104185 and parameters: {'lambda_l1': 1.8195630232649103, 'lambda_l2': 0.02698870526662559, 'num_leaves': 279, 'learning_rate': 1.372019806228628e-07, 'n_estimators': 1559, 'feature_fraction': 0.8044801690398071, 'bagging_fraction': 0.6650999046537976, 'bagging_freq': 4, 'min_child_samples': 64}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:17,255][0m Trial 3 finished with value: 4607.547022248865 and parameters: {'lambda_l1': 0.0004151874170225355, 'lambda_l2': 0.007137968669448066, 'num_leaves': 309, 'learning_rate': 0.027655758533508757, 'n_estimators': 1900, 'feature_fraction': 0.945189328485201, 'bagging_fraction': 0.5915416533931271, 'bagging_freq': 1, 'min_child_samples': 33}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:17,387][0m Trial 4 finished with value: 6775.230652228353 and parameters: {'lambda_l1': 1.0613515458050516e-07, 'lambda_l2': 0.2871652845130526, 'num_leaves': 25, 'learning_rate': 0.0010239934684337197, 'n_estimators': 1959, 'feature_fraction': 0.8915721974020412, 'bagging_fraction': 0.5193685238072874, 'bagging_freq': 6, 'min_child_samples': 38}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:17,511][0m Trial 5 finished with value: 14920.170123145197 and parameters: {'lambda_l1': 0.061919754212729834, 'lambda_l2': 4.609516372878068e-06, 'num_leaves': 453, 'learning_rate': 4.018769547074794e-06, 'n_estimators': 1079, 'feature_fraction': 0.6355175463679523, 'bagging_fraction': 0.4560762247351902, 'bagging_freq': 6, 'min_child_samples': 19}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:17,782][0m Trial 6 finished with value: 14246.462205968746 and parameters: {'lambda_l1': 2.8643760792886155e-05, 'lambda_l2': 3.15026008204159, 'num_leaves': 506, 'learning_rate': 4.471326429846904e-05, 'n_estimators': 2600, 'feature_fraction': 0.5508244805242356, 'bagging_fraction': 0.7584229889385306, 'bagging_freq': 7, 'min_child_samples': 56}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:17,899][0m Trial 7 finished with value: 14967.383003486604 and parameters: {'lambda_l1': 0.0020502757114657026, 'lambda_l2': 2.2570225857344917e-08, 'num_leaves': 184, 'learning_rate': 4.334157819798663e-08, 'n_estimators': 1402, 'feature_fraction': 0.5984315871892792, 'bagging_fraction': 0.8642981777263575, 'bagging_freq': 1, 'min_child_samples': 46}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:18,155][0m Trial 8 finished with value: 14967.313460292846 and parameters: {'lambda_l1': 6.828759954126584e-06, 'lambda_l2': 0.005350819333765383, 'num_leaves': 178, 'learning_rate': 2.211968049882666e-08, 'n_estimators': 2724, 'feature_fraction': 0.8579443522862087, 'bagging_fraction': 0.926857985634915, 'bagging_freq': 3, 'min_child_samples': 63}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:18,203][0m Trial 9 finished with value: 14957.424679760377 and parameters: {'lambda_l1': 0.00041802248886676206, 'lambda_l2': 0.0024017612390819757, 'num_leaves': 135, 'learning_rate': 2.5525277457416983e-06, 'n_estimators': 758, 'feature_fraction': 0.5818375363906209, 'bagging_fraction': 0.5452455252421164, 'bagging_freq': 4, 'min_child_samples': 59}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:18,294][0m Trial 10 finished with value: 14967.87258332058 and parameters: {'lambda_l1': 2.4741309325352723, 'lambda_l2': 1.369222160992905e-08, 'num_leaves': 378, 'learning_rate': 0.12146792728512504, 'n_estimators': 2315, 'feature_fraction': 0.4060026776049922, 'bagging_fraction': 0.4086369442869483, 'bagging_freq': 5, 'min_child_samples': 90}. Best is trial 0 with value: 4043.2722180536102.[0m
    [32m[I 2021-12-31 00:28:18,914][0m Trial 11 finished with value: 3360.9509086269604 and parameters: {'lambda_l1': 0.03347953644548801, 'lambda_l2': 9.26469149013902e-06, 'num_leaves': 320, 'learning_rate': 0.09983761238626826, 'n_estimators': 2175, 'feature_fraction': 0.9955045273812486, 'bagging_fraction': 0.6040945435143954, 'bagging_freq': 1, 'min_child_samples': 7}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:19,223][0m Trial 12 finished with value: 5350.924085204936 and parameters: {'lambda_l1': 0.032455686791080046, 'lambda_l2': 7.495304874751747e-06, 'num_leaves': 374, 'learning_rate': 0.6407534907214728, 'n_estimators': 2226, 'feature_fraction': 0.4397607018704378, 'bagging_fraction': 0.636671395350707, 'bagging_freq': 2, 'min_child_samples': 8}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:20,040][0m Trial 13 finished with value: 3368.28005426657 and parameters: {'lambda_l1': 0.16886080187615557, 'lambda_l2': 1.1348579974815265e-06, 'num_leaves': 365, 'learning_rate': 0.0049271211631904625, 'n_estimators': 2996, 'feature_fraction': 0.7386300901499554, 'bagging_fraction': 0.486819148656214, 'bagging_freq': 3, 'min_child_samples': 6}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:20,640][0m Trial 14 finished with value: 3618.2570793253262 and parameters: {'lambda_l1': 0.48797704809938386, 'lambda_l2': 6.296020202893471e-06, 'num_leaves': 411, 'learning_rate': 0.0012180546785530509, 'n_estimators': 2897, 'feature_fraction': 0.7281728243847296, 'bagging_fraction': 0.4089968622598294, 'bagging_freq': 2, 'min_child_samples': 8}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:20,808][0m Trial 15 finished with value: 6102.020346529484 and parameters: {'lambda_l1': 0.0071950028848911185, 'lambda_l2': 3.634309991714681e-07, 'num_leaves': 221, 'learning_rate': 0.925493477063021, 'n_estimators': 2353, 'feature_fraction': 0.9950910254281137, 'bagging_fraction': 0.7270693569075873, 'bagging_freq': 2, 'min_child_samples': 5}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:20,915][0m Trial 16 finished with value: 14967.87258332058 and parameters: {'lambda_l1': 4.2585913343955895, 'lambda_l2': 7.47718993121396e-05, 'num_leaves': 333, 'learning_rate': 0.0020799177947134497, 'n_estimators': 2970, 'feature_fraction': 0.758322302276974, 'bagging_fraction': 0.4651964514971264, 'bagging_freq': 3, 'min_child_samples': 89}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:21,323][0m Trial 17 finished with value: 5182.88418420792 and parameters: {'lambda_l1': 0.007137147885372796, 'lambda_l2': 3.13670313781477e-07, 'num_leaves': 418, 'learning_rate': 0.09734594580271164, 'n_estimators': 2575, 'feature_fraction': 0.9957940423823025, 'bagging_fraction': 0.5970885726650188, 'bagging_freq': 3, 'min_child_samples': 19}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:21,433][0m Trial 18 finished with value: 14698.618470277022 and parameters: {'lambda_l1': 0.31734831473074865, 'lambda_l2': 0.00011804294513975939, 'num_leaves': 87, 'learning_rate': 9.440503505796508e-05, 'n_estimators': 2982, 'feature_fraction': 0.6921815236538237, 'bagging_fraction': 0.46822930555251585, 'bagging_freq': 1, 'min_child_samples': 75}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:21,718][0m Trial 19 finished with value: 3864.39068092589 and parameters: {'lambda_l1': 4.634385177502186e-06, 'lambda_l2': 3.8562618802900874e-07, 'num_leaves': 265, 'learning_rate': 0.007536202437810071, 'n_estimators': 1595, 'feature_fraction': 0.48777336391582615, 'bagging_fraction': 0.6791853084900062, 'bagging_freq': 2, 'min_child_samples': 15}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:21,985][0m Trial 20 finished with value: 5225.620768457684 and parameters: {'lambda_l1': 8.927488975858124, 'lambda_l2': 2.5164852536178814e-05, 'num_leaves': 368, 'learning_rate': 0.13857049820001713, 'n_estimators': 2099, 'feature_fraction': 0.8114600335291653, 'bagging_fraction': 0.5541235634877011, 'bagging_freq': 3, 'min_child_samples': 27}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:22,749][0m Trial 21 finished with value: 4188.449950433482 and parameters: {'lambda_l1': 0.46177263261884766, 'lambda_l2': 3.120185615642288e-06, 'num_leaves': 424, 'learning_rate': 0.000830685756142501, 'n_estimators': 2806, 'feature_fraction': 0.7030388378036821, 'bagging_fraction': 0.4022338864716822, 'bagging_freq': 2, 'min_child_samples': 5}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:23,250][0m Trial 22 finished with value: 7784.178507149495 and parameters: {'lambda_l1': 0.40454788549083565, 'lambda_l2': 1.3981212793131462e-06, 'num_leaves': 448, 'learning_rate': 0.00033607479770983824, 'n_estimators': 2951, 'feature_fraction': 0.7088070188449377, 'bagging_fraction': 0.4141041677807407, 'bagging_freq': 1, 'min_child_samples': 12}. Best is trial 11 with value: 3360.9509086269604.[0m
    [32m[I 2021-12-31 00:28:24,023][0m Trial 23 finished with value: 3344.8900710742328 and parameters: {'lambda_l1': 0.012275882148543561, 'lambda_l2': 0.0004738733933303854, 'num_leaves': 390, 'learning_rate': 0.005882245598420155, 'n_estimators': 2445, 'feature_fraction': 0.650981052426173, 'bagging_fraction': 0.477575355078097, 'bagging_freq': 2, 'min_child_samples': 5}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:24,927][0m Trial 24 finished with value: 3715.0463940261197 and parameters: {'lambda_l1': 0.005766076390094276, 'lambda_l2': 0.0006386462771860648, 'num_leaves': 293, 'learning_rate': 0.01180858919100073, 'n_estimators': 2490, 'feature_fraction': 0.6416229448091583, 'bagging_fraction': 0.6073574870052335, 'bagging_freq': 3, 'min_child_samples': 5}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:25,199][0m Trial 25 finished with value: 4715.4196044206155 and parameters: {'lambda_l1': 0.026623381647559417, 'lambda_l2': 0.0002943191925495146, 'num_leaves': 349, 'learning_rate': 0.05018242307141864, 'n_estimators': 2112, 'feature_fraction': 0.6561391171163817, 'bagging_fraction': 0.4906625664275474, 'bagging_freq': 1, 'min_child_samples': 25}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:25,409][0m Trial 26 finished with value: 7045.581628843136 and parameters: {'lambda_l1': 0.0012436036127434769, 'lambda_l2': 9.607662429352575e-08, 'num_leaves': 236, 'learning_rate': 0.3945308359042235, 'n_estimators': 2520, 'feature_fraction': 0.776773761992353, 'bagging_fraction': 0.5629543462869622, 'bagging_freq': 4, 'min_child_samples': 45}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:25,873][0m Trial 27 finished with value: 3746.535773190114 and parameters: {'lambda_l1': 0.13245764549012956, 'lambda_l2': 2.55027545766427e-05, 'num_leaves': 475, 'learning_rate': 0.0048103249532889004, 'n_estimators': 2689, 'feature_fraction': 0.9514536095141968, 'bagging_fraction': 0.5013488114318987, 'bagging_freq': 2, 'min_child_samples': 14}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:26,172][0m Trial 28 finished with value: 11154.644109426325 and parameters: {'lambda_l1': 5.432236000108525e-05, 'lambda_l2': 0.0008832430574034811, 'num_leaves': 394, 'learning_rate': 0.00024494800260563266, 'n_estimators': 2432, 'feature_fraction': 0.5169491802933686, 'bagging_fraction': 0.6370834633810567, 'bagging_freq': 3, 'min_child_samples': 28}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:26,256][0m Trial 29 finished with value: 14967.87258332058 and parameters: {'lambda_l1': 0.010926753720181242, 'lambda_l2': 3.326621587605914e-05, 'num_leaves': 323, 'learning_rate': 0.032189427505179176, 'n_estimators': 2144, 'feature_fraction': 0.5906560197843052, 'bagging_fraction': 0.5157918191720707, 'bagging_freq': 5, 'min_child_samples': 99}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:26,446][0m Trial 30 finished with value: 14319.929668760036 and parameters: {'lambda_l1': 0.1072715981866688, 'lambda_l2': 0.055209424514335165, 'num_leaves': 338, 'learning_rate': 3.6984274291832733e-05, 'n_estimators': 1731, 'feature_fraction': 0.8394951174940648, 'bagging_fraction': 0.43199063121131287, 'bagging_freq': 2, 'min_child_samples': 21}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:26,987][0m Trial 31 finished with value: 3385.5656668227753 and parameters: {'lambda_l1': 0.9959770235816655, 'lambda_l2': 1.3410304439781216e-06, 'num_leaves': 416, 'learning_rate': 0.00394122055320876, 'n_estimators': 2880, 'feature_fraction': 0.7517680571020875, 'bagging_fraction': 0.44662286681619173, 'bagging_freq': 2, 'min_child_samples': 10}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:27,510][0m Trial 32 finished with value: 3491.2371857559765 and parameters: {'lambda_l1': 0.9391339805136384, 'lambda_l2': 9.240529887138069e-08, 'num_leaves': 447, 'learning_rate': 0.0034775289860178083, 'n_estimators': 2817, 'feature_fraction': 0.6685213214616129, 'bagging_fraction': 0.4433290076014121, 'bagging_freq': 1, 'min_child_samples': 11}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:28,243][0m Trial 33 finished with value: 3481.954349115622 and parameters: {'lambda_l1': 9.597825224943023, 'lambda_l2': 1.1535575380361456e-06, 'num_leaves': 355, 'learning_rate': 0.01045828955581718, 'n_estimators': 2312, 'feature_fraction': 0.7652332806312953, 'bagging_fraction': 0.5444498301284832, 'bagging_freq': 2, 'min_child_samples': 5}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:28,645][0m Trial 34 finished with value: 4131.682205839682 and parameters: {'lambda_l1': 0.14465555894768978, 'lambda_l2': 6.434615479334737e-08, 'num_leaves': 299, 'learning_rate': 0.0188747378957305, 'n_estimators': 2696, 'feature_fraction': 0.7508308832940973, 'bagging_fraction': 0.4912726833909957, 'bagging_freq': 3, 'min_child_samples': 15}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:28,846][0m Trial 35 finished with value: 5654.929264703216 and parameters: {'lambda_l1': 0.023431099634452807, 'lambda_l2': 1.1396975607288286e-06, 'num_leaves': 482, 'learning_rate': 0.21658328733639004, 'n_estimators': 1967, 'feature_fraction': 0.906898758245523, 'bagging_fraction': 0.5713758859321435, 'bagging_freq': 1, 'min_child_samples': 34}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:29,257][0m Trial 36 finished with value: 4626.58162821161 and parameters: {'lambda_l1': 0.002069696305256338, 'lambda_l2': 1.3119524530789354e-05, 'num_leaves': 389, 'learning_rate': 0.0384378022640788, 'n_estimators': 2835, 'feature_fraction': 0.81328528982588, 'bagging_fraction': 0.6329433032034145, 'bagging_freq': 2, 'min_child_samples': 23}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:29,503][0m Trial 37 finished with value: 9985.250087267741 and parameters: {'lambda_l1': 1.5767918651903843, 'lambda_l2': 0.00015800075389282942, 'num_leaves': 273, 'learning_rate': 0.0003332614686667451, 'n_estimators': 1778, 'feature_fraction': 0.6262646728064278, 'bagging_fraction': 0.5306543098131837, 'bagging_freq': 4, 'min_child_samples': 18}. Best is trial 23 with value: 3344.8900710742328.[0m
    [32m[I 2021-12-31 00:28:30,021][0m Trial 38 finished with value: 3280.510034017772 and parameters: {'lambda_l1': 0.0719035086610468, 'lambda_l2': 2.26539772821827e-06, 'num_leaves': 312, 'learning_rate': 0.0027040352618258718, 'n_estimators': 2004, 'feature_fraction': 0.928872734758991, 'bagging_fraction': 0.8141176235825153, 'bagging_freq': 1, 'min_child_samples': 10}. Best is trial 38 with value: 3280.510034017772.[0m
    [32m[I 2021-12-31 00:28:30,257][0m Trial 39 finished with value: 14659.63031594217 and parameters: {'lambda_l1': 0.06265620726708493, 'lambda_l2': 6.0849401962474055e-05, 'num_leaves': 315, 'learning_rate': 1.2497031945649772e-05, 'n_estimators': 1993, 'feature_fraction': 0.9482936224722988, 'bagging_fraction': 0.8732992279694357, 'bagging_freq': 1, 'min_child_samples': 40}. Best is trial 38 with value: 3280.510034017772.[0m
    [32m[I 2021-12-31 00:28:30,427][0m Trial 40 finished with value: 6344.809140870516 and parameters: {'lambda_l1': 0.00016317250717099664, 'lambda_l2': 0.0011570470290322515, 'num_leaves': 224, 'learning_rate': 0.001060257649631887, 'n_estimators': 1433, 'feature_fraction': 0.9004425477825065, 'bagging_fraction': 0.8163851744734678, 'bagging_freq': 1, 'min_child_samples': 31}. Best is trial 38 with value: 3280.510034017772.[0m
    [32m[I 2021-12-31 00:28:30,940][0m Trial 41 finished with value: 3269.0199440901974 and parameters: {'lambda_l1': 0.23068609347878594, 'lambda_l2': 2.203702237062224e-06, 'num_leaves': 511, 'learning_rate': 0.003563900486480328, 'n_estimators': 2060, 'feature_fraction': 0.8627574800884897, 'bagging_fraction': 0.7152006115547436, 'bagging_freq': 2, 'min_child_samples': 11}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:31,840][0m Trial 42 finished with value: 3369.917464604481 and parameters: {'lambda_l1': 0.024576334557813488, 'lambda_l2': 3.0434549551980443e-06, 'num_leaves': 505, 'learning_rate': 0.0028420524116335383, 'n_estimators': 1850, 'feature_fraction': 0.9266949987607392, 'bagging_fraction': 0.8017159602286886, 'bagging_freq': 1, 'min_child_samples': 5}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:32,144][0m Trial 43 finished with value: 4490.120187236316 and parameters: {'lambda_l1': 0.2049436052908926, 'lambda_l2': 1.1864463137152829e-05, 'num_leaves': 286, 'learning_rate': 0.06499896865651586, 'n_estimators': 1671, 'feature_fraction': 0.864566776432798, 'bagging_fraction': 0.7083041183536734, 'bagging_freq': 3, 'min_child_samples': 17}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:32,850][0m Trial 44 finished with value: 3799.5250840239555 and parameters: {'lambda_l1': 0.04654996563631326, 'lambda_l2': 2.515483672655619e-07, 'num_leaves': 312, 'learning_rate': 0.016716597873926084, 'n_estimators': 2221, 'feature_fraction': 0.9782275470091001, 'bagging_fraction': 0.9775887980203763, 'bagging_freq': 2, 'min_child_samples': 10}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:33,319][0m Trial 45 finished with value: 5728.642257590538 and parameters: {'lambda_l1': 0.002032215769735508, 'lambda_l2': 3.644847627035453e-06, 'num_leaves': 255, 'learning_rate': 0.000724626679378068, 'n_estimators': 1926, 'feature_fraction': 0.86903038703965, 'bagging_fraction': 0.7402858196313021, 'bagging_freq': 1, 'min_child_samples': 9}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:33,673][0m Trial 46 finished with value: 5465.830413943032 and parameters: {'lambda_l1': 0.01629519001367919, 'lambda_l2': 0.005771692809086884, 'num_leaves': 360, 'learning_rate': 0.27861451825954975, 'n_estimators': 2036, 'feature_fraction': 0.8411239052333656, 'bagging_fraction': 0.7690281854238996, 'bagging_freq': 2, 'min_child_samples': 21}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:33,833][0m Trial 47 finished with value: 13087.552692368634 and parameters: {'lambda_l1': 3.4635217060358188, 'lambda_l2': 3.9554646887984944e-08, 'num_leaves': 387, 'learning_rate': 0.00014458730925236444, 'n_estimators': 2238, 'feature_fraction': 0.972616215207727, 'bagging_fraction': 0.6768612685209957, 'bagging_freq': 3, 'min_child_samples': 73}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:35,054][0m Trial 48 finished with value: 3483.85238333401 and parameters: {'lambda_l1': 0.07096841123065434, 'lambda_l2': 0.0003608562986088493, 'num_leaves': 341, 'learning_rate': 0.0068360320771445665, 'n_estimators': 2345, 'feature_fraction': 0.9277594434501144, 'bagging_fraction': 0.8485863244708225, 'bagging_freq': 2, 'min_child_samples': 5}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:35,602][0m Trial 49 finished with value: 14945.70819687067 and parameters: {'lambda_l1': 0.0041686763575174025, 'lambda_l2': 0.01821050913377001, 'num_leaves': 466, 'learning_rate': 8.501721485609632e-07, 'n_estimators': 1870, 'feature_fraction': 0.7918589670112648, 'bagging_fraction': 0.9197316320952431, 'bagging_freq': 4, 'min_child_samples': 13}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:35,840][0m Trial 50 finished with value: 6412.352697901031 and parameters: {'lambda_l1': 0.0007727216677960697, 'lambda_l2': 5.5230950050698e-07, 'num_leaves': 179, 'learning_rate': 0.001799442136541643, 'n_estimators': 1100, 'feature_fraction': 0.6119383132455826, 'bagging_fraction': 0.7677229988144078, 'bagging_freq': 5, 'min_child_samples': 16}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:36,900][0m Trial 51 finished with value: 5425.382234838224 and parameters: {'lambda_l1': 0.027926151505769294, 'lambda_l2': 3.3830878497950642e-06, 'num_leaves': 508, 'learning_rate': 0.0006510406016069569, 'n_estimators': 1778, 'feature_fraction': 0.9118527932730203, 'bagging_fraction': 0.814244308808697, 'bagging_freq': 1, 'min_child_samples': 5}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:37,491][0m Trial 52 finished with value: 3346.691257725465 and parameters: {'lambda_l1': 0.26171044270656246, 'lambda_l2': 1.1201211565003877e-05, 'num_leaves': 441, 'learning_rate': 0.0024605050193930427, 'n_estimators': 1857, 'feature_fraction': 0.9329719203117068, 'bagging_fraction': 0.7899506306858621, 'bagging_freq': 1, 'min_child_samples': 8}. Best is trial 41 with value: 3269.0199440901974.[0m
    [32m[I 2021-12-31 00:28:38,167][0m Trial 53 finished with value: 3080.3490703113152 and parameters: {'lambda_l1': 1.0877495629755123, 'lambda_l2': 9.513948862229059e-06, 'num_leaves': 435, 'learning_rate': 0.01779670992786097, 'n_estimators': 2051, 'feature_fraction': 0.9666614333483982, 'bagging_fraction': 0.7111874804729121, 'bagging_freq': 1, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:38,602][0m Trial 54 finished with value: 3300.0861735438307 and parameters: {'lambda_l1': 4.7031713375438375, 'lambda_l2': 9.259929268088322e-06, 'num_leaves': 444, 'learning_rate': 0.020145364549347962, 'n_estimators': 2052, 'feature_fraction': 0.9728619185012316, 'bagging_fraction': 0.6971360862333345, 'bagging_freq': 7, 'min_child_samples': 13}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:39,074][0m Trial 55 finished with value: 3325.1346952543486 and parameters: {'lambda_l1': 6.164553780361101, 'lambda_l2': 3.5536920162989464e-05, 'num_leaves': 436, 'learning_rate': 0.02106501216123532, 'n_estimators': 2062, 'feature_fraction': 0.9584720925475263, 'bagging_fraction': 0.7002696904729101, 'bagging_freq': 7, 'min_child_samples': 12}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:39,386][0m Trial 56 finished with value: 4335.290475770888 and parameters: {'lambda_l1': 5.461034920480546, 'lambda_l2': 5.4415514446554746e-05, 'num_leaves': 498, 'learning_rate': 0.02098797497096219, 'n_estimators': 2016, 'feature_fraction': 0.9590099300658989, 'bagging_fraction': 0.7035614359644727, 'bagging_freq': 7, 'min_child_samples': 24}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:39,853][0m Trial 57 finished with value: 3699.745633617472 and parameters: {'lambda_l1': 0.8775037239740922, 'lambda_l2': 0.00016076834196875243, 'num_leaves': 429, 'learning_rate': 0.0653432945985977, 'n_estimators': 2094, 'feature_fraction': 0.9936852315071667, 'bagging_fraction': 0.7266565111561779, 'bagging_freq': 7, 'min_child_samples': 13}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:40,201][0m Trial 58 finished with value: 4148.384223606311 and parameters: {'lambda_l1': 2.368285801480206e-08, 'lambda_l2': 0.002896462164283549, 'num_leaves': 465, 'learning_rate': 0.012075724733063752, 'n_estimators': 2241, 'feature_fraction': 0.8841221478772725, 'bagging_fraction': 0.6477583085878477, 'bagging_freq': 6, 'min_child_samples': 20}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:40,396][0m Trial 59 finished with value: 4396.0072291406395 and parameters: {'lambda_l1': 2.3666903806061046, 'lambda_l2': 4.205795740827208e-05, 'num_leaves': 402, 'learning_rate': 0.03075868559503807, 'n_estimators': 1537, 'feature_fraction': 0.5660635388605657, 'bagging_fraction': 0.7470543060690994, 'bagging_freq': 6, 'min_child_samples': 30}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:40,952][0m Trial 60 finished with value: 3228.9691495697753 and parameters: {'lambda_l1': 7.530223835576067, 'lambda_l2': 1.6036827652821e-05, 'num_leaves': 434, 'learning_rate': 0.0073112433338484, 'n_estimators': 2455, 'feature_fraction': 0.9847551966299743, 'bagging_fraction': 0.6623367676328428, 'bagging_freq': 7, 'min_child_samples': 11}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:41,451][0m Trial 61 finished with value: 3308.409118848338 and parameters: {'lambda_l1': 9.088624843492079, 'lambda_l2': 1.8094770570557456e-05, 'num_leaves': 434, 'learning_rate': 0.005821345658608569, 'n_estimators': 2307, 'feature_fraction': 0.9728534581584926, 'bagging_fraction': 0.6825060797684216, 'bagging_freq': 7, 'min_child_samples': 12}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:41,797][0m Trial 62 finished with value: 3842.969134444321 and parameters: {'lambda_l1': 9.580537275841191, 'lambda_l2': 4.927488980046021e-06, 'num_leaves': 432, 'learning_rate': 0.0017452684167860281, 'n_estimators': 2069, 'feature_fraction': 0.9758396668373512, 'bagging_fraction': 0.6657360451686496, 'bagging_freq': 7, 'min_child_samples': 17}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:42,376][0m Trial 63 finished with value: 3159.266416613664 and parameters: {'lambda_l1': 5.8178433167968135, 'lambda_l2': 1.840326819905056e-05, 'num_leaves': 489, 'learning_rate': 0.009175596234496753, 'n_estimators': 2403, 'feature_fraction': 0.9981099932076394, 'bagging_fraction': 0.7009906860521112, 'bagging_freq': 6, 'min_child_samples': 11}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:43,038][0m Trial 64 finished with value: 3225.93647400579 and parameters: {'lambda_l1': 1.3742578511724883, 'lambda_l2': 1.628804647962653e-05, 'num_leaves': 486, 'learning_rate': 0.006351813953178484, 'n_estimators': 2400, 'feature_fraction': 0.9979235325083115, 'bagging_fraction': 0.6867106719593797, 'bagging_freq': 6, 'min_child_samples': 9}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:43,746][0m Trial 65 finished with value: 3426.98105696397 and parameters: {'lambda_l1': 1.5846806084527418, 'lambda_l2': 2.2930743216043466e-06, 'num_leaves': 483, 'learning_rate': 0.008867627825339753, 'n_estimators': 2642, 'feature_fraction': 0.9908908582444766, 'bagging_fraction': 0.6562851282169304, 'bagging_freq': 6, 'min_child_samples': 9}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:44,382][0m Trial 66 finished with value: 3793.2286647099877 and parameters: {'lambda_l1': 0.6128501877814438, 'lambda_l2': 6.889824921309134e-06, 'num_leaves': 456, 'learning_rate': 0.10069058849345336, 'n_estimators': 2429, 'feature_fraction': 0.9973059763340067, 'bagging_fraction': 0.6181385922814707, 'bagging_freq': 6, 'min_child_samples': 8}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:44,896][0m Trial 67 finished with value: 3655.6051875990543 and parameters: {'lambda_l1': 3.6519128201766846, 'lambda_l2': 9.658952744490464e-05, 'num_leaves': 492, 'learning_rate': 0.001350758390186788, 'n_estimators': 2581, 'feature_fraction': 0.9387837563237925, 'bagging_fraction': 0.7290180769719977, 'bagging_freq': 5, 'min_child_samples': 15}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:45,212][0m Trial 68 finished with value: 6222.440136738525 and parameters: {'lambda_l1': 1.522876708979632, 'lambda_l2': 7.347776104359533e-07, 'num_leaves': 31, 'learning_rate': 0.0005500520254273859, 'n_estimators': 2516, 'feature_fraction': 0.8878981505113892, 'bagging_fraction': 0.7129430499744144, 'bagging_freq': 7, 'min_child_samples': 22}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:45,490][0m Trial 69 finished with value: 4102.620672197076 and parameters: {'lambda_l1': 4.415335734862533e-07, 'lambda_l2': 1.8265813042446437e-07, 'num_leaves': 150, 'learning_rate': 0.012357881161880678, 'n_estimators': 2156, 'feature_fraction': 0.9188990841605709, 'bagging_fraction': 0.6801775854009937, 'bagging_freq': 6, 'min_child_samples': 26}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:46,213][0m Trial 70 finished with value: 3317.8092058823418 and parameters: {'lambda_l1': 0.5002308611492297, 'lambda_l2': 7.091546854853154e-06, 'num_leaves': 468, 'learning_rate': 0.003923100454069341, 'n_estimators': 2418, 'feature_fraction': 0.9595508806554803, 'bagging_fraction': 0.6922960443869334, 'bagging_freq': 5, 'min_child_samples': 8}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:46,718][0m Trial 71 finished with value: 3265.950166340402 and parameters: {'lambda_l1': 9.529757055444191, 'lambda_l2': 2.856127599628926e-05, 'num_leaves': 453, 'learning_rate': 0.006304065373594684, 'n_estimators': 2264, 'feature_fraction': 0.9838155384381226, 'bagging_fraction': 0.6817622406780757, 'bagging_freq': 7, 'min_child_samples': 12}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:47,100][0m Trial 72 finished with value: 4706.963505100057 and parameters: {'lambda_l1': 3.025674788760479, 'lambda_l2': 2.0825976963514646e-05, 'num_leaves': 509, 'learning_rate': 0.03512339453433019, 'n_estimators': 2373, 'feature_fraction': 0.9966113256353624, 'bagging_fraction': 0.5806947513945202, 'bagging_freq': 7, 'min_child_samples': 19}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:47,576][0m Trial 73 finished with value: 3189.092396568738 and parameters: {'lambda_l1': 5.231246578758928, 'lambda_l2': 1.8253791806687484e-05, 'num_leaves': 457, 'learning_rate': 0.006200216786980191, 'n_estimators': 2186, 'feature_fraction': 0.9794469197578655, 'bagging_fraction': 0.629194637358516, 'bagging_freq': 7, 'min_child_samples': 11}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:48,060][0m Trial 74 finished with value: 3356.4857070451612 and parameters: {'lambda_l1': 1.9603622989181464, 'lambda_l2': 2.0013743754508427e-05, 'num_leaves': 410, 'learning_rate': 0.007262665270958694, 'n_estimators': 2265, 'feature_fraction': 0.9464921872183089, 'bagging_fraction': 0.6128080207203339, 'bagging_freq': 6, 'min_child_samples': 11}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:48,452][0m Trial 75 finished with value: 3671.6087424033785 and parameters: {'lambda_l1': 1.0343782491852183, 'lambda_l2': 1.7971195773635752e-06, 'num_leaves': 488, 'learning_rate': 0.0026395511171865465, 'n_estimators': 2193, 'feature_fraction': 0.9843561883626968, 'bagging_fraction': 0.6349720705655781, 'bagging_freq': 7, 'min_child_samples': 16}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:49,217][0m Trial 76 finished with value: 3191.813827763168 and parameters: {'lambda_l1': 0.25452632675021075, 'lambda_l2': 0.0001016273901803575, 'num_leaves': 463, 'learning_rate': 0.004886734831680699, 'n_estimators': 2384, 'feature_fraction': 0.9988419716936355, 'bagging_fraction': 0.6680132277323707, 'bagging_freq': 7, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:50,013][0m Trial 77 finished with value: 3194.063092953648 and parameters: {'lambda_l1': 0.3079042651069056, 'lambda_l2': 7.13974721579711e-05, 'num_leaves': 460, 'learning_rate': 0.005063573141488742, 'n_estimators': 2382, 'feature_fraction': 0.9600255944955256, 'bagging_fraction': 0.7194071630004274, 'bagging_freq': 7, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:50,221][0m Trial 78 finished with value: 5300.731531402726 and parameters: {'lambda_l1': 5.8921924294457, 'lambda_l2': 0.00017396546426833332, 'num_leaves': 455, 'learning_rate': 0.008559099034873107, 'n_estimators': 2477, 'feature_fraction': 0.9592623396422495, 'bagging_fraction': 0.6604578397900254, 'bagging_freq': 7, 'min_child_samples': 56}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:50,950][0m Trial 79 finished with value: 3350.8331162899576 and parameters: {'lambda_l1': 0.6858867568304685, 'lambda_l2': 5.121870693911542e-05, 'num_leaves': 458, 'learning_rate': 0.046944062567183614, 'n_estimators': 2392, 'feature_fraction': 0.9993422587443543, 'bagging_fraction': 0.6234424964994559, 'bagging_freq': 7, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:51,265][0m Trial 80 finished with value: 3782.8278100748526 and parameters: {'lambda_l1': 9.89428731208034, 'lambda_l2': 0.00023276290712881186, 'num_leaves': 476, 'learning_rate': 0.1417702429807492, 'n_estimators': 2748, 'feature_fraction': 0.9989528058660124, 'bagging_fraction': 0.5886438280657386, 'bagging_freq': 6, 'min_child_samples': 5}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:51,799][0m Trial 81 finished with value: 3410.9873696875125 and parameters: {'lambda_l1': 0.3402963297089753, 'lambda_l2': 9.866644833556001e-05, 'num_leaves': 512, 'learning_rate': 0.004582595016976765, 'n_estimators': 2552, 'feature_fraction': 0.9672197464251439, 'bagging_fraction': 0.7209749756040841, 'bagging_freq': 7, 'min_child_samples': 14}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:52,590][0m Trial 82 finished with value: 3397.3785794604614 and parameters: {'lambda_l1': 0.18489690290702404, 'lambda_l2': 1.5990207071985912e-05, 'num_leaves': 494, 'learning_rate': 0.00138668429892531, 'n_estimators': 2292, 'feature_fraction': 0.9436059053382713, 'bagging_fraction': 0.7532343067601421, 'bagging_freq': 7, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:52,955][0m Trial 83 finished with value: 4052.844286799741 and parameters: {'lambda_l1': 1.3429856052074396, 'lambda_l2': 2.4038978596641796, 'num_leaves': 480, 'learning_rate': 0.01088331229912666, 'n_estimators': 2148, 'feature_fraction': 0.981201873460754, 'bagging_fraction': 0.6697725187177115, 'bagging_freq': 7, 'min_child_samples': 18}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:53,527][0m Trial 84 finished with value: 3237.633532634076 and parameters: {'lambda_l1': 2.166209957277579, 'lambda_l2': 3.917942741778045e-05, 'num_leaves': 418, 'learning_rate': 0.004369031584320643, 'n_estimators': 2615, 'feature_fraction': 0.9107439101503522, 'bagging_fraction': 0.6497400282852313, 'bagging_freq': 6, 'min_child_samples': 11}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:54,126][0m Trial 85 finished with value: 3272.850555695293 and parameters: {'lambda_l1': 2.4063853487190654, 'lambda_l2': 3.119104860098403e-05, 'num_leaves': 417, 'learning_rate': 0.015424850599772399, 'n_estimators': 2490, 'feature_fraction': 0.8986047078923997, 'bagging_fraction': 0.6539334698384163, 'bagging_freq': 6, 'min_child_samples': 10}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:54,574][0m Trial 86 finished with value: 6528.380713564604 and parameters: {'lambda_l1': 6.259358464616423, 'lambda_l2': 8.10504686265656e-05, 'num_leaves': 402, 'learning_rate': 0.00040582832151976275, 'n_estimators': 2651, 'feature_fraction': 0.9471515586740294, 'bagging_fraction': 0.6431060066812176, 'bagging_freq': 6, 'min_child_samples': 15}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:55,310][0m Trial 87 finished with value: 3185.33650739255 and parameters: {'lambda_l1': 3.0938056641625282, 'lambda_l2': 5.556921701025632e-06, 'num_leaves': 377, 'learning_rate': 0.005414411844982491, 'n_estimators': 2359, 'feature_fraction': 0.9847809563058364, 'bagging_fraction': 0.6890896023120301, 'bagging_freq': 5, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:56,031][0m Trial 88 finished with value: 3488.9396242292373 and parameters: {'lambda_l1': 0.3813636062918554, 'lambda_l2': 0.0006177013973371976, 'num_leaves': 426, 'learning_rate': 0.0010663509743321859, 'n_estimators': 2618, 'feature_fraction': 0.9233468178056119, 'bagging_fraction': 0.6000943516856058, 'bagging_freq': 5, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:56,291][0m Trial 89 finished with value: 4536.9493439247935 and parameters: {'lambda_l1': 2.990585790425073, 'lambda_l2': 5.039732783765903e-06, 'num_leaves': 379, 'learning_rate': 0.026105645316492752, 'n_estimators': 2344, 'feature_fraction': 0.9631687612731211, 'bagging_fraction': 0.7801526832262512, 'bagging_freq': 5, 'min_child_samples': 49}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:57,101][0m Trial 90 finished with value: 3613.2049677320542 and parameters: {'lambda_l1': 0.7842027357555804, 'lambda_l2': 1.2756302947859808e-05, 'num_leaves': 473, 'learning_rate': 0.06192874110786141, 'n_estimators': 2571, 'feature_fraction': 0.9988883900858198, 'bagging_fraction': 0.738933097238899, 'bagging_freq': 6, 'min_child_samples': 5}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:57,701][0m Trial 91 finished with value: 3182.9065850860297 and parameters: {'lambda_l1': 4.190622405447029, 'lambda_l2': 2.9634344631574615e-05, 'num_leaves': 450, 'learning_rate': 0.006347127280899073, 'n_estimators': 2444, 'feature_fraction': 0.9795576967178777, 'bagging_fraction': 0.6833846838421147, 'bagging_freq': 6, 'min_child_samples': 10}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:58,354][0m Trial 92 finished with value: 3207.747295463212 and parameters: {'lambda_l1': 1.3002240529377904, 'lambda_l2': 6.921030763493736e-05, 'num_leaves': 411, 'learning_rate': 0.0048174693865195425, 'n_estimators': 2463, 'feature_fraction': 0.9830250645444222, 'bagging_fraction': 0.6887127582291092, 'bagging_freq': 6, 'min_child_samples': 9}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:59,027][0m Trial 93 finished with value: 3552.4264622000837 and parameters: {'lambda_l1': 1.023295366036638, 'lambda_l2': 6.164487958049723e-05, 'num_leaves': 445, 'learning_rate': 0.014344795163845469, 'n_estimators': 2451, 'feature_fraction': 0.9870591258447297, 'bagging_fraction': 0.6921910773492032, 'bagging_freq': 5, 'min_child_samples': 9}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:28:59,748][0m Trial 94 finished with value: 3155.4800559707483 and parameters: {'lambda_l1': 4.139259475377319, 'lambda_l2': 0.0002752252539449152, 'num_leaves': 409, 'learning_rate': 0.00197621282607191, 'n_estimators': 2392, 'feature_fraction': 0.9709605033490946, 'bagging_fraction': 0.6693016779325607, 'bagging_freq': 6, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:29:00,536][0m Trial 95 finished with value: 3312.8828741532957 and parameters: {'lambda_l1': 4.285073651532476, 'lambda_l2': 0.0016642587374272773, 'num_leaves': 404, 'learning_rate': 0.0019469957227594172, 'n_estimators': 2365, 'feature_fraction': 0.9360770339382358, 'bagging_fraction': 0.7358283755819106, 'bagging_freq': 6, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:29:01,497][0m Trial 96 finished with value: 3240.233338480919 and parameters: {'lambda_l1': 0.5732225491841108, 'lambda_l2': 0.0001081351012447647, 'num_leaves': 461, 'learning_rate': 0.003380872495316589, 'n_estimators': 2201, 'feature_fraction': 0.9659903698923061, 'bagging_fraction': 0.712383554567749, 'bagging_freq': 6, 'min_child_samples': 5}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:29:01,933][0m Trial 97 finished with value: 3403.927050288297 and parameters: {'lambda_l1': 0.09518696542005549, 'lambda_l2': 0.00039547119948012604, 'num_leaves': 375, 'learning_rate': 0.002249440987621854, 'n_estimators': 2298, 'feature_fraction': 0.9525267171658159, 'bagging_fraction': 0.6909665857959267, 'bagging_freq': 6, 'min_child_samples': 14}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:29:02,339][0m Trial 98 finished with value: 4204.80912550328 and parameters: {'lambda_l1': 1.363533475496277, 'lambda_l2': 0.00024336934867643092, 'num_leaves': 394, 'learning_rate': 0.023950484659955015, 'n_estimators': 2400, 'feature_fraction': 0.9724636085222322, 'bagging_fraction': 0.6274433408026918, 'bagging_freq': 5, 'min_child_samples': 17}. Best is trial 53 with value: 3080.3490703113152.[0m
    [32m[I 2021-12-31 00:29:03,253][0m Trial 99 finished with value: 3223.7866847680616 and parameters: {'lambda_l1': 0.33348844333283634, 'lambda_l2': 8.27606808106655e-06, 'num_leaves': 499, 'learning_rate': 0.0044306421544938485, 'n_estimators': 2527, 'feature_fraction': 0.9416829904965378, 'bagging_fraction': 0.7593405238994848, 'bagging_freq': 6, 'min_child_samples': 7}. Best is trial 53 with value: 3080.3490703113152.[0m
    

    {'lambda_l1': 1.0877495629755123, 'lambda_l2': 9.513948862229059e-06, 'num_leaves': 435, 'learning_rate': 0.01779670992786097, 'n_estimators': 2051, 'feature_fraction': 0.9666614333483982, 'bagging_fraction': 0.7111874804729121, 'bagging_freq': 1, 'min_child_samples': 7}
    


```python
def objective(trial):
    dtrain = xgb.DMatrix(X_train, label=y_train)

    param = {
        'objective': 'reg:squarederror',
        'metric': 'mse',
        'verbosity': 0,
        'boosting_type': 'gbdt',
        'lambda_l1': trial.suggest_loguniform('lambda_l1', 1e-8, 10.0),
        'lambda_l2': trial.suggest_loguniform('lambda_l2', 1e-8, 10.0),
        'num_leaves': trial.suggest_int('num_leaves', 2, 512),
        'learning_rate': trial.suggest_loguniform('learning_rate', 1e-8, 1.0),
        'n_estimators': trial.suggest_int('n_estimators', 700, 3000),
        'feature_fraction': trial.suggest_uniform('feature_fraction', 0.4, 1.0),
        'bagging_fraction': trial.suggest_uniform('bagging_fraction', 0.4, 1.0),
        'bagging_freq': trial.suggest_int('bagging_freq', 1, 7),
        'min_child_samples': trial.suggest_int('min_child_samples', 5, 100),
    }

    gbm = xgb.train(param, dtrain)
    return mean_squared_error(y_test, gbm.predict(xgb.DMatrix(X_test, label=np.ones_like(y_test))))

study = optuna.create_study(direction='minimize', sampler=sampler)
study.optimize(objective, n_trials=100)
xgb_params = study.best_params
print(xgb_params)
```

    [32m[I 2021-12-31 00:29:03,299][0m A new study created in memory with name: no-name-4ba684f9-2f0c-4955-a197-62e518c6cebe[0m
    [32m[I 2021-12-31 00:29:03,311][0m Trial 0 finished with value: 4568.618488626321 and parameters: {'lambda_l1': 0.0001888818495451605, 'lambda_l2': 4.316997395148871e-06, 'num_leaves': 34, 'learning_rate': 0.6769446589927728, 'n_estimators': 1481, 'feature_fraction': 0.6970291785294727, 'bagging_fraction': 0.9862484355536091, 'bagging_freq': 4, 'min_child_samples': 35}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,319][0m Trial 1 finished with value: 226112.52673924877 and parameters: {'lambda_l1': 0.0004766206700594015, 'lambda_l2': 0.0015967167049923197, 'num_leaves': 438, 'learning_rate': 3.5057277657330025e-08, 'n_estimators': 1768, 'feature_fraction': 0.869169471171489, 'bagging_fraction': 0.8311616862293502, 'bagging_freq': 5, 'min_child_samples': 8}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,327][0m Trial 2 finished with value: 225559.24865963677 and parameters: {'lambda_l1': 1.4318829623595658e-05, 'lambda_l2': 0.001171429510270195, 'num_leaves': 155, 'learning_rate': 0.00012550852514250831, 'n_estimators': 2249, 'feature_fraction': 0.4955162400268561, 'bagging_fraction': 0.4302866020923986, 'bagging_freq': 3, 'min_child_samples': 15}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,335][0m Trial 3 finished with value: 226110.19817846653 and parameters: {'lambda_l1': 4.0749780818897353e-07, 'lambda_l2': 0.9385207208605129, 'num_leaves': 188, 'learning_rate': 5.625417934541377e-07, 'n_estimators': 2431, 'feature_fraction': 0.46412775063614153, 'bagging_fraction': 0.8467619444653364, 'bagging_freq': 4, 'min_child_samples': 62}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,342][0m Trial 4 finished with value: 226112.57357006054 and parameters: {'lambda_l1': 2.1309915644933492e-07, 'lambda_l2': 4.532245211996864e-07, 'num_leaves': 331, 'learning_rate': 2.4491988683999263e-08, 'n_estimators': 1272, 'feature_fraction': 0.7254451097368025, 'bagging_fraction': 0.5360640059620055, 'bagging_freq': 3, 'min_child_samples': 93}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,349][0m Trial 5 finished with value: 226112.62353696502 and parameters: {'lambda_l1': 2.1291774395752365, 'lambda_l2': 0.0012610994061319214, 'num_leaves': 274, 'learning_rate': 1.3148620689762314e-08, 'n_estimators': 2950, 'feature_fraction': 0.7438173424199115, 'bagging_fraction': 0.8750541977659744, 'bagging_freq': 4, 'min_child_samples': 89}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,357][0m Trial 6 finished with value: 225994.53943042984 and parameters: {'lambda_l1': 0.0018103496266266559, 'lambda_l2': 0.023968918423710666, 'num_leaves': 77, 'learning_rate': 2.6767382919203297e-05, 'n_estimators': 2296, 'feature_fraction': 0.4627718467137119, 'bagging_fraction': 0.6637631426647543, 'bagging_freq': 2, 'min_child_samples': 53}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,365][0m Trial 7 finished with value: 224652.01251495202 and parameters: {'lambda_l1': 0.2351379768824919, 'lambda_l2': 6.470839270888937e-08, 'num_leaves': 410, 'learning_rate': 0.00033190273537724176, 'n_estimators': 2056, 'feature_fraction': 0.5188603943297614, 'bagging_fraction': 0.6616709532033006, 'bagging_freq': 3, 'min_child_samples': 8}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,374][0m Trial 8 finished with value: 224847.68889166915 and parameters: {'lambda_l1': 1.888702535568543e-08, 'lambda_l2': 0.00011965889880637617, 'num_leaves': 382, 'learning_rate': 0.00028731827469375126, 'n_estimators': 1586, 'feature_fraction': 0.5008436785195712, 'bagging_fraction': 0.9029567924222157, 'bagging_freq': 5, 'min_child_samples': 80}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,382][0m Trial 9 finished with value: 222420.0952435599 and parameters: {'lambda_l1': 0.4330944686134719, 'lambda_l2': 0.002682049461800648, 'num_leaves': 401, 'learning_rate': 0.000843130904208232, 'n_estimators': 748, 'feature_fraction': 0.8502787662924947, 'bagging_fraction': 0.5056252799702163, 'bagging_freq': 4, 'min_child_samples': 54}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,412][0m Trial 10 finished with value: 5273.849472647603 and parameters: {'lambda_l1': 0.011761885603161382, 'lambda_l2': 3.996667731664228e-06, 'num_leaves': 12, 'learning_rate': 0.862157387112471, 'n_estimators': 875, 'feature_fraction': 0.9982569677012602, 'bagging_fraction': 0.9604381931791035, 'bagging_freq': 7, 'min_child_samples': 28}. Best is trial 0 with value: 4568.618488626321.[0m
    [32m[I 2021-12-31 00:29:03,442][0m Trial 11 finished with value: 4216.23521377656 and parameters: {'lambda_l1': 0.006427294606351526, 'lambda_l2': 3.4406206439893753e-06, 'num_leaves': 6, 'learning_rate': 0.8212195156571136, 'n_estimators': 748, 'feature_fraction': 0.9729196921001799, 'bagging_fraction': 0.967306138778092, 'bagging_freq': 7, 'min_child_samples': 30}. Best is trial 11 with value: 4216.23521377656.[0m
    [32m[I 2021-12-31 00:29:03,472][0m Trial 12 finished with value: 4269.715291132349 and parameters: {'lambda_l1': 1.655889708783805e-05, 'lambda_l2': 4.764630986587589e-06, 'num_leaves': 5, 'learning_rate': 0.7184874218409011, 'n_estimators': 1221, 'feature_fraction': 0.6190972966072006, 'bagging_fraction': 0.9853849919450026, 'bagging_freq': 7, 'min_child_samples': 35}. Best is trial 11 with value: 4216.23521377656.[0m
    [32m[I 2021-12-31 00:29:03,500][0m Trial 13 finished with value: 97148.49772096971 and parameters: {'lambda_l1': 1.1823074967500632e-05, 'lambda_l2': 1.2314847116169236e-08, 'num_leaves': 103, 'learning_rate': 0.04303074389189523, 'n_estimators': 1053, 'feature_fraction': 0.6185241954261824, 'bagging_fraction': 0.7633873792078266, 'bagging_freq': 7, 'min_child_samples': 36}. Best is trial 11 with value: 4216.23521377656.[0m
    [32m[I 2021-12-31 00:29:03,529][0m Trial 14 finished with value: 129780.39076178941 and parameters: {'lambda_l1': 0.029946352496557305, 'lambda_l2': 2.293836622020224e-05, 'num_leaves': 8, 'learning_rate': 0.028302153767694713, 'n_estimators': 757, 'feature_fraction': 0.598071703137868, 'bagging_fraction': 0.9434531233683123, 'bagging_freq': 6, 'min_child_samples': 24}. Best is trial 11 with value: 4216.23521377656.[0m
    [32m[I 2021-12-31 00:29:03,558][0m Trial 15 finished with value: 108627.74298027394 and parameters: {'lambda_l1': 2.0721651776367097e-05, 'lambda_l2': 4.776736643710492e-07, 'num_leaves': 184, 'learning_rate': 0.0373253844314753, 'n_estimators': 1121, 'feature_fraction': 0.9527208121762996, 'bagging_fraction': 0.9976896920322766, 'bagging_freq': 6, 'min_child_samples': 42}. Best is trial 11 with value: 4216.23521377656.[0m
    [32m[I 2021-12-31 00:29:03,589][0m Trial 16 finished with value: 4161.58341961919 and parameters: {'lambda_l1': 1.2075120570640392e-06, 'lambda_l2': 3.192455762718488e-05, 'num_leaves': 93, 'learning_rate': 0.7633221892563936, 'n_estimators': 1380, 'feature_fraction': 0.610469472130138, 'bagging_fraction': 0.753129166507926, 'bagging_freq': 7, 'min_child_samples': 71}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,618][0m Trial 17 finished with value: 202511.8235500384 and parameters: {'lambda_l1': 5.698420519362472e-07, 'lambda_l2': 0.05057284029812202, 'num_leaves': 93, 'learning_rate': 0.005638615526336113, 'n_estimators': 1386, 'feature_fraction': 0.7960184136623704, 'bagging_fraction': 0.7546374673412564, 'bagging_freq': 6, 'min_child_samples': 73}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,648][0m Trial 18 finished with value: 226072.44316235752 and parameters: {'lambda_l1': 1.0151773688322424e-08, 'lambda_l2': 7.635712306294757e-05, 'num_leaves': 502, 'learning_rate': 9.115259113442877e-06, 'n_estimators': 1765, 'feature_fraction': 0.5698573759694839, 'bagging_fraction': 0.5837014888757703, 'bagging_freq': 1, 'min_child_samples': 68}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,679][0m Trial 19 finished with value: 11994.339716902059 and parameters: {'lambda_l1': 0.012695105457973463, 'lambda_l2': 1.8274865195522631e-07, 'num_leaves': 242, 'learning_rate': 0.15401539559306635, 'n_estimators': 969, 'feature_fraction': 0.6628933156150028, 'bagging_fraction': 0.7866126247066668, 'bagging_freq': 7, 'min_child_samples': 99}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,710][0m Trial 20 finished with value: 204705.07156187773 and parameters: {'lambda_l1': 0.00015794504068395812, 'lambda_l2': 1.0769020269549733e-08, 'num_leaves': 65, 'learning_rate': 0.0050862167155861435, 'n_estimators': 727, 'feature_fraction': 0.4042217065648851, 'bagging_fraction': 0.7130704393244296, 'bagging_freq': 5, 'min_child_samples': 83}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,741][0m Trial 21 finished with value: 4436.235310055051 and parameters: {'lambda_l1': 2.294131199873271e-06, 'lambda_l2': 5.939962319839677e-06, 'num_leaves': 2, 'learning_rate': 0.3852332895449078, 'n_estimators': 1274, 'feature_fraction': 0.6516947633934616, 'bagging_fraction': 0.9183726797075551, 'bagging_freq': 7, 'min_child_samples': 45}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,772][0m Trial 22 finished with value: 5257.305578348401 and parameters: {'lambda_l1': 5.8821431281267325e-08, 'lambda_l2': 1.6280473896722246e-06, 'num_leaves': 138, 'learning_rate': 0.909045521959894, 'n_estimators': 1161, 'feature_fraction': 0.5615849702142977, 'bagging_fraction': 0.8215634542846348, 'bagging_freq': 6, 'min_child_samples': 21}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,802][0m Trial 23 finished with value: 7184.061618914244 and parameters: {'lambda_l1': 2.880876529371443e-06, 'lambda_l2': 3.676364922871764e-05, 'num_leaves': 48, 'learning_rate': 0.18853689116725425, 'n_estimators': 1596, 'feature_fraction': 0.7631833616135936, 'bagging_fraction': 0.9784316356157543, 'bagging_freq': 7, 'min_child_samples': 61}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,831][0m Trial 24 finished with value: 201530.56589064468 and parameters: {'lambda_l1': 0.0016479639681959584, 'lambda_l2': 1.501706065435622e-05, 'num_leaves': 136, 'learning_rate': 0.005886703584943928, 'n_estimators': 1007, 'feature_fraction': 0.6725232327182398, 'bagging_fraction': 0.888387214053822, 'bagging_freq': 6, 'min_child_samples': 45}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,860][0m Trial 25 finished with value: 33668.30008601348 and parameters: {'lambda_l1': 3.202990436884576e-05, 'lambda_l2': 0.00017864523533598408, 'num_leaves': 12, 'learning_rate': 0.09689241153756226, 'n_estimators': 1369, 'feature_fraction': 0.6158515970054332, 'bagging_fraction': 0.5907478943495215, 'bagging_freq': 7, 'min_child_samples': 32}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,890][0m Trial 26 finished with value: 4420.826712814977 and parameters: {'lambda_l1': 2.7484569348251493e-06, 'lambda_l2': 1.4175119026098038e-06, 'num_leaves': 45, 'learning_rate': 0.881532511668754, 'n_estimators': 908, 'feature_fraction': 0.8063976297132475, 'bagging_fraction': 0.9356076124142028, 'bagging_freq': 6, 'min_child_samples': 16}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,919][0m Trial 27 finished with value: 217666.15597345133 and parameters: {'lambda_l1': 5.4960469277369706e-05, 'lambda_l2': 9.033811033092352e-08, 'num_leaves': 110, 'learning_rate': 0.0019488893526229793, 'n_estimators': 1602, 'feature_fraction': 0.5547398612954492, 'bagging_fraction': 0.6930017885168649, 'bagging_freq': 5, 'min_child_samples': 41}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,948][0m Trial 28 finished with value: 140054.82310632287 and parameters: {'lambda_l1': 0.002866353293587611, 'lambda_l2': 0.0002999922713282219, 'num_leaves': 228, 'learning_rate': 0.02444364131957461, 'n_estimators': 1912, 'feature_fraction': 0.9348060266286482, 'bagging_fraction': 0.41337533261331266, 'bagging_freq': 7, 'min_child_samples': 59}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:03,981][0m Trial 29 finished with value: 4338.608269275657 and parameters: {'lambda_l1': 9.055444135603958e-05, 'lambda_l2': 6.316777178211188e-06, 'num_leaves': 38, 'learning_rate': 0.3655210201171803, 'n_estimators': 1451, 'feature_fraction': 0.6973764863137055, 'bagging_fraction': 0.9676322415553514, 'bagging_freq': 6, 'min_child_samples': 34}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:04,014][0m Trial 30 finished with value: 4974.396476941484 and parameters: {'lambda_l1': 0.0005410414414901307, 'lambda_l2': 9.345779644205445e-07, 'num_leaves': 7, 'learning_rate': 0.8805758350516812, 'n_estimators': 1239, 'feature_fraction': 0.40204322031335143, 'bagging_fraction': 0.9976006852841796, 'bagging_freq': 7, 'min_child_samples': 70}. Best is trial 16 with value: 4161.58341961919.[0m
    [32m[I 2021-12-31 00:29:04,045][0m Trial 31 finished with value: 4042.811062047207 and parameters: {'lambda_l1': 0.0001266293450868775, 'lambda_l2': 2.490671821880379e-05, 'num_leaves': 35, 'learning_rate': 0.26266088992875153, 'n_estimators': 1412, 'feature_fraction': 0.6995627275429857, 'bagging_fraction': 0.9884353587422041, 'bagging_freq': 6, 'min_child_samples': 34}. Best is trial 31 with value: 4042.811062047207.[0m
    [32m[I 2021-12-31 00:29:04,075][0m Trial 32 finished with value: 26556.54427247422 and parameters: {'lambda_l1': 6.000747146176883e-06, 'lambda_l2': 1.6424466554943087e-05, 'num_leaves': 68, 'learning_rate': 0.11057697403361115, 'n_estimators': 1718, 'feature_fraction': 0.6367613078036694, 'bagging_fraction': 0.9999551510517436, 'bagging_freq': 7, 'min_child_samples': 28}. Best is trial 31 with value: 4042.811062047207.[0m
    [32m[I 2021-12-31 00:29:04,106][0m Trial 33 finished with value: 3490.9505377615806 and parameters: {'lambda_l1': 0.00030291183212558486, 'lambda_l2': 6.202231567313137e-06, 'num_leaves': 41, 'learning_rate': 0.4146153731623432, 'n_estimators': 1941, 'feature_fraction': 0.7124937962674952, 'bagging_fraction': 0.8564238349708693, 'bagging_freq': 5, 'min_child_samples': 49}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,136][0m Trial 34 finished with value: 170432.84444716212 and parameters: {'lambda_l1': 0.00030511098425210314, 'lambda_l2': 0.0006450706086988186, 'num_leaves': 115, 'learning_rate': 0.014453942096597007, 'n_estimators': 1987, 'feature_fraction': 0.8962439500208214, 'bagging_fraction': 0.8539417167394774, 'bagging_freq': 5, 'min_child_samples': 45}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,166][0m Trial 35 finished with value: 226112.08636973336 and parameters: {'lambda_l1': 0.06316437837897992, 'lambda_l2': 2.972155799859609e-05, 'num_leaves': 38, 'learning_rate': 1.3477453415938478e-07, 'n_estimators': 2610, 'feature_fraction': 0.7076634406817052, 'bagging_fraction': 0.8065904663470039, 'bagging_freq': 5, 'min_child_samples': 50}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,197][0m Trial 36 finished with value: 3999.520047817607 and parameters: {'lambda_l1': 0.0056749002230640985, 'lambda_l2': 0.0037261254811722633, 'num_leaves': 172, 'learning_rate': 0.25950897843798965, 'n_estimators': 2067, 'feature_fraction': 0.7961435608741964, 'bagging_fraction': 0.8583809372998771, 'bagging_freq': 6, 'min_child_samples': 5}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,230][0m Trial 37 finished with value: 58003.4919628154 and parameters: {'lambda_l1': 0.0005821729164018283, 'lambda_l2': 0.01857481542886468, 'num_leaves': 170, 'learning_rate': 0.06954838403945439, 'n_estimators': 2149, 'feature_fraction': 0.7711398324723036, 'bagging_fraction': 0.869229533163137, 'bagging_freq': 4, 'min_child_samples': 5}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,262][0m Trial 38 finished with value: 5318.078769416217 and parameters: {'lambda_l1': 0.0011233327979907344, 'lambda_l2': 0.5807919258140065, 'num_leaves': 285, 'learning_rate': 0.2182455111230775, 'n_estimators': 2337, 'feature_fraction': 0.8179418302572343, 'bagging_fraction': 0.7588255465515763, 'bagging_freq': 5, 'min_child_samples': 65}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,292][0m Trial 39 finished with value: 226097.3545203129 and parameters: {'lambda_l1': 8.604957648503299e-07, 'lambda_l2': 0.0005822823763404188, 'num_leaves': 205, 'learning_rate': 3.471873039517287e-06, 'n_estimators': 1871, 'feature_fraction': 0.733850971587168, 'bagging_fraction': 0.8444045912086707, 'bagging_freq': 6, 'min_child_samples': 57}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,322][0m Trial 40 finished with value: 181527.6797403167 and parameters: {'lambda_l1': 1.7112579144356966e-07, 'lambda_l2': 0.004872496561167938, 'num_leaves': 156, 'learning_rate': 0.011236748259974866, 'n_estimators': 2089, 'feature_fraction': 0.8400476742943773, 'bagging_fraction': 0.7142162790332787, 'bagging_freq': 5, 'min_child_samples': 16}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,354][0m Trial 41 finished with value: 3807.129088633137 and parameters: {'lambda_l1': 0.01732095839109507, 'lambda_l2': 7.480336153785576e-05, 'num_leaves': 92, 'learning_rate': 0.317665442661421, 'n_estimators': 2715, 'feature_fraction': 0.6754601409551388, 'bagging_fraction': 0.9100015900041811, 'bagging_freq': 6, 'min_child_samples': 51}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,385][0m Trial 42 finished with value: 4186.4673613414425 and parameters: {'lambda_l1': 0.1515923188803299, 'lambda_l2': 6.741037687373955e-05, 'num_leaves': 84, 'learning_rate': 0.23449335219819478, 'n_estimators': 2951, 'feature_fraction': 0.6832558697165326, 'bagging_fraction': 0.9090013625896914, 'bagging_freq': 6, 'min_child_samples': 51}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,417][0m Trial 43 finished with value: 3986.3297924355634 and parameters: {'lambda_l1': 2.0043883135698612, 'lambda_l2': 0.00020928212471008054, 'num_leaves': 129, 'learning_rate': 0.3556954104033284, 'n_estimators': 2639, 'feature_fraction': 0.7210662597740566, 'bagging_fraction': 0.8034133023071762, 'bagging_freq': 6, 'min_child_samples': 76}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,448][0m Trial 44 finished with value: 58500.293325887265 and parameters: {'lambda_l1': 4.6986992595208665, 'lambda_l2': 0.0046090488166752935, 'num_leaves': 139, 'learning_rate': 0.06936488267133377, 'n_estimators': 2722, 'feature_fraction': 0.7161264461427257, 'bagging_fraction': 0.8729950535115649, 'bagging_freq': 5, 'min_child_samples': 79}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,480][0m Trial 45 finished with value: 4134.616001759933 and parameters: {'lambda_l1': 0.4299709103646129, 'lambda_l2': 0.0015789845958644824, 'num_leaves': 121, 'learning_rate': 0.35892971013501695, 'n_estimators': 2785, 'feature_fraction': 0.7513586001380157, 'bagging_fraction': 0.8320223556232462, 'bagging_freq': 4, 'min_child_samples': 11}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,510][0m Trial 46 finished with value: 218482.00428417293 and parameters: {'lambda_l1': 1.1910025068827454, 'lambda_l2': 0.00013814815389329467, 'num_leaves': 60, 'learning_rate': 0.0017574633994258898, 'n_estimators': 2515, 'feature_fraction': 0.784785743503269, 'bagging_fraction': 0.7890038388047336, 'bagging_freq': 6, 'min_child_samples': 39}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,541][0m Trial 47 finished with value: 4127.68755375725 and parameters: {'lambda_l1': 0.005763985103949179, 'lambda_l2': 0.010957835873624274, 'num_leaves': 204, 'learning_rate': 0.38879357649520163, 'n_estimators': 2193, 'feature_fraction': 0.735416978674817, 'bagging_fraction': 0.9317710951857479, 'bagging_freq': 6, 'min_child_samples': 55}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,572][0m Trial 48 finished with value: 69947.14873841405 and parameters: {'lambda_l1': 0.044165138628815236, 'lambda_l2': 0.0005874419098997327, 'num_leaves': 155, 'learning_rate': 0.05992470860671358, 'n_estimators': 2802, 'feature_fraction': 0.8737717655579987, 'bagging_fraction': 0.894570112725545, 'bagging_freq': 5, 'min_child_samples': 49}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,602][0m Trial 49 finished with value: 162209.01916479226 and parameters: {'lambda_l1': 7.409197197987052, 'lambda_l2': 0.07725835945834217, 'num_leaves': 29, 'learning_rate': 0.01698075615793223, 'n_estimators': 2405, 'feature_fraction': 0.6977543340347666, 'bagging_fraction': 0.8028949507995322, 'bagging_freq': 6, 'min_child_samples': 88}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,633][0m Trial 50 finished with value: 225508.34280369763 and parameters: {'lambda_l1': 0.00018525337773503064, 'lambda_l2': 8.088648772636828e-05, 'num_leaves': 287, 'learning_rate': 0.0001370681124711588, 'n_estimators': 2524, 'feature_fraction': 0.6497397060670629, 'bagging_fraction': 0.9492830768952147, 'bagging_freq': 3, 'min_child_samples': 75}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,665][0m Trial 51 finished with value: 3648.3179398129178 and parameters: {'lambda_l1': 0.006827333916572492, 'lambda_l2': 0.014943225017010611, 'num_leaves': 204, 'learning_rate': 0.3350922087859655, 'n_estimators': 2245, 'feature_fraction': 0.7348565587477807, 'bagging_fraction': 0.9264754087243696, 'bagging_freq': 6, 'min_child_samples': 54}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,695][0m Trial 52 finished with value: 17761.523387714704 and parameters: {'lambda_l1': 0.01973294413440345, 'lambda_l2': 0.07164622176784148, 'num_leaves': 210, 'learning_rate': 0.13219574408452914, 'n_estimators': 1986, 'feature_fraction': 0.7494946070799485, 'bagging_fraction': 0.8583310359068425, 'bagging_freq': 6, 'min_child_samples': 65}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,727][0m Trial 53 finished with value: 4343.754787594902 and parameters: {'lambda_l1': 0.0036887300668256894, 'lambda_l2': 0.0029237165675910356, 'num_leaves': 179, 'learning_rate': 0.43882380039270147, 'n_estimators': 2303, 'feature_fraction': 0.7154607731522467, 'bagging_fraction': 0.9155838009432384, 'bagging_freq': 6, 'min_child_samples': 99}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,759][0m Trial 54 finished with value: 120839.91832634457 and parameters: {'lambda_l1': 0.0009320910077663365, 'lambda_l2': 0.33084462200067344, 'num_leaves': 254, 'learning_rate': 0.031976058934537685, 'n_estimators': 2661, 'feature_fraction': 0.681743239311405, 'bagging_fraction': 0.8337861771458148, 'bagging_freq': 6, 'min_child_samples': 63}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,793][0m Trial 55 finished with value: 6933.368512540187 and parameters: {'lambda_l1': 0.007974554227606104, 'lambda_l2': 0.009423162163649334, 'num_leaves': 318, 'learning_rate': 0.1913767237271058, 'n_estimators': 2854, 'feature_fraction': 0.7797368087067936, 'bagging_fraction': 0.8815928454908984, 'bagging_freq': 5, 'min_child_samples': 48}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,827][0m Trial 56 finished with value: 4717.70873510855 and parameters: {'lambda_l1': 0.13896824206814298, 'lambda_l2': 1.0000488753904859e-05, 'num_leaves': 88, 'learning_rate': 0.525144877109371, 'n_estimators': 2210, 'feature_fraction': 0.8284695939431891, 'bagging_fraction': 0.9170865665537213, 'bagging_freq': 6, 'min_child_samples': 22}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,858][0m Trial 57 finished with value: 79262.18739937282 and parameters: {'lambda_l1': 0.00010204703014360328, 'lambda_l2': 0.00025431103761869555, 'num_leaves': 155, 'learning_rate': 0.053377089620436476, 'n_estimators': 1807, 'feature_fraction': 0.7546096078703516, 'bagging_fraction': 0.9604585874609548, 'bagging_freq': 5, 'min_child_samples': 37}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,889][0m Trial 58 finished with value: 24650.051348933397 and parameters: {'lambda_l1': 1.2671814165975241, 'lambda_l2': 2.470178402719612, 'num_leaves': 224, 'learning_rate': 0.11377241146669881, 'n_estimators': 2425, 'feature_fraction': 0.7223516269224269, 'bagging_fraction': 0.8981222086581396, 'bagging_freq': 6, 'min_child_samples': 56}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,920][0m Trial 59 finished with value: 4003.5879673669033 and parameters: {'lambda_l1': 0.00035052567474603506, 'lambda_l2': 0.0015104601874562206, 'num_leaves': 131, 'learning_rate': 0.24000464675648203, 'n_estimators': 2069, 'feature_fraction': 0.8002289786084192, 'bagging_fraction': 0.8190844559789076, 'bagging_freq': 4, 'min_child_samples': 42}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,954][0m Trial 60 finished with value: 4576.74189927631 and parameters: {'lambda_l1': 0.06972853678029518, 'lambda_l2': 0.0009420358541383651, 'num_leaves': 125, 'learning_rate': 0.6306899252007272, 'n_estimators': 2116, 'feature_fraction': 0.7976038922136702, 'bagging_fraction': 0.8172243573556308, 'bagging_freq': 3, 'min_child_samples': 92}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:04,986][0m Trial 61 finished with value: 3810.7838577032894 and parameters: {'lambda_l1': 0.0027468465940645643, 'lambda_l2': 0.02622347116721824, 'num_leaves': 99, 'learning_rate': 0.29756528109146285, 'n_estimators': 2000, 'feature_fraction': 0.8699641648468953, 'bagging_fraction': 0.8527788918347702, 'bagging_freq': 4, 'min_child_samples': 53}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,018][0m Trial 62 finished with value: 16208.034386685991 and parameters: {'lambda_l1': 0.003024559774702566, 'lambda_l2': 0.03191752127699729, 'num_leaves': 102, 'learning_rate': 0.1357935251198347, 'n_estimators': 2002, 'feature_fraction': 0.8682677394398869, 'bagging_fraction': 0.7858026364954047, 'bagging_freq': 4, 'min_child_samples': 53}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,051][0m Trial 63 finished with value: 5571.754305337609 and parameters: {'lambda_l1': 0.014750426936163514, 'lambda_l2': 0.0022821810332795166, 'num_leaves': 169, 'learning_rate': 0.8906188723883564, 'n_estimators': 1677, 'feature_fraction': 0.9032377600239597, 'bagging_fraction': 0.7369802858135561, 'bagging_freq': 4, 'min_child_samples': 46}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,081][0m Trial 64 finished with value: 104285.4316503447 and parameters: {'lambda_l1': 0.0003811929610196, 'lambda_l2': 0.11874057290641366, 'num_leaves': 196, 'learning_rate': 0.03940323692761583, 'n_estimators': 1917, 'feature_fraction': 0.8077854673662407, 'bagging_fraction': 0.8557721864539334, 'bagging_freq': 3, 'min_child_samples': 59}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,114][0m Trial 65 finished with value: 5189.3527141540735 and parameters: {'lambda_l1': 0.0013516976943890409, 'lambda_l2': 0.01108258742609252, 'num_leaves': 76, 'learning_rate': 0.9745512593217788, 'n_estimators': 2288, 'feature_fraction': 0.8588447812229163, 'bagging_fraction': 0.778939819761894, 'bagging_freq': 2, 'min_child_samples': 41}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,146][0m Trial 66 finished with value: 4200.743083870112 and parameters: {'lambda_l1': 0.006808722534980801, 'lambda_l2': 0.2312995255864911, 'num_leaves': 136, 'learning_rate': 0.23622669396216073, 'n_estimators': 2075, 'feature_fraction': 0.833753537765747, 'bagging_fraction': 0.884040631129404, 'bagging_freq': 4, 'min_child_samples': 53}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,177][0m Trial 67 finished with value: 190952.80244701527 and parameters: {'lambda_l1': 0.002054429496606662, 'lambda_l2': 0.004179878459409432, 'num_leaves': 100, 'learning_rate': 0.008647473710173057, 'n_estimators': 2512, 'feature_fraction': 0.7666500140402409, 'bagging_fraction': 0.8388820758259438, 'bagging_freq': 3, 'min_child_samples': 67}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,208][0m Trial 68 finished with value: 37323.86800646572 and parameters: {'lambda_l1': 4.0362991842912466e-05, 'lambda_l2': 0.02728236898305148, 'num_leaves': 144, 'learning_rate': 0.0916870214454275, 'n_estimators': 1846, 'feature_fraction': 0.5930488097536167, 'bagging_fraction': 0.8148730427846645, 'bagging_freq': 4, 'min_child_samples': 60}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,243][0m Trial 69 finished with value: 3807.1228694734727 and parameters: {'lambda_l1': 0.02114306278781222, 'lambda_l2': 0.0003622437871859571, 'num_leaves': 173, 'learning_rate': 0.4963259044159122, 'n_estimators': 2017, 'feature_fraction': 0.884573183509615, 'bagging_fraction': 0.9295795431593351, 'bagging_freq': 5, 'min_child_samples': 43}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,276][0m Trial 70 finished with value: 4891.17945708073 and parameters: {'lambda_l1': 0.023545961737029043, 'lambda_l2': 6.200002851661094e-05, 'num_leaves': 232, 'learning_rate': 0.46269728963071244, 'n_estimators': 2242, 'feature_fraction': 0.9860094323115366, 'bagging_fraction': 0.9504478851440513, 'bagging_freq': 5, 'min_child_samples': 77}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,308][0m Trial 71 finished with value: 3507.2749470776916 and parameters: {'lambda_l1': 0.0007294525098998939, 'lambda_l2': 0.0011275958309768532, 'num_leaves': 183, 'learning_rate': 0.3027096754352729, 'n_estimators': 1951, 'feature_fraction': 0.9169891509339405, 'bagging_fraction': 0.9276438239682641, 'bagging_freq': 4, 'min_child_samples': 42}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,343][0m Trial 72 finished with value: 4931.74401289926 and parameters: {'lambda_l1': 0.004226779816291407, 'lambda_l2': 0.00035084396579190884, 'num_leaves': 183, 'learning_rate': 0.6204473973651896, 'n_estimators': 1934, 'feature_fraction': 0.9269851458347924, 'bagging_fraction': 0.9310776629546477, 'bagging_freq': 5, 'min_child_samples': 48}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,377][0m Trial 73 finished with value: 11823.658748600856 and parameters: {'lambda_l1': 0.01117255327019127, 'lambda_l2': 0.00771732549280201, 'num_leaves': 171, 'learning_rate': 0.15488662563559358, 'n_estimators': 1772, 'feature_fraction': 0.8994832648323844, 'bagging_fraction': 0.9004958355602766, 'bagging_freq': 4, 'min_child_samples': 28}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,410][0m Trial 74 finished with value: 3666.0446827654396 and parameters: {'lambda_l1': 0.0007713277029945927, 'lambda_l2': 0.00038871264557018546, 'num_leaves': 218, 'learning_rate': 0.32903520086972493, 'n_estimators': 2163, 'feature_fraction': 0.9385891940834306, 'bagging_fraction': 0.8727129077822927, 'bagging_freq': 5, 'min_child_samples': 51}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,443][0m Trial 75 finished with value: 6092.689223969717 and parameters: {'lambda_l1': 0.0007861737748888702, 'lambda_l2': 0.00018174547927519313, 'num_leaves': 251, 'learning_rate': 0.985081582928035, 'n_estimators': 2152, 'feature_fraction': 0.9333385928872893, 'bagging_fraction': 0.9309867488181087, 'bagging_freq': 5, 'min_child_samples': 45}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,475][0m Trial 76 finished with value: 144981.1660074172 and parameters: {'lambda_l1': 0.0016511502306732241, 'lambda_l2': 0.0008442276725041013, 'num_leaves': 220, 'learning_rate': 0.02269110811843326, 'n_estimators': 2005, 'feature_fraction': 0.9573764535816836, 'bagging_fraction': 0.9792173538457236, 'bagging_freq': 5, 'min_child_samples': 51}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,507][0m Trial 77 finished with value: 54380.323740254804 and parameters: {'lambda_l1': 0.00024700497039696406, 'lambda_l2': 0.000355869993473734, 'num_leaves': 264, 'learning_rate': 0.0728529696525812, 'n_estimators': 1706, 'feature_fraction': 0.9122185635048575, 'bagging_fraction': 0.9158791253128248, 'bagging_freq': 4, 'min_child_samples': 39}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,539][0m Trial 78 finished with value: 3647.5522225903583 and parameters: {'lambda_l1': 0.0007724716708696609, 'lambda_l2': 4.36381123922213e-05, 'num_leaves': 194, 'learning_rate': 0.33046882515979203, 'n_estimators': 2379, 'feature_fraction': 0.9683295311104391, 'bagging_fraction': 0.871455242946476, 'bagging_freq': 5, 'min_child_samples': 57}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,573][0m Trial 79 finished with value: 4407.358408529739 and parameters: {'lambda_l1': 0.03114970455010929, 'lambda_l2': 3.320887257948464e-06, 'num_leaves': 206, 'learning_rate': 0.6617336727391112, 'n_estimators': 2384, 'feature_fraction': 0.9641457279009291, 'bagging_fraction': 0.874608273618781, 'bagging_freq': 5, 'min_child_samples': 57}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,604][0m Trial 80 finished with value: 225990.1918860148 and parameters: {'lambda_l1': 0.0005744469016531731, 'lambda_l2': 4.007525334391877e-05, 'num_leaves': 241, 'learning_rate': 2.7752657305489356e-05, 'n_estimators': 2197, 'feature_fraction': 0.979022134304756, 'bagging_fraction': 0.9460425283821249, 'bagging_freq': 5, 'min_child_samples': 43}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,638][0m Trial 81 finished with value: 4346.123730782916 and parameters: {'lambda_l1': 0.003012899586581725, 'lambda_l2': 1.0282775468984846e-05, 'num_leaves': 162, 'learning_rate': 0.3661253297739379, 'n_estimators': 2631, 'feature_fraction': 0.994120525084969, 'bagging_fraction': 0.8920247481130755, 'bagging_freq': 5, 'min_child_samples': 52}. Best is trial 33 with value: 3490.9505377615806.[0m
    [32m[I 2021-12-31 00:29:05,670][0m Trial 82 finished with value: 3387.0329822690405 and parameters: {'lambda_l1': 5.6558373369062646e-05, 'lambda_l2': 0.00011100877945906895, 'num_leaves': 191, 'learning_rate': 0.3013759024431819, 'n_estimators': 2585, 'feature_fraction': 0.9498831558950162, 'bagging_fraction': 0.8682854494395678, 'bagging_freq': 5, 'min_child_samples': 48}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,703][0m Trial 83 finished with value: 11633.273456293644 and parameters: {'lambda_l1': 7.63638384700963e-05, 'lambda_l2': 8.846110333832818e-05, 'num_leaves': 191, 'learning_rate': 0.15598461974935604, 'n_estimators': 2339, 'feature_fraction': 0.8842307593840362, 'bagging_fraction': 0.8684170131840928, 'bagging_freq': 5, 'min_child_samples': 48}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,736][0m Trial 84 finished with value: 33803.646060856656 and parameters: {'lambda_l1': 1.1298059073828548e-05, 'lambda_l2': 0.0004888654123001571, 'num_leaves': 192, 'learning_rate': 0.0966870762273075, 'n_estimators': 2562, 'feature_fraction': 0.9373061471356305, 'bagging_fraction': 0.9081194966319719, 'bagging_freq': 4, 'min_child_samples': 55}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,770][0m Trial 85 finished with value: 5052.810895860556 and parameters: {'lambda_l1': 0.00021890138258256266, 'lambda_l2': 4.464004277969401e-05, 'num_leaves': 56, 'learning_rate': 0.9785696416466113, 'n_estimators': 2478, 'feature_fraction': 0.9680755798322269, 'bagging_fraction': 0.9633768608599959, 'bagging_freq': 5, 'min_child_samples': 46}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,804][0m Trial 86 finished with value: 3433.6309241530034 and parameters: {'lambda_l1': 0.000838891598271101, 'lambda_l2': 0.00013179541250574046, 'num_leaves': 213, 'learning_rate': 0.2997968407603274, 'n_estimators': 2141, 'feature_fraction': 0.9489032831747017, 'bagging_fraction': 0.8488921411952368, 'bagging_freq': 4, 'min_child_samples': 62}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,837][0m Trial 87 finished with value: 4558.899246701651 and parameters: {'lambda_l1': 0.0008529003334644539, 'lambda_l2': 0.00011696475530237575, 'num_leaves': 214, 'learning_rate': 0.45621189219498653, 'n_estimators': 2151, 'feature_fraction': 0.9174851609151139, 'bagging_fraction': 0.9234542778720972, 'bagging_freq': 5, 'min_child_samples': 59}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,869][0m Trial 88 finished with value: 81147.72032108378 and parameters: {'lambda_l1': 0.00015433542568736233, 'lambda_l2': 1.7516462127176325e-05, 'num_leaves': 235, 'learning_rate': 0.05219136610528122, 'n_estimators': 2249, 'feature_fraction': 0.9538268453973288, 'bagging_fraction': 0.8875538535349188, 'bagging_freq': 5, 'min_child_samples': 62}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,905][0m Trial 89 finished with value: 7693.005549788397 and parameters: {'lambda_l1': 4.163059308700851e-05, 'lambda_l2': 0.00015471532678705015, 'num_leaves': 273, 'learning_rate': 0.18426834740173723, 'n_estimators': 2371, 'feature_fraction': 0.9347824549746601, 'bagging_fraction': 0.8437358645806068, 'bagging_freq': 4, 'min_child_samples': 38}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,938][0m Trial 90 finished with value: 43949.47592668894 and parameters: {'lambda_l1': 2.125996796882936e-05, 'lambda_l2': 1.1899373597517777e-05, 'num_leaves': 197, 'learning_rate': 0.08381919073138774, 'n_estimators': 2449, 'feature_fraction': 0.9908163684167839, 'bagging_fraction': 0.8728174277612771, 'bagging_freq': 5, 'min_child_samples': 43}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:05,973][0m Trial 91 finished with value: 3978.339745999972 and parameters: {'lambda_l1': 0.009320469699046248, 'lambda_l2': 4.66827294644935e-05, 'num_leaves': 183, 'learning_rate': 0.2898327932940281, 'n_estimators': 2029, 'feature_fraction': 0.8820480434759694, 'bagging_fraction': 0.8582458819645491, 'bagging_freq': 4, 'min_child_samples': 51}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,007][0m Trial 92 finished with value: 4846.968852751096 and parameters: {'lambda_l1': 0.0019403946059397437, 'lambda_l2': 2.186718013488806e-06, 'num_leaves': 219, 'learning_rate': 0.5958663740346936, 'n_estimators': 1931, 'feature_fraction': 0.9461488442328009, 'bagging_fraction': 0.9066204560025334, 'bagging_freq': 3, 'min_child_samples': 57}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,041][0m Trial 93 finished with value: 3541.7842889894023 and parameters: {'lambda_l1': 0.00048201511428474364, 'lambda_l2': 2.290493810074017e-05, 'num_leaves': 146, 'learning_rate': 0.28690785233433264, 'n_estimators': 1852, 'feature_fraction': 0.909859629559776, 'bagging_fraction': 0.9381077101623173, 'bagging_freq': 4, 'min_child_samples': 54}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,074][0m Trial 94 finished with value: 8621.582883192928 and parameters: {'lambda_l1': 6.294500773716977e-05, 'lambda_l2': 2.50149392488713e-05, 'num_leaves': 23, 'learning_rate': 0.17706143858066248, 'n_estimators': 2704, 'feature_fraction': 0.9185061228232464, 'bagging_fraction': 0.9291998866916036, 'bagging_freq': 5, 'min_child_samples': 49}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,107][0m Trial 95 finished with value: 4551.350228408876 and parameters: {'lambda_l1': 0.0005658456532616845, 'lambda_l2': 6.601344996400951e-06, 'num_leaves': 150, 'learning_rate': 0.5724810148892449, 'n_estimators': 1854, 'feature_fraction': 0.9450002108199121, 'bagging_fraction': 0.46861412389228035, 'bagging_freq': 4, 'min_child_samples': 54}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,139][0m Trial 96 finished with value: 226112.63571416415 and parameters: {'lambda_l1': 0.00033667665012383964, 'lambda_l2': 0.0001164097949727087, 'num_leaves': 470, 'learning_rate': 1.0413234797124354e-08, 'n_estimators': 2573, 'feature_fraction': 0.9995037831265795, 'bagging_fraction': 0.9440844054763217, 'bagging_freq': 3, 'min_child_samples': 46}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,173][0m Trial 97 finished with value: 5236.720440015695 and parameters: {'lambda_l1': 0.00011239861962952245, 'lambda_l2': 0.0002596926095676175, 'num_leaves': 114, 'learning_rate': 0.9990262052868933, 'n_estimators': 1537, 'feature_fraction': 0.663744784977036, 'bagging_fraction': 0.9894414261355353, 'bagging_freq': 4, 'min_child_samples': 63}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,207][0m Trial 98 finished with value: 23986.31889057128 and parameters: {'lambda_l1': 0.0009071326649948105, 'lambda_l2': 0.0010789354295095603, 'num_leaves': 164, 'learning_rate': 0.11534884643188614, 'n_estimators': 2117, 'feature_fraction': 0.6379517050521285, 'bagging_fraction': 0.9667022991196575, 'bagging_freq': 6, 'min_child_samples': 66}. Best is trial 82 with value: 3387.0329822690405.[0m
    [32m[I 2021-12-31 00:29:06,240][0m Trial 99 finished with value: 4782.767285286539 and parameters: {'lambda_l1': 0.09752597310192677, 'lambda_l2': 0.0004004872341194335, 'num_leaves': 201, 'learning_rate': 0.24476303446557696, 'n_estimators': 2293, 'feature_fraction': 0.9777986348664164, 'bagging_fraction': 0.903343308080366, 'bagging_freq': 5, 'min_child_samples': 50}. Best is trial 82 with value: 3387.0329822690405.[0m
    

    {'lambda_l1': 5.6558373369062646e-05, 'lambda_l2': 0.00011100877945906895, 'num_leaves': 191, 'learning_rate': 0.3013759024431819, 'n_estimators': 2585, 'feature_fraction': 0.9498831558950162, 'bagging_fraction': 0.8682854494395678, 'bagging_freq': 5, 'min_child_samples': 48}
    

## 4.6 stacking 融合


```python
part = '4.6'

# 1.基础代码
def stacking_reg(
                clf, train_x, train_y, test_x, clf_name, kf, label_split=None
            ):
    train = np.zeros((train_x.shape[0], 1))
    test = np.zeros((test_x.shape[0], 1))
    test_pre = np.empty((folds, test_x.shape[0], 1))
    cv_scores = []
    for i, (train_index, test_index) in enumerate(kf.split(train_x, label_split)):
        tr_x = train_x[train_index]
        tr_y = train_y[train_index]
        te_x = train_x[test_index]
        te_y = train_y[test_index]
        if clf_name in ['rf', 'ada', 'gb', 'et', 'lr', 'lsvc', 'knn']:
            clf.fit(tr_x, tr_y)
            pre = clf.predict(te_x).reshape(-1, 1)
            train[test_index] = pre
            test_pre[i, :] = clf.predict(test_x).reshape(-1, 1)
            cv_scores.append(mean_squared_error(te_y, pre))
            
        elif clf_name in ['xgb']:
            train_mat = clf.DMatrix(tr_x, label=tr_y, missing=-1)
            test_mat = clf.DMatrix(te_x, label=te_y, missing=-1)
            z = clf.DMatrix(test_x, label=np.ones(test_x.shape[0]), missing=-1)
            num_round = 10000
            early_stopping_rounds = 100
            watch_list = [(train_mat, 'train'), (test_mat, 'eval')]
            if test_mat:
                model = clf.train(
                    xgb_params, 
                    train_mat,
                    num_boost_round=num_round,
                    evals=watch_list,
                    early_stopping_rounds=early_stopping_rounds
                )
                pre = model.predict(
                    test_mat,
                    ntree_limit=model.best_ntree_limit
                ).reshape(-1, 1)
                train[test_index] = pre
                test_pre[i, :] = model.predict(
                    z, 
                    ntree_limit=model.best_ntree_limit
                ).reshape(-1, 1)
                
                cv_scores.append(mean_squared_error(te_y, pre))

        elif clf_name in ['lgb']:
            train_mat = clf.Dataset(tr_x, label=tr_y)
            test_mat = clf.Dataset(te_x, label=te_y)
            num_round = 7000
            early_stopping_rounds = 100
            if test_mat:
                print(train_mat)
                model = clf.train(
                    lgb_params, 
                    train_mat,
                    num_round,
                    valid_sets=test_mat,
                    # early_stopping_rounds=early_stopping_rounds
                )
                pre = model.predict(
                    te_x,
                    num_iteration=model.best_iteration
                ).reshape(-1, 1)
                train[test_index] = pre
                test_pre[i, :] = model.predict(
                    test_x, num_iteration=model.best_iteration
                ).reshape(-1, 1)
                cv_scores.append(mean_squared_error(te_y, pre))
        else:
            raise IOError('please add new clf.')
        print(f"{clf_name} now score is {cv_scores}")
    test[:] = test_pre.mean(axis=0)
    print(f"{clf_name}_score_list:{cv_scores}")
    print(f"{clf_name}_Score_mean:{np.mean(cv_scores)}")
    return train.reshape(-1, 1), test.reshape(-1, 1)
```


```python
# 2 模型融合stacking基学习器
def rf_reg(x_train, y_train, x_valid, kf, label_split=None):
    rf = RandomForestRegressor(
        n_estimators=600,
        max_depth=20,
        n_jobs=-1,
        random_state=2021,
        max_features='auto',
        verbose=1
    )
    train, test = stacking_reg(
        rf, x_train, y_train, x_valid, 'rf', kf, label_split=label_split
    )
    return train, test, 'rf_reg'

def ada_reg(x_train, y_train, x_valid, kf, label_split=None):
    ad = AdaBoostRegressor(
        n_estimators=30,
        random_state=2021,
        learning_rate=.01
    )
    train, test = stacking_reg(
        ad, x_train, y_train, x_valid, 'ada', kf, label_split=label_split
    )
    return train, test, 'ada_reg'

def gb_reg(x_train, y_train, x_valid, kf, label_split=None):
    gbdt = GradientBoostingRegressor(
        learning_rate=.04,
        n_estimators=100,
        subsample=.8,
        random_state=2021,
        max_depth=5,
        verbose=1
    )
    train, test = stacking_reg(
        gbdt, x_train, y_train, x_valid, 'gb', kf, label_split=label_split
    )
    return train, test, 'gb'


def xgb_reg(x_train, y_train, x_valid, kf, label_split=None):
    train, test = stacking_reg(
        xgb, x_train, y_train, x_valid, 'xgb', kf, label_split=label_split
    )
    return train, test, 'xgb_reg'

def lgb_reg(x_train, y_train, x_valid, kf, label_split=None):
    train, test = stacking_reg(
        lgb, x_train, y_train, x_valid, 'lgb', kf, label_split=label_split
    )
    return train, test, 'lgb_reg'
```


```python
# 3 模型融合stacking预测函数
def stacking_pred(
    x_train, y_train, x_valid, kf, clf_list, label_split=None, clf_fin='lgb', if_concat_origin=True
):
    for k, clf_list in enumerate(clf_list):
        clf_list = [clf_list]
        col_list, train_data_list, test_data_list = [], [], []
        for clf in clf_list:
            train_data, test_data, clf_name = clf(
                x_train,
                y_train,
                x_valid,
                kf,
                label_split=label_split
            )
            train_data_list.append(train_data)
            test_data_list.append(test_data)
            col_list.append(f"clf_{clf_name}")
        train, test = np.concatenate(train_data_list, axis=1), np.concatenate(test_data_list, axis=1)
        
        
        if if_concat_origin:
            train = np.concatenate([x_train, train], axis=1)
            test = np.concatenate([x_valid, test], axis=1)
        print('train:', train.shape)
        print('test:', test.shape)
        print(x_train.shape)
        print(train.shape)
        print(clf_name)
        print(clf_name in ['lgb'])
        if clf_fin in ['rf', 'ada', 'gb', 'et', 'lr', 'lsvc', 'knn']:
            if clf_fin in ['rf']:
                clf = RandomForestRegressor(
                    n_estimators=600,
                    max_depth=20,
                    n_jobs=-1,
                    random_state=2021,
                    max_features='auto',
                    verbose=1
                )
            elif clf_fin in ['ada']:
                clf = AdaBoostRegressor(
                    n_estimators=30,
                    random_state=2021,
                    learning_rate=.01,
                )
            elif clf_fin in ['gb']:
                clf = GradientBoostingRegressor(
                    learning_rate=.04,
                    n_estimators=100,
                    subsample=.8,
                    random_state=201,
                    max_depth=5,
                    verbose=1
                )
        elif clf_fin in ['xgb']:
            clf = xgb
            train_mat = clf.DMatrix(train, label=y_train, missing=-1)
            test_mat = clf.DMatrix(train, label=y_train, missing=-1)
            num_round = 10000
            early_stopping_rounds = 100
            watch_list = [(train_mat, 'train'), (test_mat, 'eval')]
            model = clf.train(
                xgb_params, 
                train_mat,
                num_boost_round=num_round,
                evals=watch_list,
                early_stopping_rounds=early_stopping_rounds
            )
            pre = model.predict(
                    clf.DMatrix(test),
                    ntree_limit=model.best_ntree_limit
                ).reshape(-1, 1)
            return pre

        elif clf_fin in ['lgb']:
            print(clf_name)
            clf = lgb
            train_mat = clf.Dataset(train, label=y_train)
            test_mat = clf.Dataset(train, label=y_train)
            num_round = 10000
            early_stopping_rounds = 1000
            model = clf.train(
                lgb_params, 
                train_mat,
                num_round,
                valid_sets=test_mat,
                # early_stopping_rounds=early_stopping_rounds
            )
            print('pred')
            pre = model.predict(
                test,
                num_iteration=model.best_iteration
            ).reshape(-1, 1)
            print(pre)
            return pre    
```


```python
folds = 5
seed = 1
kf = KFold(n_splits=5, shuffle=True, random_state=2021)
```


```python
clf_list = [rf_reg, ada_reg, gb_reg, xgb_reg, lgb_reg]
train_y = y_train.values
pred = stacking_pred(
    X_train.values,
    train_y, 
    X_test.values, 
    kf, 
    clf_list, 
    label_split=None, 
    clf_fin='lgb'
)
```

    [Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=-1)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 418 tasks      | elapsed:    0.2s
    [Parallel(n_jobs=-1)]: Done 600 out of 600 | elapsed:    0.3s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    

    rf now score is [1347.0551317120826]
    

    [Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=-1)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 418 tasks      | elapsed:    0.2s
    [Parallel(n_jobs=-1)]: Done 600 out of 600 | elapsed:    0.3s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    

    rf now score is [1347.0551317120826, 5882.993717614055]
    

    [Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=-1)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 418 tasks      | elapsed:    0.2s
    [Parallel(n_jobs=-1)]: Done 600 out of 600 | elapsed:    0.3s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    

    rf now score is [1347.0551317120826, 5882.993717614055, 3479.3428017072783]
    

    [Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=-1)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 418 tasks      | elapsed:    0.2s
    [Parallel(n_jobs=-1)]: Done 600 out of 600 | elapsed:    0.3s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    

    rf now score is [1347.0551317120826, 5882.993717614055, 3479.3428017072783, 3956.194498960962]
    

    [Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=-1)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=-1)]: Done 418 tasks      | elapsed:    0.2s
    [Parallel(n_jobs=-1)]: Done 600 out of 600 | elapsed:    0.3s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    [Parallel(n_jobs=16)]: Using backend ThreadingBackend with 16 concurrent workers.
    [Parallel(n_jobs=16)]: Done  18 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 168 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 418 tasks      | elapsed:    0.0s
    [Parallel(n_jobs=16)]: Done 600 out of 600 | elapsed:    0.0s finished
    

    rf now score is [1347.0551317120826, 5882.993717614055, 3479.3428017072783, 3956.194498960962, 4692.3564838811235]
    rf_score_list:[1347.0551317120826, 5882.993717614055, 3479.3428017072783, 3956.194498960962, 4692.3564838811235]
    rf_Score_mean:3871.5885267751
    train: (291, 5)
    test: (73, 5)
    (291, 4)
    (291, 5)
    rf_reg
    False
    rf_reg
    [LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.000066 seconds.
    You can set `force_col_wise=true` to remove the overhead.
    [LightGBM] [Info] Total Bins 490
    [LightGBM] [Info] Number of data points in the train set: 291, number of used features: 5
    [LightGBM] [Info] Start training from score 476.309261
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    [LightGBM] [Warning] No further splits with positive gain, best gain: -inf
    pred
    [[355.95383343]
     [369.5624837 ]
     [559.56138224]
     [530.43269181]
     [611.23027861]
     [435.69243177]
     [535.34159113]
     [233.872129  ]
     [444.67225268]
     [486.97826467]
     [535.28604754]
     [393.84295724]
     [497.21485265]
     [552.03920441]
     [197.69467759]
     [480.15689169]
     [515.37517621]
     [569.6454267 ]
     [381.01465469]
     [274.15257417]
     [405.59115988]
     [429.4306629 ]
     [408.00077978]
     [519.02392511]
     [552.09100447]
     [403.83618108]
     [512.19256382]
     [438.64089744]
     [565.85608556]
     [566.07327124]
     [489.59438863]
     [635.02514188]
     [270.00386776]
     [455.49512296]
     [395.15684581]
     [507.01065961]
     [375.17161345]
     [489.00211885]
     [359.55373505]
     [375.86619037]
     [310.86497264]
     [532.44239527]
     [427.08834322]
     [396.90211529]
     [433.21506763]
     [420.15665543]
     [420.46953718]
     [505.26741799]
     [515.65728759]
     [633.16825622]
     [323.22357573]
     [569.07724988]
     [615.81543541]
     [576.82187991]
     [475.90628621]
     [489.00307548]
     [585.88621324]
     [552.94155022]
     [565.3316534 ]
     [539.16177928]
     [572.068146  ]
     [434.09344237]
     [466.81583804]
     [431.53247998]
     [454.17138432]
     [467.64368703]
     [383.46547718]
     [214.1585927 ]
     [537.17015864]
     [611.6910597 ]
     [267.34536595]
     [459.22388131]
     [340.92281703]]
    


```python
title = f'{part} Predicted value VS real value'
plt.figure(figsize=(20, 10))
plt.scatter(y_test, pred.reshape(1, -1)[0], s=600)
plt.xlabel('real value', fontsize=20)
plt.ylabel('predicted value', fontsize=20)
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)
plt.title(title, fontsize=20)
file = os.path.join(path, f'{title}.png')
plt.savefig(file, dpi=600) 
```


    
![png](%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_files/%E5%B9%B4%E5%BA%A6%E5%88%86%E6%9E%90_191_0.png)
    



```python
preds = pd.concat(
    [y_test.reset_index(), 
    pd.Series(pred.reshape(1, -1)[0], name='预测有效时间').reset_index()], 
    axis=1
)[['有效时间', '预测有效时间']]

preds
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>有效时间</th>
      <th>预测有效时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>374.000000</td>
      <td>355.953833</td>
    </tr>
    <tr>
      <th>1</th>
      <td>360.000000</td>
      <td>369.562484</td>
    </tr>
    <tr>
      <th>2</th>
      <td>552.000000</td>
      <td>559.561382</td>
    </tr>
    <tr>
      <th>3</th>
      <td>536.000000</td>
      <td>530.432692</td>
    </tr>
    <tr>
      <th>4</th>
      <td>579.477989</td>
      <td>611.230279</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>68</th>
      <td>523.555080</td>
      <td>537.170159</td>
    </tr>
    <tr>
      <th>69</th>
      <td>643.000000</td>
      <td>611.691060</td>
    </tr>
    <tr>
      <th>70</th>
      <td>244.231049</td>
      <td>267.345366</td>
    </tr>
    <tr>
      <th>71</th>
      <td>482.000000</td>
      <td>459.223881</td>
    </tr>
    <tr>
      <th>72</th>
      <td>121.487610</td>
      <td>340.922817</td>
    </tr>
  </tbody>
</table>
<p>73 rows × 2 columns</p>
</div>



# 更多学习笔记，请关注公众号【杰然不同之GR】 #
![公众号二维码](http://m.qpic.cn/psc?/V10twqic2oh0r6/TmEUgtj9EK6.7V8ajmQrEG6xI.X7icgy*l8zd9O9qB3X6.AQyIe0uOSHtI7ti9nULpRDinQuLz61UqAz2Qxai8Ay.JgGp*bQUKKMa4c9AyU!/b&bo=rgGuAa4BrgEBGT4!&rf=viewer_4&t=5)
